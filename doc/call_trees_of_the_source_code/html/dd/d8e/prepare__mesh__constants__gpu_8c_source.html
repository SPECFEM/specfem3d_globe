<!-- custom-made header -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>SPECFEM3D_GLOBE: SPECFEM3D_GLOBE/src/gpu/prepare_mesh_constants_gpu.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../defaultstyle.css" rel="stylesheet" type="text/css" />
<link href="../../mystyle.css" rel="stylesheet" type="text/css"/>
<!-- Loading Lato Font -->
<link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;"> <!--  <td style="padding-left: 0.5em;"> -->
   <div id="projectname">SPECFEM3D_GLOBE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/d8e/prepare__mesh__constants__gpu_8c_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">prepare_mesh_constants_gpu.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!=====================================================================</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!          S p e c f e m 3 D  G l o b e  V e r s i o n  7 . 0</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!          --------------------------------------------------</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!     Main historical authors: Dimitri Komatitsch and Jeroen Tromp</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!                        Princeton University, USA</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!                and CNRS / University of Marseille, France</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!                 (there are currently many more authors!)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">! (c) Princeton University and CNRS / University of Marseille, April 2014</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">! This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">! it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">! the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">! (at your option) any later version.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">! This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">! GNU General Public License for more details.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">! You should have received a copy of the GNU General Public License along</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">! with this program; if not, write to the Free Software Foundation, Inc.,</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">! 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">!=====================================================================</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html">mesh_constants_gpu.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* ----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">// OpenCL setup</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* ----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">static</span> cl_mem moclGetDummyImage2D (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp) {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> inited = 0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keyword">static</span> cl_mem image2d;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  cl_int errcode;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> (!inited) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    cl_image_format format = {CL_RGBA, CL_UNSIGNED_INT32};</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    image2d = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, 10, 10, 0, NULL, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    inited = 1;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    clRetainMemObject (image2d);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">return</span> image2d;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/* ----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">void</span> release_kernels (<span class="keywordtype">void</span>) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#undef BOAST_KERNEL</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#define BOAST_KERNEL(__kern_name__)                                     \</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">  clCheck (clReleaseKernel (mocl.kernels.__kern_name__));               \</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">  clCheck (clReleaseProgram (mocl.programs.__kern_name__ ## _program));</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">  #include &quot;kernel_list.h&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#endif // USE_OPENCL</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">// GPU preparation routines</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">   73</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_constants_device,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;               PREPARE_CONSTANTS_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                          <span class="keywordtype">int</span> *myrank_f,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                          <span class="keywordtype">int</span> *h_NGLLX,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                          <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_hprime_xx, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_hprimewgll_xx,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                          <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_wgllwgll_xy, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_wgllwgll_xz, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_wgllwgll_yz,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                          <span class="keywordtype">int</span> *NSOURCES, <span class="keywordtype">int</span> *<a class="code" href="../../db/da6/namespacespecfem__par.html#aea1fca219d1f757235a8d2f525f02356">nsources_local</a>,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                          <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_sourcearrays,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                          <span class="keywordtype">int</span> *h_islice_selected_source, <span class="keywordtype">int</span> *h_ispec_selected_source,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                          <span class="keywordtype">int</span> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a38b32e638a9586e79e6a82c60461ce5f">nrec</a>, <span class="keywordtype">int</span> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a9f379a3538eda57a62dca8839eaa8ede">nrec_local</a>, <span class="keywordtype">int</span> *<a class="code" href="../../db/da6/namespacespecfem__par.html#af51bb5088c83df67979f2df0be588ead">nadj_rec_local</a>,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                          <span class="keywordtype">int</span> *h_number_receiver_global,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                          <span class="keywordtype">int</span> *h_islice_selected_rec, <span class="keywordtype">int</span> *h_ispec_selected_rec,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                          <span class="keywordtype">int</span> *NSPEC_CRUST_MANTLE, <span class="keywordtype">int</span> *NGLOB_CRUST_MANTLE,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                          <span class="keywordtype">int</span> *NSPEC_CRUST_MANTLE_STRAIN_ONLY,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                          <span class="keywordtype">int</span> *NSPEC_OUTER_CORE, <span class="keywordtype">int</span> *NGLOB_OUTER_CORE,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                          <span class="keywordtype">int</span> *NSPEC_INNER_CORE, <span class="keywordtype">int</span> *NGLOB_INNER_CORE,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                          <span class="keywordtype">int</span> *NSPEC_INNER_CORE_STRAIN_ONLY,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                          <span class="keywordtype">int</span> *SIMULATION_TYPE, <span class="keywordtype">int</span> *NOISE_TOMOGRAPHY,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                          <span class="keywordtype">int</span> *SAVE_FORWARD_f, <span class="keywordtype">int</span> *ABSORBING_CONDITIONS_f,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                          <span class="keywordtype">int</span> *OCEANS_f, <span class="keywordtype">int</span> *GRAVITY_f,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                                          <span class="keywordtype">int</span> *ROTATION_f, <span class="keywordtype">int</span> *EXACT_MASS_MATRIX_FOR_ROTATION_f,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                          <span class="keywordtype">int</span> *ATTENUATION_f, <span class="keywordtype">int</span> *UNDO_ATTENUATION_f,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                          <span class="keywordtype">int</span> *PARTIAL_PHYS_DISPERSION_ONLY_f, <span class="keywordtype">int</span> *USE_3D_ATTENUATION_ARRAYS_f,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                                          <span class="keywordtype">int</span> *COMPUTE_AND_STORE_STRAIN_f,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                          <span class="keywordtype">int</span> *ANISOTROPIC_3D_MANTLE_f, <span class="keywordtype">int</span> *ANISOTROPIC_INNER_CORE_f,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                          <span class="keywordtype">int</span> *SAVE_BOUNDARY_MESH_f,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                          <span class="keywordtype">int</span> *USE_MESH_COLORING_GPU_f,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                          <span class="keywordtype">int</span> *ANISOTROPIC_KL_f, <span class="keywordtype">int</span> *APPROXIMATE_HESS_KL_f,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                          <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *deltat_f, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_deltat_f,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                          <span class="keywordtype">int</span> *GPU_ASYNC_COPY_f) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_constants_device&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// allocates mesh parameter structure</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) malloc (<span class="keyword">sizeof</span> (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a>));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">// checks pointer</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (! mp) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;Error allocating mesh pointer&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// sets fortran pointer</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  *Mesh_pointer = (long) mp;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">// safety checks</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">// constants defined in constants.h and mesh_constants_gpu.h have to match</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (*h_NGLLX != <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a516b74fe7d258a4d363f4d53f5ad2b10">NGLLX</a>) { <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;NGLLX must be set to 5 for GPU devices in constants.h; please re-compile&quot;</span>); }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> (*GPU_ASYNC_COPY_f) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (! <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) { <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;GPU_ASYNC_COPY must be set to 1 for GPU devices in mesh_constants_gpu.h; please re-compile&quot;</span>); }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) { <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;GPU_ASYNC_COPY must be set to 0 for GPU devices in mesh_constants_gpu.h; please re-compile&quot;</span>); }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#ifdef USE_MESH_COLORING_GPU</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (! *USE_MESH_COLORING_GPU_f) { <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a>(<span class="stringliteral">&quot;Error with USE_MESH_COLORING_GPU constant; please re-compile\n&quot;</span>); }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// initializes gpu array pointers</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a1081c1ea3957b4700a6b5167520e8b04">gpuInitialize_buffers</a>(mp);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// MPI process rank</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a820d5ac890b8ec1089e1817a68510b0d">myrank</a> = *myrank_f;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// setup two streams, one for compute and one for host&lt;-&gt;device memory copies</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// uses pinned memory for asynchronous data transfers</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// note: creating streams may fail if multiple processes use a single GPU, and when CUDA devices are set</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">//       for exclusive usage. in this case, you will have to setup a CUDA multiple process service (MPS), aka CUDA proxy.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">//       see: https://docs.nvidia.com/deploy/pdf/CUDA_Multi_Process_Service_Overview.pdf</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">//            http://cudamusing.blogspot.ch/2013/07/enabling-cuda-multi-process-service-mps.html</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">//       for some reason, calling cudaSetDevice() may return success even when devices are exclusive,</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">//       and only when calling the cudaStreamCreate() below a cudaError occurs...</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// compute stream</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>( cudaStreamCreate(&amp;mp-&gt;compute_stream), 101);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// copy stream (needed to transfer MPI buffers)</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>( cudaStreamCreate(&amp;mp-&gt;copy_stream), 102);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// sets constant arrays</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a3b0e807f26ec763964da61255548f5d5">gpuSetConst</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa8b367229b0357f2ffc995ceb1481b59">d_hprime_xx</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>, h_hprime_xx);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a3b0e807f26ec763964da61255548f5d5">gpuSetConst</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa494ced6a0aefce755316d7881d7f350">d_hprimewgll_xx</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>, h_hprimewgll_xx);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a3b0e807f26ec763964da61255548f5d5">gpuSetConst</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#adc64359edf2a87893eddd4cf5cf6fce4">d_wgllwgll_xy</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>, h_wgllwgll_xy);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a3b0e807f26ec763964da61255548f5d5">gpuSetConst</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a521202fdc8f532221b5d3bb511f3da11">d_wgllwgll_xz</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>, h_wgllwgll_xz);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a3b0e807f26ec763964da61255548f5d5">gpuSetConst</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a766c20bb0f862bcb9fda52d216baf266">d_wgllwgll_yz</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>, h_wgllwgll_yz);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="comment">// textures</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_CONSTANTS</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    cl_int errcode;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    cl_image_format format = {CL_R, CL_UNSIGNED_INT32};</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    mp-&gt;d_hprime_xx_cm_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa8b367229b0357f2ffc995ceb1481b59">d_hprime_xx</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    mp-&gt;d_hprimewgll_xx_cm_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa494ced6a0aefce755316d7881d7f350">d_hprimewgll_xx</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#endif //USE_TEXTURES_CONSTANTS</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// Using texture memory for the hprime-style constants is slower on</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// Fermi generation hardware, but *may* be faster on Kepler</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// generation. We will reevaluate this again, so might as well leave</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// in the code with #USE_TEXTURES_FIELDS not-defined.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_CONSTANTS</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// checks that realw is a float</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>) != <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a>(<span class="stringliteral">&quot;TEXTURES only work with realw selected as float&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// note: device memory returned by cudaMalloc guarantee that the offset is 0,</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//       however here we use the global memory array d_hprime_xx and need to provide an offset variable</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">size_t</span> offset;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// binds textures</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#ifdef USE_OLDER_CUDA4_GPU</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc&lt;realw&gt;();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keyword">const</span> textureReference* d_hprime_xx_tex_ptr;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_hprime_xx_tex_ptr, <span class="stringliteral">&quot;d_hprime_xx_tex&quot;</span>), 1101);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(&amp;offset, d_hprime_xx_tex_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa8b367229b0357f2ffc995ceb1481b59">d_hprime_xx</a>,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                            &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>)), 1102);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// d_hprime_xx was cudaMalloced, so offset is 0</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">//print_CUDA_error_if_any(cudaMemcpyToSymbol(d_hprime_xx_tex_offset,&amp;offset,sizeof(offset)),11202);</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// weighted</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">const</span> textureReference* d_hprimewgll_xx_tex_ptr;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_hprimewgll_xx_tex_ptr, <span class="stringliteral">&quot;d_hprimewgll_xx_tex&quot;</span>), 1107);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(&amp;offset, d_hprimewgll_xx_tex_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa494ced6a0aefce755316d7881d7f350">d_hprimewgll_xx</a>,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                            &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>)), 1108);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">//print_CUDA_error_if_any(cudaMemcpyToSymbol(d_hprimewgll_xx_tex_offset,&amp;offset,sizeof(offset)),11205);</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc&lt;realw&gt;();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(&amp;offset, &amp;d_hprime_xx_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa8b367229b0357f2ffc995ceb1481b59">d_hprime_xx</a>.cuda,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                            &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>)), 11201);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// d_hprime_xx was cudaMalloced, so offset is 0</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">//print_CUDA_error_if_any(cudaMemcpyToSymbol(d_hprime_xx_tex_offset,&amp;offset,sizeof(offset)),11202);</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// debug</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">//if (mp-&gt;myrank == 0 ) printf(&quot;texture constants hprime_xx: offset = %lu \n&quot;,offset);</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// weighted</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(&amp;offset, &amp;d_hprimewgll_xx_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa494ced6a0aefce755316d7881d7f350">d_hprimewgll_xx</a>.cuda,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                            &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a>)), 11204);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">//print_CUDA_error_if_any(cudaMemcpyToSymbol(d_hprimewgll_xx_tex_offset,&amp;offset,sizeof(offset)),11205);</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// debug</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">//if (mp-&gt;myrank == 0 ) printf(&quot;texture constants hprimewgll_xx: offset = %lu \n&quot;,offset);</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// sets global parameters</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a> = *NSPEC_CRUST_MANTLE;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a666ace38b302f6cf2b04f50d89cc4c13">NGLOB_CRUST_MANTLE</a> = *NGLOB_CRUST_MANTLE;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1964cdc9086505e83de26cce859467ab">NSPEC_CRUST_MANTLE_STRAIN_ONLY</a> = *NSPEC_CRUST_MANTLE_STRAIN_ONLY;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a> = *NSPEC_OUTER_CORE;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a91945dcf3506fc89e08b15cbba533f88">NGLOB_OUTER_CORE</a> = *NGLOB_OUTER_CORE;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a> = *NSPEC_INNER_CORE;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a720c153b4667a50f70c05dc14b212af0">NGLOB_INNER_CORE</a> = *NGLOB_INNER_CORE;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa864f8a76a95345930b5fb96c48937a4">NSPEC_INNER_CORE_STRAIN_ONLY</a> = *NSPEC_INNER_CORE_STRAIN_ONLY;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// simulation type</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> = *SIMULATION_TYPE;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">noise_tomography</a> = *NOISE_TOMOGRAPHY;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// simulation flags initialization</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aba2f680cd1825a0f4227385ad1f19a66">save_forward</a> = *SAVE_FORWARD_f;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f2accdd148d23c3d3fbd5d486fe87b">absorbing_conditions</a> = *ABSORBING_CONDITIONS_f;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3238ddad7629b5a91162df8e7159a453">oceans</a> = *OCEANS_f;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#add67861d6106aea8784d1998c5f1bf9d">gravity</a> = *GRAVITY_f;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a> = *ROTATION_f;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">exact_mass_matrix_for_rotation</a> = *EXACT_MASS_MATRIX_FOR_ROTATION_f;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2f75e1ea687c10ba2be829306146bc07">attenuation</a> = *ATTENUATION_f;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af9ed3392c5155cd8ef14831c97fb8e4a">undo_attenuation</a> = *UNDO_ATTENUATION_f;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc8d971c041bd9ed76db6efa94b2f95">partial_phys_dispersion_only</a> = *PARTIAL_PHYS_DISPERSION_ONLY_f;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1b723b9bc383b498b998e58cd965cfff">use_3d_attenuation_arrays</a> = *USE_3D_ATTENUATION_ARRAYS_f;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a02f54fb788adbc4c2cdc0ef1aa6af675">compute_and_store_strain</a> = *COMPUTE_AND_STORE_STRAIN_f;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0d6ef87cdf2480b2e8280f635144ae5a">anisotropic_3D_mantle</a> = *ANISOTROPIC_3D_MANTLE_f;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae1cec79cc3c64d136833423748e8fd8d">anisotropic_inner_core</a> = *ANISOTROPIC_INNER_CORE_f;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad42e27d6a609002565b3c2abf70e4892">save_boundary_mesh</a> = *SAVE_BOUNDARY_MESH_f;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6efbdbbf072565c01800e39dee48cae6">anisotropic_kl</a> = *ANISOTROPIC_KL_f;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abf5df7ac66d415133867fae752f5b52e">approximate_hess_kl</a> = *APPROXIMATE_HESS_KL_f;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// mesh coloring flag</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#ifdef USE_MESH_COLORING_GPU</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8f5791decaebb152fd8a4dc8bcc36889">use_mesh_coloring_gpu</a> = 1;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// mesh coloring</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// note: this here passes the coloring as an option to the kernel routines</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">//          the performance seems to be the same if one uses the pre-processing directives above or not</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8f5791decaebb152fd8a4dc8bcc36889">use_mesh_coloring_gpu</a> = *USE_MESH_COLORING_GPU_f;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// sets flag to check if we need to save the stacey contributions to file</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af9ed3392c5155cd8ef14831c97fb8e4a">undo_attenuation</a>) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// not needed for undo_attenuation scheme</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a> = 0;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">// used for simulation type 1 and 3</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> ((mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 1 &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aba2f680cd1825a0f4227385ad1f19a66">save_forward</a>) || (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3)) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a> = 1;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a> = 0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// sources</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a69d60ae1c90efdc57064c7c37dbfea43">nsources_local</a> = *<a class="code" href="../../db/da6/namespacespecfem__par.html#aea1fca219d1f757235a8d2f525f02356">nsources_local</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 1 || mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// not needed in case of pure adjoint simulations (SIMULATION_TYPE == 2)</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a30f1cbb0e80d6839e5243e28874c2c55">d_sourcearrays</a>, h_sourcearrays, (*NSOURCES) * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// allocates buffer on GPU for source time function values</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#ab289e448fd708ebd6595ddbea46258ba">gpuMalloc_double</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4ba3bc5cb5d83c7cf3a2529690972cf6">d_stf_pre_compute</a>, *NSOURCES);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4337f7490448e25af5bc44230270ce1d">d_islice_selected_source</a>, h_islice_selected_source, *NSOURCES);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a46fd62f2a18df5fee4323c126e904a9a">d_ispec_selected_source</a>, h_ispec_selected_source, *NSOURCES);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// receiver stations</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// note that:   size (number_receiver_global) = nrec_local</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">//                   size (ispec_selected_rec) = nrec</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">// number of receiver located in this partition</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a> = *<a class="code" href="../../db/da6/namespacespecfem__par.html#a9f379a3538eda57a62dca8839eaa8ede">nrec_local</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a> &gt; 0) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa020a4e27290b96ff34aa0efb2c0ec23">d_number_receiver_global</a>, h_number_receiver_global, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// for seismograms</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab2427c5b309fdc32ea4bda0759b8e6c5">d_station_seismo_field</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// for transferring values from GPU to CPU</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a> (station_seismo_field, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * NGLL3 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>));</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">// TODO</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">// only pinned memory can handle memcpy calls asynchronously</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7bd4681d488cb7929ea7f7a44d98a7f2">h_station_seismo_field</a>), <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*NGLL3*(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a>)*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)),4015);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7bd4681d488cb7929ea7f7a44d98a7f2">h_station_seismo_field</a> = (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *) malloc (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * NGLL3 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7bd4681d488cb7929ea7f7a44d98a7f2">h_station_seismo_field</a> == NULL) { <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a>(<span class="stringliteral">&quot;h_station_seismo_field not allocated \n&quot;</span>); }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// for adjoint strain</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 2) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a543f8dfc4d0eb6918d4b6311e5dbc841">d_station_strain_field</a>, NGLL3 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7f63fbf5229ca2f6879820443635bb44">h_station_strain_field</a> = (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *) malloc (NGLL3 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>));</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7f63fbf5229ca2f6879820443635bb44">h_station_strain_field</a> == NULL) { <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a>(<span class="stringliteral">&quot;h_station_strain_field not allocated \n&quot;</span>); }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad404fad4a9d6ab87708de919974850e4">d_ispec_selected_rec</a>, h_ispec_selected_rec, *nrec);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// receiver adjoint source arrays only used for noise and adjoint simulations</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// adjoint source arrays</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a> = *<a class="code" href="../../db/da6/namespacespecfem__par.html#af51bb5088c83df67979f2df0be588ead">nadj_rec_local</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a> &gt; 0) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// adjoint simulations</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// checks simulation flag</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> != 2 &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> != 3 )</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;prepare_constants_device: nadj_rec_local invalid with simulation type\n&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// prepares local irec array:</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#ab033e54a75c99f91774a713597fc575e">gpuMalloc_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a45dfd81d4414869744dea84b67a292db">d_pre_computed_irec</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// the irec_local variable needs to be precomputed (as</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// h_pre_comp..), because normally it is in the loop updating accel,</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// and due to how it&#39;s incremented, it cannot be parallelized</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">int</span> *h_pre_computed_irec = (<span class="keywordtype">int</span> *) malloc (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a> * sizeof (<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (h_pre_computed_irec == NULL) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;h_pre_computed_irec not allocated\n&quot;</span>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// sets up local irec array</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">int</span> irec_local = 0;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">int</span> irec;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">for</span> (irec = 0; irec &lt; *<a class="code" href="../../db/da6/namespacespecfem__par.html#a38b32e638a9586e79e6a82c60461ce5f">nrec</a>; irec++) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a820d5ac890b8ec1089e1817a68510b0d">myrank</a> == h_islice_selected_rec[irec]) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        irec_local++;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        h_pre_computed_irec[irec_local-1] = irec;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (irec_local != mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a>) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;prepare_constants_device: irec_local not equal to nadj_rec_local\n&quot;</span>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// copies values onto GPU</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a37018d157d792ef9b9ad2d2302224cf9">gpuCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a45dfd81d4414869744dea84b67a292db">d_pre_computed_irec</a>, h_pre_computed_irec, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    free (h_pre_computed_irec);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// temporary array to prepare extracted source array values</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(adj_sourcearrays_slice, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>));</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// note: Allocate pinned buffers otherwise cudaMemcpyAsync() will behave like cudaMemcpy(), i.e. synchronously.</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f0273a931d5d73e16b52232fa03281">h_adj_sourcearrays_slice</a>),</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                               (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a>)*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)),6011);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f0273a931d5d73e16b52232fa03281">h_adj_sourcearrays_slice</a> = (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *) malloc (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f0273a931d5d73e16b52232fa03281">h_adj_sourcearrays_slice</a> == NULL) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;h_adj_sourcearrays_slice not allocated\n&quot;</span>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad72bc437a1b6e31d51c90b21d395a894">d_adj_sourcearrays</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">// for rotation and new attenuation</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a81a257a82f245406d679614e460478f3">deltat</a> = *deltat_f;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abd8bb2afb96cdfa54334123559884268">b_deltat</a> = *b_deltat_f;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// initializes for rotational effects</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5a8e4f4b71f788c730e63c7ef8a9290a">two_omega_earth</a> = 0.f;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#add66897c42cd7511d8b0c766f834c4b3">b_two_omega_earth</a> = 0.f;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    mp-&gt;has_last_copy_evt = 0;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// buffer for norm checking at every timestamp</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">int</span> blocksize = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#abe78859dd304b9e1b6fdf86ca238f35a">BLOCKSIZE_TRANSFER</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">int</span> size,size_padded;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">int</span> num_blocks_x,num_blocks_y;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// buffer for crust_mantle arrays has maximum size</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a02f54fb788adbc4c2cdc0ef1aa6af675">compute_and_store_strain</a>){</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ada2b3c6ed5b544b7585d9540c134c6f9">MAX</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a666ace38b302f6cf2b04f50d89cc4c13">NGLOB_CRUST_MANTLE</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>));</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  } <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    size = mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a666ace38b302f6cf2b04f50d89cc4c13">NGLOB_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  size_padded = ((int) ceil (((<span class="keywordtype">double</span>) size) / ((double) blocksize))) * blocksize;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a8bfa3716eff7e36136643375026c81e1">get_blocks_xy</a> (size_padded / blocksize, &amp;num_blocks_x, &amp;num_blocks_y);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// creates buffer on GPU for maximum array values</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5b2bb6e71a612e82d011de3380445121">d_norm_max</a>, num_blocks_x * num_blocks_y);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">// synchronizes gpu calls</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a8188c1c360944920584b2a0a1f9bf8ac">gpuSynchronize</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_constants_device&quot;</span>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">// ROTATION simulations</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#ab7bb1492b980bcbeba68eeab515b1404">  438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_fields_rotation_device,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;               PREPARE_FIELDS_ROTATION_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *two_omega_earth_f,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *A_array_rotation,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *B_array_rotation,</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_two_omega_earth_f,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_A_array_rotation,</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_B_array_rotation,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                                <span class="keywordtype">int</span> *NSPEC_OUTER_CORE_ROTATION) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_fields_rotation_device&quot;</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// arrays only needed when rotation is required</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a>) {<a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a>(<span class="stringliteral">&quot;prepare_fields_rotation_device: rotation flag not properly initialized&quot;</span>);}</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// checks array size</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">if</span> (*NSPEC_OUTER_CORE_ROTATION != mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    printf (<span class="stringliteral">&quot;Error prepare_fields_rotation_device: rotation array has wrong size: %d instead of %d\n&quot;</span>,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            *NSPEC_OUTER_CORE_ROTATION, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;prepare_fields_rotation_device: rotation array has wrong size&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">// rotation arrays (needed only for outer core region)</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5a8e4f4b71f788c730e63c7ef8a9290a">two_omega_earth</a> = *two_omega_earth_f;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a040f596b4e803a1ca439e29dad9e25a3">d_A_array_rotation</a>, A_array_rotation, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a697f1440498e8a89321f35a60f94e68d">d_B_array_rotation</a>, B_array_rotation, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">// backward/reconstructed fields</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#add66897c42cd7511d8b0c766f834c4b3">b_two_omega_earth</a> = *b_two_omega_earth_f;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a20889301eb6aebebcc62fd450e903337">d_b_A_array_rotation</a>, b_A_array_rotation, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4c3b7504c2164627800c2e02afe8347e">d_b_B_array_rotation</a>, b_B_array_rotation, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_fields_rotation_device&quot;</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">// GRAVITY simulations</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#aed404c3cb09c50debf0ec980f0830c09">  482</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_fields_gravity_device,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;               PREPARE_FIELDS_gravity_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                               <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#add310657fc343aca4beb0444b63c696e">d_ln_density_dr_table</a>,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                               <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#aa436134d42e4e7b7684eb61dd9199c4e">minus_rho_g_over_kappa_fluid</a>,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                               <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#ace0b4aaf3060b64372a065ed869a39f9">minus_gravity_table</a>,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                               <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#aea72272422e24b7eba77f1cce2e4596d">minus_deriv_gravity_table</a>,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                               <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a84cd50adbc76914ab50f01f587c9b4bf">density_table</a>,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                               <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_wgll_cube,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                               <span class="keywordtype">int</span> *NRAD_GRAVITY,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                               <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a8790e4c2b52c1adff453e94b14d3d18f">minus_g_icb</a>,</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                               <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a78c92555ba8fd54f19470d4a9ea247ea">minus_g_cmb</a>,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                               <span class="keywordtype">double</span> *RHO_BOTTOM_OC,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                               <span class="keywordtype">double</span> *RHO_TOP_OC) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_fields_gravity_device&quot;</span>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">if</span> (!mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#add67861d6106aea8784d1998c5f1bf9d">gravity</a>) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">// no gravity case</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// d ln (rho)/dr needed for the no gravity fluid potential</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a914b75504cecab3c01b2136d87dad438">d_d_ln_density_dr_table</a>, d_ln_density_dr_table, *NRAD_GRAVITY);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">// gravity case</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6baad7ef1ad9769ac7fb321bd7c15069">minus_g_icb</a> = *<a class="code" href="../../db/da6/namespacespecfem__par.html#a8790e4c2b52c1adff453e94b14d3d18f">minus_g_icb</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a56660650b9817f854faa7ddac0509704">minus_g_cmb</a> = *<a class="code" href="../../db/da6/namespacespecfem__par.html#a78c92555ba8fd54f19470d4a9ea247ea">minus_g_cmb</a>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// sets up GLL weights cubed</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a3b0e807f26ec763964da61255548f5d5">gpuSetConst</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af08c0acf55538f5408e5ef38bfec9c14">d_wgll_cube</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>, h_wgll_cube);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// prepares gravity arrays</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a088123526218cdd346388b677f272acc">d_minus_rho_g_over_kappa_fluid</a>, minus_rho_g_over_kappa_fluid, *NRAD_GRAVITY);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2474e65348de287385f1783d08757635">d_minus_gravity_table</a>, minus_gravity_table, *NRAD_GRAVITY);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a277c63d71bafe01200a4b9699e73d02e">d_minus_deriv_gravity_table</a>, minus_deriv_gravity_table, *NRAD_GRAVITY);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a887c3a0fd18bee41caf8c974028bc59b">d_density_table</a>, density_table, *NRAD_GRAVITY);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// constants</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad9595451c1bb1e6c75812c3c2fcdcfaa">RHO_BOTTOM_OC</a> = (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>) *RHO_BOTTOM_OC;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac658b66a3451c8ab60e252a6a2e7ab3c">RHO_TOP_OC</a> = (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>) *RHO_TOP_OC;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_fields_gravity_device&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">// ATTENUATION simulations</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a1e7d98d724a5099e576c59450e940af1">  533</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_fields_attenuat_device,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;               PREPARE_FIELDS_ATTENUAT_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_xx_crust_mantle,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_yy_crust_mantle,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_xy_crust_mantle,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_xz_crust_mantle,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_yz_crust_mantle,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_xx_crust_mantle,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_yy_crust_mantle,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_xy_crust_mantle,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_xz_crust_mantle,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_yz_crust_mantle,</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a3c173838807a44c10e8bd7a682c9a006">factor_common_crust_mantle</a>,</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#accfb22fccbb7ddc7db535858481d41a2">one_minus_sum_beta_crust_mantle</a>,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_xx_inner_core,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_yy_inner_core,</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_xy_inner_core,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_xz_inner_core,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *R_yz_inner_core,</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_xx_inner_core,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_yy_inner_core,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_xy_inner_core,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_xz_inner_core,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *b_R_yz_inner_core,</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#ac947b1846fdd4c58c9ee9455d0f76ed3">factor_common_inner_core</a>,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#ac3e2ddf13e6efcb60714ca22a0d7700c">one_minus_sum_beta_inner_core</a>,</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a2cd8b81e24d392b78d39dc30d4181e81">alphaval</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#ab8acf6b7a548c8cf7f4e49e8fc995ebc">betaval</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a1bff53d8ce4e2da9592c2aa37989a78a">gammaval</a>,</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                                <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a32c39df330bd0bda579e675ae95d562a">b_alphaval</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#ab8505f78a1c5cc261234ccff68cebff9">b_betaval</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/da6/namespacespecfem__par.html#aff169512faceffc002e35364eba59ce8">b_gammaval</a>) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_fields_attenuat_device&quot;</span>);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordtype">int</span> R_size1, R_size2, R_size3;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// checks flag</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2f75e1ea687c10ba2be829306146bc07">attenuation</a>) { <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a>(<span class="stringliteral">&quot;prepare_fields_attenuat_device attenuation not properly initialized&quot;</span>); }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// crust_mantle</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  R_size1 = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1b723b9bc383b498b998e58cd965cfff">use_3d_attenuation_arrays</a>) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    R_size2 = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    R_size3 = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    R_size2 = 1*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    R_size3 = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>*1*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a553b6e29f88b6cdc8c9579a369fd2e83">d_one_minus_sum_beta_crust_mantle</a>, one_minus_sum_beta_crust_mantle, R_size2);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc8d971c041bd9ed76db6efa94b2f95">partial_phys_dispersion_only</a>) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// common factor</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#adb4fe4d689e1b54986b21462362c6e17">d_factor_common_crust_mantle</a>, factor_common_crust_mantle, R_size3);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// memory variables</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8b5d44da0448862e6dff3f9768b7a387">d_R_xx_crust_mantle</a>, R_xx_crust_mantle, R_size1);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a828f870e9738bb778920e6cbb4e27c26">d_R_yy_crust_mantle</a>, R_yy_crust_mantle, R_size1);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad17b618ef4424736feef1e0a7536f299">d_R_xy_crust_mantle</a>, R_xy_crust_mantle, R_size1);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abd2a0ea38bf4d5f605e88124ebed2123">d_R_xz_crust_mantle</a>, R_xz_crust_mantle, R_size1);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad98a9518680f56d4ce1f6c2e7f6e2ce0">d_R_yz_crust_mantle</a>, R_yz_crust_mantle, R_size1);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc8d971c041bd9ed76db6efa94b2f95">partial_phys_dispersion_only</a>) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="comment">// memory variables</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afe49023b8454b69b83f7f2d83bbf8f04">d_b_R_xx_crust_mantle</a>, b_R_xx_crust_mantle, R_size1);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aec5fe5c75fe1583e7b5af293a0de3b2c">d_b_R_yy_crust_mantle</a>, b_R_yy_crust_mantle, R_size1);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8ccc22b60c21d89cb0a3c6de925a2c0e">d_b_R_xy_crust_mantle</a>, b_R_xy_crust_mantle, R_size1);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a17d12485a91230278ccf687c0aa23aaa">d_b_R_xz_crust_mantle</a>, b_R_xz_crust_mantle, R_size1);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a11faf67dc86f02ce860e3f7add840c48">d_b_R_yz_crust_mantle</a>, b_R_yz_crust_mantle, R_size1);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">// inner_core</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  R_size1 = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1b723b9bc383b498b998e58cd965cfff">use_3d_attenuation_arrays</a>) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    R_size2 = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    R_size3 = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    R_size2 = 1*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    R_size3 = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>*1*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a62a91a122e4e1ffc161b17d7c088fcae">d_one_minus_sum_beta_inner_core</a>, one_minus_sum_beta_inner_core, R_size2);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc8d971c041bd9ed76db6efa94b2f95">partial_phys_dispersion_only</a>) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// common factor</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab92f56d46a7c7f8748d26d17290d20a0">d_factor_common_inner_core</a>, factor_common_inner_core, R_size3);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// memory variables</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad5e42fcf68a2053965029c0725c5305f">d_R_xx_inner_core</a>, R_xx_inner_core, R_size1);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afd905bb6aa0bd951e0f97931f14dcaf2">d_R_yy_inner_core</a>, R_yy_inner_core, R_size1);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa772b8837e77ed340f0c6af5cdfa73ea">d_R_xy_inner_core</a>, R_xy_inner_core, R_size1);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a862349f3ee6655dcdefea1d0364dd9a4">d_R_xz_inner_core</a>, R_xz_inner_core, R_size1);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35353d78198f805b8820aafaada5c7c4">d_R_yz_inner_core</a>, R_yz_inner_core, R_size1);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc8d971c041bd9ed76db6efa94b2f95">partial_phys_dispersion_only</a>) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">// memory variables</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a47eb3eeb8cd237e52a4a2cec10862845">d_b_R_xx_inner_core</a>, b_R_xx_inner_core, R_size1);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab629dcee54f251fa33c897da1fc0e4a3">d_b_R_yy_inner_core</a>, b_R_yy_inner_core, R_size1);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a488717b9193bbc8b134e0c34ccc0f77d">d_b_R_xy_inner_core</a>, b_R_xy_inner_core, R_size1);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad498f1e815ea41528f72120ddb7533e3">d_b_R_xz_inner_core</a>, b_R_xz_inner_core, R_size1);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac30f1e23c623f792e94ce635d6e83291">d_b_R_yz_inner_core</a>, b_R_yz_inner_core, R_size1);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">// alpha, beta, gamma factors</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae76c60914b944131d687ecb85b337835">d_alphaval</a>, alphaval, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a12137d1e3db2cdd7d5fcb63a7c7085e4">d_betaval</a>, betaval, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4bfeec96b6fae162cba9bcacebefbbbe">d_gammaval</a>, gammaval, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// alpha, beta, gamma factors for backward fields</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab027bfc3485ed571028a1d35c9b2627d">d_b_alphaval</a>, b_alphaval, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af15850cf201bf9ceea045d775045f674">d_b_betaval</a>, b_betaval, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22d60235f9a92926b4db648eb5bf464">d_b_gammaval</a>, <a class="code" href="../../db/da6/namespacespecfem__par.html#aff169512faceffc002e35364eba59ce8">b_gammaval</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_fields_attenuat_device&quot;</span>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;}</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">// STRAIN simulations</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4af8b456dc4589b0e4d29b26701f6f1b">  659</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_fields_strain_device,</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;               PREPARE_FIELDS_STRAIN_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a729af34ce8da88dce90f9bd709968319">epsilondev_xx_crust_mantle</a>,</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a76119f983855d9e8873791d01b79df64">epsilondev_yy_crust_mantle</a>,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#abaec810dab5233772689b8d71670901d">epsilondev_xy_crust_mantle</a>,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a6236cd793e5e9c5bc2d6a87145aedd5c">epsilondev_xz_crust_mantle</a>,</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#af7e6ace16498f264a480ea2ede9e05a7">epsilondev_yz_crust_mantle</a>,</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a57286a1a83f8909a008f5353c8cebe0d">b_epsilondev_xx_crust_mantle</a>,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a3fcef2949baf05eaaaef813179b762d2">b_epsilondev_yy_crust_mantle</a>,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a21afb5998b855dee48741d465dc0aef1">b_epsilondev_xy_crust_mantle</a>,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a54c1072e5eb76d20783186dfeab590e5">b_epsilondev_xz_crust_mantle</a>,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a7534b8a728f07ec6658ae68ec7c6c567">b_epsilondev_yz_crust_mantle</a>,</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a1c86d6711f67cc1ca7b0f986cbd9b019">eps_trace_over_3_crust_mantle</a>,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#af868e4fb902404c57716fed4050b0e50">b_eps_trace_over_3_crust_mantle</a>,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a686e0cade6b09290c835a7d39ee977c3">epsilondev_xx_inner_core</a>,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a0c378d7240877f122f2eb57dc073aaca">epsilondev_yy_inner_core</a>,</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#aaad41bce9a96bf9f96f4dda5f292eaa3">epsilondev_xy_inner_core</a>,</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a3aac86945ecfb39c3e1d989427b1b179">epsilondev_xz_inner_core</a>,</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#acb2f0d4538838c2fcf191413299fa575">epsilondev_yz_inner_core</a>,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a0e3ec48df0ca1f6438f681f0d4ea8120">b_epsilondev_xx_inner_core</a>,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a57bdfca4bfa372e3c9e225c6c5a9fb82">b_epsilondev_yy_inner_core</a>,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a89fc4d59c0bbb8de587229f9df7febfc">b_epsilondev_xy_inner_core</a>,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#ab33f78a3524ed71bd229ef29961c30e5">b_epsilondev_xz_inner_core</a>,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a66151b800b1fe6fb45038503e36732f4">b_epsilondev_yz_inner_core</a>,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a14be334156b1d0dd55e1868f63e97282">eps_trace_over_3_inner_core</a>,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a56665f1a7d2cade723aa84b00b1afa30">b_eps_trace_over_3_inner_core</a>) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_fields_strain_device&quot;</span>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <span class="keywordtype">int</span> R_size, size_strain_only;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// checks flag</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">if</span> (!mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a02f54fb788adbc4c2cdc0ef1aa6af675">compute_and_store_strain</a>) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;prepare_fields_strain_device strain not properly initialized&quot;</span>);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="comment">// crust_mantle</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  R_size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3031d8304f5c5ba2ff1af0708909ffdb">d_epsilondev_xx_crust_mantle</a>, epsilondev_xx_crust_mantle, R_size);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ada3d32d67768986408c59934ae3419ff">d_epsilondev_yy_crust_mantle</a>, epsilondev_yy_crust_mantle, R_size);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8d022c01dc285d81a6f2f609b05aebd4">d_epsilondev_xy_crust_mantle</a>, epsilondev_xy_crust_mantle, R_size);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa81ead1f92ffef0fc9e45606814e606c">d_epsilondev_xz_crust_mantle</a>, epsilondev_xz_crust_mantle, R_size);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a52d5a8e4dceed2fd59279003c594b5a0">d_epsilondev_yz_crust_mantle</a>, epsilondev_yz_crust_mantle, R_size);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="comment">// strain</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  size_strain_only = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1964cdc9086505e83de26cce859467ab">NSPEC_CRUST_MANTLE_STRAIN_ONLY</a>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afeb1c65fd7d0827a663fa286cb07dde5">d_eps_trace_over_3_crust_mantle</a>, eps_trace_over_3_crust_mantle, size_strain_only);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">// backward/reconstructed fields</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af9ed3392c5155cd8ef14831c97fb8e4a">undo_attenuation</a>) {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="comment">// strain will be computed locally based on displacement wavefield</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="comment">// only uses pointers to already allocated arrays</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3527d35e7c96aa03b9efce9613767592">d_b_epsilondev_xx_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3031d8304f5c5ba2ff1af0708909ffdb">d_epsilondev_xx_crust_mantle</a>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0e5b1c3e4efe36916902880ee5ee0b43">d_b_epsilondev_yy_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ada3d32d67768986408c59934ae3419ff">d_epsilondev_yy_crust_mantle</a>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8c9b781c9bb0ea693399f14971e5ce7">d_b_epsilondev_xy_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8d022c01dc285d81a6f2f609b05aebd4">d_epsilondev_xy_crust_mantle</a>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af8bd069f109d24c07e4935e8b8a11e80">d_b_epsilondev_xz_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa81ead1f92ffef0fc9e45606814e606c">d_epsilondev_xz_crust_mantle</a>);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a942ba73a8631a5efea8683e0d9d7d980">d_b_epsilondev_yz_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a52d5a8e4dceed2fd59279003c594b5a0">d_epsilondev_yz_crust_mantle</a>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac2e444710777a5041eb42090670a8b66">d_b_eps_trace_over_3_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afeb1c65fd7d0827a663fa286cb07dde5">d_eps_trace_over_3_crust_mantle</a>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3527d35e7c96aa03b9efce9613767592">d_b_epsilondev_xx_crust_mantle</a>, b_epsilondev_xx_crust_mantle, R_size);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0e5b1c3e4efe36916902880ee5ee0b43">d_b_epsilondev_yy_crust_mantle</a>, b_epsilondev_yy_crust_mantle, R_size);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8c9b781c9bb0ea693399f14971e5ce7">d_b_epsilondev_xy_crust_mantle</a>, b_epsilondev_xy_crust_mantle, R_size);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af8bd069f109d24c07e4935e8b8a11e80">d_b_epsilondev_xz_crust_mantle</a>, b_epsilondev_xz_crust_mantle, R_size);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a942ba73a8631a5efea8683e0d9d7d980">d_b_epsilondev_yz_crust_mantle</a>, b_epsilondev_yz_crust_mantle, R_size);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="comment">//strain</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac2e444710777a5041eb42090670a8b66">d_b_eps_trace_over_3_crust_mantle</a>, b_eps_trace_over_3_crust_mantle, R_size);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">// inner_core</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  R_size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a15094f7c6fd3180c961aedf9a2790ef7">d_epsilondev_xx_inner_core</a>, epsilondev_xx_inner_core, R_size);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a4ca0cb83ae4b36c5b5d6a844970987">d_epsilondev_yy_inner_core</a>, epsilondev_yy_inner_core, R_size);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae67d8ce2ec9fb40cc53aaa08d51a9a91">d_epsilondev_xy_inner_core</a>, epsilondev_xy_inner_core, R_size);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a31ead77ca0a77f247fa9fdb406e4dd56">d_epsilondev_xz_inner_core</a>, epsilondev_xz_inner_core, R_size);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a5c6dac0533a51d2551bccdb1ff5a21">d_epsilondev_yz_inner_core</a>, epsilondev_yz_inner_core, R_size);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">// strain</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  size_strain_only = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa864f8a76a95345930b5fb96c48937a4">NSPEC_INNER_CORE_STRAIN_ONLY</a>);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3d75627c48c86823e4cadfee2b5fa26e">d_eps_trace_over_3_inner_core</a>, eps_trace_over_3_inner_core, size_strain_only);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="comment">// backward/reconstructed fields</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af9ed3392c5155cd8ef14831c97fb8e4a">undo_attenuation</a>) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="comment">// strain will be computed locally based on displacement wavefield</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="comment">// only uses pointers to already allocated arrays</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae4c74710535027d0060b48e4f7c25908">d_b_epsilondev_xx_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a15094f7c6fd3180c961aedf9a2790ef7">d_epsilondev_xx_inner_core</a>);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3c5585d9684da69e8bd37a87437dfaa3">d_b_epsilondev_yy_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a4ca0cb83ae4b36c5b5d6a844970987">d_epsilondev_yy_inner_core</a>);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab4605156829d24601b63e2a33693d258">d_b_epsilondev_xy_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae67d8ce2ec9fb40cc53aaa08d51a9a91">d_epsilondev_xy_inner_core</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad7d379e75cd23c21405ca7b28eff414a">d_b_epsilondev_xz_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a31ead77ca0a77f247fa9fdb406e4dd56">d_epsilondev_xz_inner_core</a>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab720949e150adec27caa401394a0aa42">d_b_epsilondev_yz_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a5c6dac0533a51d2551bccdb1ff5a21">d_epsilondev_yz_inner_core</a>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0e7b57e9d26992326ac637c11e345ca9">d_b_eps_trace_over_3_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3d75627c48c86823e4cadfee2b5fa26e">d_eps_trace_over_3_inner_core</a>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae4c74710535027d0060b48e4f7c25908">d_b_epsilondev_xx_inner_core</a>, b_epsilondev_xx_inner_core, R_size);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3c5585d9684da69e8bd37a87437dfaa3">d_b_epsilondev_yy_inner_core</a>, b_epsilondev_yy_inner_core, R_size);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab4605156829d24601b63e2a33693d258">d_b_epsilondev_xy_inner_core</a>, b_epsilondev_xy_inner_core, R_size);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad7d379e75cd23c21405ca7b28eff414a">d_b_epsilondev_xz_inner_core</a>, b_epsilondev_xz_inner_core, R_size);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab720949e150adec27caa401394a0aa42">d_b_epsilondev_yz_inner_core</a>, b_epsilondev_yz_inner_core, R_size);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="comment">// strain</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0e7b57e9d26992326ac637c11e345ca9">d_b_eps_trace_over_3_inner_core</a>, <a class="code" href="../../db/dc2/namespacespecfem__par__innercore.html#a56665f1a7d2cade723aa84b00b1afa30">b_eps_trace_over_3_inner_core</a>, R_size);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_fields_strain_device&quot;</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;}</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">// STRAIN simulations</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a18215ae6ba6f2af867b6e13c583d5026">  771</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_fields_absorb_device,</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;               PREPARE_FIELDS_ABSORB_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                                              <span class="keywordtype">int</span> *nspec2D_xmin_crust_mantle, <span class="keywordtype">int</span> *nspec2D_xmax_crust_mantle,</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                                              <span class="keywordtype">int</span> *nspec2D_ymin_crust_mantle, <span class="keywordtype">int</span> *nspec2D_ymax_crust_mantle,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                              <span class="keywordtype">int</span> *NSPEC2DMAX_XMIN_XMAX_CM, <span class="keywordtype">int</span> *NSPEC2DMAX_YMIN_YMAX_CM,</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a4f81050333e0c57f60b59ed7374c18b9">nimin_crust_mantle</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#aa0168d93da247207d6e594fd9d9d9858">nimax_crust_mantle</a>,</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#adde89a3fca80e5e2e3f09768f504fc28">njmin_crust_mantle</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#acff5c35418e6a16157947464edf75a02">njmax_crust_mantle</a>,</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a496ae848de5ecf8a51202b2bdf691c48">nkmin_xi_crust_mantle</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a364acd2e368b9cbc7bc0d4cb6de758c5">nkmin_eta_crust_mantle</a>,</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#aca9ac56779b1c2170f770e2be59bdc18">ibelm_xmin_crust_mantle</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#afdf7cf23bc7ee59e527aa8e17fc745ad">ibelm_xmax_crust_mantle</a>,</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a8a0f3bd5734e22a81d6ff8899cda25dd">ibelm_ymin_crust_mantle</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#ac5a9f45740c1f7f90aefe52f7e73a27e">ibelm_ymax_crust_mantle</a>,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#aa43762d4e89d7edfd94cd9e36002ae69">normal_xmin_crust_mantle</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a0c24836ef860cb23b2e7dabbb3557cdc">normal_xmax_crust_mantle</a>,</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a2e141d2dc4a3ec334e819645e1e2dfb6">normal_ymin_crust_mantle</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a52fe1cf5a65aaeaa8274a8c0d8eb4e9b">normal_ymax_crust_mantle</a>,</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_xmin_crust_mantle, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_xmax_crust_mantle,</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_ymin_crust_mantle, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_ymax_crust_mantle,</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a1f027733ff6e07c3fccf53c9bded89b4">rho_vp_crust_mantle</a>,</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/dc0/namespacespecfem__par__crustmantle.html#aaeb0a525a53440934c57f92239340064">rho_vs_crust_mantle</a>,</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                              <span class="keywordtype">int</span> *nspec2D_xmin_outer_core, <span class="keywordtype">int</span> *nspec2D_xmax_outer_core,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                              <span class="keywordtype">int</span> *nspec2D_ymin_outer_core, <span class="keywordtype">int</span> *nspec2D_ymax_outer_core,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                              <span class="keywordtype">int</span> *nspec2D_zmin_outer_core,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                              <span class="keywordtype">int</span> *NSPEC2DMAX_XMIN_XMAX_OC, <span class="keywordtype">int</span> *NSPEC2DMAX_YMIN_YMAX_OC,</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#a3ca8b9344966daaff04fd2e497481167">nimin_outer_core</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#a3855e14bb491e1b1594b401d458ae8df">nimax_outer_core</a>,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#a8e9d726bdc6cffe7b682d3ee02d5025d">njmin_outer_core</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#ab9832938b064d570ab7c9f479b7d9df3">njmax_outer_core</a>,</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#a40841234f7ce07beaf7698db262bb166">nkmin_xi_outer_core</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#a03d7c31905d6ab2bafe21f6998f466aa">nkmin_eta_outer_core</a>,</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#a0e2c01157da6742a87f9d4b0c8d393fe">ibelm_xmin_outer_core</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#a4f45cf7e4bb3adbd6a6e7164d65955c5">ibelm_xmax_outer_core</a>,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                              <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#a70b123213653570df018764edac05ce8">ibelm_ymin_outer_core</a>, <span class="keywordtype">int</span> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#aa355faffe8b88e62355f7b3ce72828c1">ibelm_ymax_outer_core</a>,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_xmin_outer_core, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_xmax_outer_core,</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_ymin_outer_core, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_ymax_outer_core,</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                              <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#ad1e88500ba5ca47f77908018f53d4a3b">vp_outer_core</a>) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_fields_absorb_device&quot;</span>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordtype">int</span> size;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">// checks flag</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f2accdd148d23c3d3fbd5d486fe87b">absorbing_conditions</a>) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;prepare_fields_absorb_device absorbing_conditions not properly initialized&quot;</span>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="comment">// crust_mantle</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff06dab5e4c140b9181104caf915cd09">nspec2D_xmin_crust_mantle</a> = *nspec2D_xmin_crust_mantle;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab16d7257d92a7cb9b29d1b461843db63">nspec2D_xmax_crust_mantle</a> = *nspec2D_xmax_crust_mantle;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf09f07450524877347548fdb88ffd22">nspec2D_ymin_crust_mantle</a> = *nspec2D_ymin_crust_mantle;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f641dd67cff778bce7ff8403bf06fa">nspec2D_ymax_crust_mantle</a> = *nspec2D_ymax_crust_mantle;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// vp &amp; vs</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6640e89ba1dbf1f52a8476299245e61c">d_rho_vp_crust_mantle</a>, rho_vp_crust_mantle, size);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a364225eb71cc5d1f3e07b0e612866a5b">d_rho_vs_crust_mantle</a>, rho_vs_crust_mantle, size);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="comment">// ijk index arrays</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a751b93454f8a335682b009089ba1c42f">d_nkmin_xi_crust_mantle</a>, nkmin_xi_crust_mantle, 2 * (*NSPEC2DMAX_XMIN_XMAX_CM));</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7359e7b881886f9640274e0b830a0313">d_nkmin_eta_crust_mantle</a>, nkmin_eta_crust_mantle, 2 * (*NSPEC2DMAX_YMIN_YMAX_CM));</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a93844111b6b5c5ce0646344ff0bd1b86">d_njmin_crust_mantle</a>, njmin_crust_mantle, 2 * (*NSPEC2DMAX_XMIN_XMAX_CM));</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a55fbd1bbfa6cf28a2acc529596a91c1a">d_njmax_crust_mantle</a>, njmax_crust_mantle, 2 * (*NSPEC2DMAX_XMIN_XMAX_CM));</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7a01ec98899aec24bbab047328fe0e23">d_nimin_crust_mantle</a>, nimin_crust_mantle, 2 * (*NSPEC2DMAX_YMIN_YMAX_CM));</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1ee87f3481e27c06e7a355aeed24cc46">d_nimax_crust_mantle</a>, nimax_crust_mantle, 2 * (*NSPEC2DMAX_YMIN_YMAX_CM));</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="comment">// xmin</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff06dab5e4c140b9181104caf915cd09">nspec2D_xmin_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8a68cf9e50c65403318966bc32f0feac">d_ibelm_xmin_crust_mantle</a>, ibelm_xmin_crust_mantle, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff06dab5e4c140b9181104caf915cd09">nspec2D_xmin_crust_mantle</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1278dcc0aec8bc5e2400005e16505e06">d_normal_xmin_crust_mantle</a>, normal_xmin_crust_mantle, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff06dab5e4c140b9181104caf915cd09">nspec2D_xmin_crust_mantle</a>);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9787325a6dc6f90b28e6d5b0c047c2ba">d_jacobian2D_xmin_crust_mantle</a>, jacobian2D_xmin_crust_mantle, NGLL2 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff06dab5e4c140b9181104caf915cd09">nspec2D_xmin_crust_mantle</a>);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0bb8ee2d74ebaeb68e0d54005e48c310">d_absorb_xmin_crust_mantle</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * NGLL2 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff06dab5e4c140b9181104caf915cd09">nspec2D_xmin_crust_mantle</a>);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  }</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">// xmax</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab16d7257d92a7cb9b29d1b461843db63">nspec2D_xmax_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ade386b82a626cf9fc0ef3a4a0559d04f">d_ibelm_xmax_crust_mantle</a>, ibelm_xmax_crust_mantle, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab16d7257d92a7cb9b29d1b461843db63">nspec2D_xmax_crust_mantle</a>);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad010d00c166f1bdef85447a5e3cae3b2">d_normal_xmax_crust_mantle</a>, normal_xmax_crust_mantle, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab16d7257d92a7cb9b29d1b461843db63">nspec2D_xmax_crust_mantle</a>);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae5ce7e58987a20afe4bf0d93ced01e45">d_jacobian2D_xmax_crust_mantle</a>, jacobian2D_xmax_crust_mantle, NGLL2 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab16d7257d92a7cb9b29d1b461843db63">nspec2D_xmax_crust_mantle</a>);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a101156fa97590c52662408617fa79e7e">d_absorb_xmax_crust_mantle</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * NGLL2 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab16d7257d92a7cb9b29d1b461843db63">nspec2D_xmax_crust_mantle</a>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">// ymin</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf09f07450524877347548fdb88ffd22">nspec2D_ymin_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a94497e687bfcaf659677bea2b41705">d_ibelm_ymin_crust_mantle</a>, ibelm_ymin_crust_mantle, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf09f07450524877347548fdb88ffd22">nspec2D_ymin_crust_mantle</a>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a78592cd625fc9f65e28d686c259c111c">d_normal_ymin_crust_mantle</a>, normal_ymin_crust_mantle, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf09f07450524877347548fdb88ffd22">nspec2D_ymin_crust_mantle</a>);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa07d13732521f9b75c5786b65ea865f8">d_jacobian2D_ymin_crust_mantle</a>, jacobian2D_ymin_crust_mantle, NGLL2 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf09f07450524877347548fdb88ffd22">nspec2D_ymin_crust_mantle</a>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abb029b9b141eef7ab53da75594ca92be">d_absorb_ymin_crust_mantle</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * NGLL2 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf09f07450524877347548fdb88ffd22">nspec2D_ymin_crust_mantle</a>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="comment">// ymax</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f641dd67cff778bce7ff8403bf06fa">nspec2D_ymax_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a76c841709f62363d5d46318df9c3c9f4">d_ibelm_ymax_crust_mantle</a>,</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                       ibelm_ymax_crust_mantle, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f641dd67cff778bce7ff8403bf06fa">nspec2D_ymax_crust_mantle</a>);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8db3ee3a1cabd76554dd7118ad057109">d_normal_ymax_crust_mantle</a>, normal_ymax_crust_mantle, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f641dd67cff778bce7ff8403bf06fa">nspec2D_ymax_crust_mantle</a>);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a46339796930aae060164e700f0a9c99f">d_jacobian2D_ymax_crust_mantle</a>, jacobian2D_ymax_crust_mantle, NGLL2 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f641dd67cff778bce7ff8403bf06fa">nspec2D_ymax_crust_mantle</a>);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a93d94d0c3537c00eafd8c556e846ac24">d_absorb_ymax_crust_mantle</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * NGLL2 * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f641dd67cff778bce7ff8403bf06fa">nspec2D_ymax_crust_mantle</a>);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">// outer_core</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4eb515980cb5002e5d54a3d220e85c13">nspec2D_xmin_outer_core</a> = *nspec2D_xmin_outer_core;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a228cd6822e22e73e757666ae371a57">nspec2D_xmax_outer_core</a> = *nspec2D_xmax_outer_core;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae87462e60db1da0aa2e3a3d27bca626d">nspec2D_ymin_outer_core</a> = *nspec2D_ymin_outer_core;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a042606a2b56dcc00d30e9d9c26a80d12">nspec2D_ymax_outer_core</a> = *nspec2D_ymax_outer_core;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a13e89a7396d89ba209d7f83a2a168280">nspec2D_zmin_outer_core</a> = *nspec2D_zmin_outer_core;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="comment">// vp</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a454a8bfca214d6368fe31beb162a1ee2">d_vp_outer_core</a>, <a class="code" href="../../d8/d0a/namespacespecfem__par__outercore.html#ad1e88500ba5ca47f77908018f53d4a3b">vp_outer_core</a>, size);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">// ijk index arrays</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9f652523eeebae4f18f68dd4430f5c44">d_nkmin_xi_outer_core</a>, nkmin_xi_outer_core, 2 * (*NSPEC2DMAX_XMIN_XMAX_OC));</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5dba209d935c8742faeec8a2b42faaf3">d_nkmin_eta_outer_core</a>, nkmin_eta_outer_core, 2 * (*NSPEC2DMAX_YMIN_YMAX_OC));</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a64fc6e4b22b5167f9fa6588079497890">d_njmin_outer_core</a>, njmin_outer_core, 2 * (*NSPEC2DMAX_XMIN_XMAX_OC));</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afaf83dadc024b96704da0755c2bcb256">d_njmax_outer_core</a>, njmax_outer_core, 2 * (*NSPEC2DMAX_XMIN_XMAX_OC));</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a43d05db64c2b77160fbbe332477ddf29">d_nimin_outer_core</a>, nimin_outer_core, 2 * (*NSPEC2DMAX_YMIN_YMAX_OC));</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a78eeb1e93b7dbb4a4b3d5592f4f9934e">d_nimax_outer_core</a>, nimax_outer_core, 2 * (*NSPEC2DMAX_YMIN_YMAX_OC));</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="comment">// xmin</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4eb515980cb5002e5d54a3d220e85c13">nspec2D_xmin_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaeb71d1a82c9f5660f89cae589ff14b1">d_ibelm_xmin_outer_core</a>, ibelm_xmin_outer_core, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4eb515980cb5002e5d54a3d220e85c13">nspec2D_xmin_outer_core</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac0018c1471e2634f619072f26905de88">d_jacobian2D_xmin_outer_core</a>, jacobian2D_xmin_outer_core, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4eb515980cb5002e5d54a3d220e85c13">nspec2D_xmin_outer_core</a>);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5e09abf122afc522d084179bfbc57028">d_absorb_xmin_outer_core</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4eb515980cb5002e5d54a3d220e85c13">nspec2D_xmin_outer_core</a>);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <span class="comment">// xmax</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a228cd6822e22e73e757666ae371a57">nspec2D_xmax_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9c76d9e7af55d02d8e07e1b57c28fd98">d_ibelm_xmax_outer_core</a>, ibelm_xmax_outer_core, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a228cd6822e22e73e757666ae371a57">nspec2D_xmax_outer_core</a>);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3bd686edbeffc96caebd86f8e5d7acd8">d_jacobian2D_xmax_outer_core</a>, jacobian2D_xmax_outer_core, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a228cd6822e22e73e757666ae371a57">nspec2D_xmax_outer_core</a>);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac2da2b9c51ef05597ebf07887beb0514">d_absorb_xmax_outer_core</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a228cd6822e22e73e757666ae371a57">nspec2D_xmax_outer_core</a>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// ymin</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae87462e60db1da0aa2e3a3d27bca626d">nspec2D_ymin_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a34d36dff216801f1b524d9382642a2a3">d_ibelm_ymin_outer_core</a>, ibelm_ymin_outer_core, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae87462e60db1da0aa2e3a3d27bca626d">nspec2D_ymin_outer_core</a>);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2d16ee43a986b610ad75b655d75c12c9">d_jacobian2D_ymin_outer_core</a>, jacobian2D_ymin_outer_core, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae87462e60db1da0aa2e3a3d27bca626d">nspec2D_ymin_outer_core</a>);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aef7bc36faad3d73528e43865d9df83ac">d_absorb_ymin_outer_core</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae87462e60db1da0aa2e3a3d27bca626d">nspec2D_ymin_outer_core</a>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">// ymax</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a042606a2b56dcc00d30e9d9c26a80d12">nspec2D_ymax_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afb9ec80ae0c39aceb79e4c252bac0a8f">d_ibelm_ymax_outer_core</a>, ibelm_ymax_outer_core, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a042606a2b56dcc00d30e9d9c26a80d12">nspec2D_ymax_outer_core</a>);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5bd19e66662956b156f674320c3dcb77">d_jacobian2D_ymax_outer_core</a>, jacobian2D_ymax_outer_core, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a042606a2b56dcc00d30e9d9c26a80d12">nspec2D_ymax_outer_core</a>);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a97742ee0dcb0ffe0897b51372e4a8c04">d_absorb_ymax_outer_core</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a042606a2b56dcc00d30e9d9c26a80d12">nspec2D_ymax_outer_core</a>);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">// zmin</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a13e89a7396d89ba209d7f83a2a168280">nspec2D_zmin_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">// note: ibelm_bottom_outer_core and jacobian2D_bottom_outer_core will be allocated</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="comment">//          when preparing the outer core</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">// boundary buffer</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a642a63f522d93d71785abff97b045023">d_absorb_zmin_outer_core</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a13e89a7396d89ba209d7f83a2a168280">nspec2D_zmin_outer_core</a>);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_fields_absorb_device&quot;</span>);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;}</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">// MPI interfaces</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l00953"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a578f7dfa3714e53fc24b6587430f4c6e">  953</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_mpi_buffers_device,</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;               PREPARE_MPI_BUFFERS_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../d7/d1e/namespacempi__crust__mantle__par.html#a835b5c9f5ff86d72cc5d102a8ccb7d01">num_interfaces_crust_mantle</a>,</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../d7/d1e/namespacempi__crust__mantle__par.html#a2f42325088db3abf72e4a5b9190d04c8">max_nibool_interfaces_cm</a>,</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../d7/d1e/namespacempi__crust__mantle__par.html#a6f62a44c0d47abbee113f4f7dab56c38">nibool_interfaces_crust_mantle</a>,</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../d7/d1e/namespacempi__crust__mantle__par.html#af6edb949252c31a07d21875d1a9ebf7f">ibool_interfaces_crust_mantle</a>,</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../db/d27/namespacempi__inner__core__par.html#a64178a6cf4a5da9a236dbfd2cffae477">num_interfaces_inner_core</a>,</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../db/d27/namespacempi__inner__core__par.html#ac6d02e431e8cba8b8645f2729056ae06">max_nibool_interfaces_ic</a>,</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../db/d27/namespacempi__inner__core__par.html#ae82026a7e84ab1723d3cf6d720f4f63c">nibool_interfaces_inner_core</a>,</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../db/d27/namespacempi__inner__core__par.html#a3a4315d67a61198745325f0a0360d428">ibool_interfaces_inner_core</a>,</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../d0/d26/namespacempi__outer__core__par.html#af220e6bd457430198bc9c2d0f5a1c69a">num_interfaces_outer_core</a>,</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../d0/d26/namespacempi__outer__core__par.html#aeee98a9cb86339598d5c4ec85231b35d">max_nibool_interfaces_oc</a>,</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../d0/d26/namespacempi__outer__core__par.html#a69bafaeaf350ca16b12ebfdc9e261fae">nibool_interfaces_outer_core</a>,</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                            <span class="keywordtype">int</span> *<a class="code" href="../../d0/d26/namespacempi__outer__core__par.html#a3110b1d946d62cf123b6c1274b979fb5">ibool_interfaces_outer_core</a>) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_mpi_buffers_device&quot;</span>);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keywordtype">int</span> size_mpi_buffer;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="comment">// prepares interprocess-edge exchange information</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">// crust/mantle mesh</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">num_interfaces_crust_mantle</a> = *<a class="code" href="../../d7/d1e/namespacempi__crust__mantle__par.html#a835b5c9f5ff86d72cc5d102a8ccb7d01">num_interfaces_crust_mantle</a>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aacc2e11571b37a3cc4ad76f7a29c29ed">max_nibool_interfaces_cm</a> = *<a class="code" href="../../d7/d1e/namespacempi__crust__mantle__par.html#a2f42325088db3abf72e4a5b9190d04c8">max_nibool_interfaces_cm</a>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">num_interfaces_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">// number of ibool entries array</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa11f7cabea501f93ee8eae9c62805167">d_nibool_interfaces_crust_mantle</a>, nibool_interfaces_crust_mantle,</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">num_interfaces_crust_mantle</a>);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="comment">// ibool entries (iglob indices) values on interface</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#adef8666c17727c1bd8efb0b9000607bf">d_ibool_interfaces_crust_mantle</a>, ibool_interfaces_crust_mantle,</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                                mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">num_interfaces_crust_mantle</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aacc2e11571b37a3cc4ad76f7a29c29ed">max_nibool_interfaces_cm</a>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    size_mpi_buffer = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aacc2e11571b37a3cc4ad76f7a29c29ed">max_nibool_interfaces_cm</a>)*(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">num_interfaces_crust_mantle</a>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">// allocates MPI buffer for exchange with CPU</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af4a7778304768cb9168190b378c5e585">d_send_accel_buffer_crust_mantle</a>, size_mpi_buffer);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8b7866dfc5c6fff2554ec6889b088abc">d_b_send_accel_buffer_crust_mantle</a>, size_mpi_buffer);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="comment">// asynchronous MPI buffer</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(send_accel_buffer_cm, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(recv_accel_buffer_cm, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(b_send_accel_buffer_cm, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(b_recv_accel_buffer_cm, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="comment">// note: Allocate pinned MPI buffers.</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="comment">//       MPI buffers use pinned memory allocated by cudaMallocHost, which</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="comment">//       enables the use of asynchronous memory copies from host &lt;-&gt; device</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <span class="comment">// send buffer</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad00c7054f9b86752da332b155d9fb6ac">h_send_accel_buffer_cm</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="comment">// receive buffer</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaf6b896c78677f5253c0422dd76331b4">h_recv_accel_buffer_cm</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa485a6b10d9716d20c4b06dc8ea8c5e5">h_b_send_accel_buffer_cm</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae1c979458a0c87759b6a6bb03498b5c7">h_b_recv_accel_buffer_cm</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="comment">// inner core mesh</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">num_interfaces_inner_core</a> = *<a class="code" href="../../db/d27/namespacempi__inner__core__par.html#a64178a6cf4a5da9a236dbfd2cffae477">num_interfaces_inner_core</a>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc3e00e15727c169e05c2f5f6b8fe1d">max_nibool_interfaces_ic</a> = *<a class="code" href="../../db/d27/namespacempi__inner__core__par.html#ac6d02e431e8cba8b8645f2729056ae06">max_nibool_interfaces_ic</a>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">num_interfaces_inner_core</a> &gt; 0) {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">// number of ibool entries array</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4ab78b34ac901bf210a4646093964370">d_nibool_interfaces_inner_core</a>, nibool_interfaces_inner_core,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">num_interfaces_inner_core</a>);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">// ibool entries (iglob indices) values on interface</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6b64a3db433854de8e65c25c4d00b392">d_ibool_interfaces_inner_core</a>, ibool_interfaces_inner_core,</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">num_interfaces_inner_core</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc3e00e15727c169e05c2f5f6b8fe1d">max_nibool_interfaces_ic</a>);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    size_mpi_buffer = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc3e00e15727c169e05c2f5f6b8fe1d">max_nibool_interfaces_ic</a>) * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">num_interfaces_inner_core</a>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae895eecdf95d57c65b681ca43e7232d1">d_send_accel_buffer_inner_core</a>, size_mpi_buffer);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5e1239a68ee582004c95479540a03f20">d_b_send_accel_buffer_inner_core</a>, size_mpi_buffer);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="comment">// asynchronous MPI buffer</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(send_accel_buffer_ic, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(recv_accel_buffer_ic, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(b_send_accel_buffer_ic, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(b_recv_accel_buffer_ic, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="comment">// note: Allocate pinned MPI buffers.</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="comment">//       MPI buffers use pinned memory allocated by cudaMallocHost, which</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="comment">//       enables the use of asynchronous memory copies from host &lt;-&gt; device</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="comment">// send buffer</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa7eb120024ba76ddc38bf0321aa8a35c">h_send_accel_buffer_ic</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="comment">// receive buffer</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3775d6785cfdf260464cd71d9d844146">h_recv_accel_buffer_ic</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="comment">// adjoint</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a94dae0867df03ced9873de73db6fd428">h_b_send_accel_buffer_ic</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a85540618f50dca95bdbd7eda1eb80916">h_b_recv_accel_buffer_ic</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  }</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="comment">// outer core mesh</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="comment">// note: uses only scalar wavefield arrays</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">num_interfaces_outer_core</a> = *<a class="code" href="../../d0/d26/namespacempi__outer__core__par.html#af220e6bd457430198bc9c2d0f5a1c69a">num_interfaces_outer_core</a>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a70d463d267f0659d26038d69012b2088">max_nibool_interfaces_oc</a> = *<a class="code" href="../../d0/d26/namespacempi__outer__core__par.html#aeee98a9cb86339598d5c4ec85231b35d">max_nibool_interfaces_oc</a>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">num_interfaces_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">// number of ibool entries array</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a756f40e55ceb0e610fd064a71c3e28f0">d_nibool_interfaces_outer_core</a>, nibool_interfaces_outer_core,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">num_interfaces_outer_core</a>);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">// ibool entries (iglob indices) values on interface</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6cebb837bf8ae85a273033ef39054232">d_ibool_interfaces_outer_core</a>, <a class="code" href="../../d0/d26/namespacempi__outer__core__par.html#a3110b1d946d62cf123b6c1274b979fb5">ibool_interfaces_outer_core</a>,</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">num_interfaces_outer_core</a>) * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a70d463d267f0659d26038d69012b2088">max_nibool_interfaces_oc</a>));</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    size_mpi_buffer = (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a70d463d267f0659d26038d69012b2088">max_nibool_interfaces_oc</a>)*(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">num_interfaces_outer_core</a>);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">// allocates MPI buffer for exchange with CPU</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae29f844d277df67bab0930a4f9a2f578">d_send_accel_buffer_outer_core</a>, size_mpi_buffer);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a008e31fd1f2a027c441a62cb2e81be31">d_b_send_accel_buffer_outer_core</a>, size_mpi_buffer);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">// asynchronous MPI buffer</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(send_accel_buffer_oc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(recv_accel_buffer_oc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(b_send_accel_buffer_oc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a>(b_recv_accel_buffer_oc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)* size_mpi_buffer);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="comment">// note: Allocate pinned MPI buffers.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="comment">//       MPI buffers use pinned memory allocated by cudaMallocHost, which</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="comment">//       enables the use of asynchronous memory copies from host &lt;-&gt; device</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="comment">// send buffer</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a38ef87e9553ec5ed4f613fcc7d5c7cb0">h_send_accel_buffer_oc</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="comment">// receive buffer</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1e280d7cac724ded01c9fde7e8d0fb9">h_recv_accel_buffer_oc</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;          <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afb692dc5c8ba388d6179d622daddae8e">h_b_send_accel_buffer_oc</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMallocHost((<span class="keywordtype">void</span>**)&amp;(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a17819433e875d9b944d91830e9184942">h_b_recv_accel_buffer_oc</a>),<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_mpi_buffer ),8004);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_mpi_buffers_device&quot;</span>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;}</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">// for NOISE simulations</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l01138"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a723865f205275607a4a817e2e279b0ed"> 1138</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_fields_noise_device,</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;               PREPARE_FIELDS_NOISE_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                             <span class="keywordtype">int</span> *NSPEC_TOP,</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                             <span class="keywordtype">int</span> *NSTEP,</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                             <span class="keywordtype">int</span> *h_ibelm_top_crust_mantle,</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../df/daf/namespacespecfem__par__noise.html#a5b324276000b714a30bddeb554b8004b">noise_sourcearray</a>,</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../df/daf/namespacespecfem__par__noise.html#abd19d594c0e065ae5dd7e70d052ef373">normal_x_noise</a>,</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../df/daf/namespacespecfem__par__noise.html#a81207487b39c311777e83cfb7175bfa3">normal_y_noise</a>,</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../df/daf/namespacespecfem__par__noise.html#a0a77ca58e5baa64407977f26a2c6b3d6">normal_z_noise</a>,</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../df/daf/namespacespecfem__par__noise.html#ad3d307ee10a95627fdf10e1ad22eeaaf">mask_noise</a>,</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *jacobian2D_top_crust_mantle) {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_fields_noise_device&quot;</span>);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="comment">// free surface</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af0c9213bf0c4b841746b5a76c549ba66">nspec2D_top_crust_mantle</a> = *NSPEC_TOP;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af0c9213bf0c4b841746b5a76c549ba66">nspec2D_top_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">// note: d_ibelm_top_crust_mantle will only be needed for noise computations</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abd7c1e2df1ee271fc1a47a836bd793b2">d_ibelm_top_crust_mantle</a>, h_ibelm_top_crust_mantle, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af0c9213bf0c4b841746b5a76c549ba66">nspec2D_top_crust_mantle</a>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// alloc storage for the surface buffer to be copied</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1989f8adfab2b3e7b8e580b94898edb6">d_noise_surface_movie</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af0c9213bf0c4b841746b5a76c549ba66">nspec2D_top_crust_mantle</a>);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">// for global mesh: each crust/mantle slice should have at top a free surface</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;prepare_fields_noise_device NSPEC_TOP not properly initialized&quot;</span>);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">// prepares noise source array</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">noise_tomography</a> == 1) {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1793ff103290e8c06c17d4ccc24c924a">d_noise_sourcearray</a>, noise_sourcearray, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (*NSTEP));</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="comment">// prepares noise directions</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">noise_tomography</a> &gt; 1) {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordtype">int</span> nface_size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af0c9213bf0c4b841746b5a76c549ba66">nspec2D_top_crust_mantle</a>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// allocates memory on GPU</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4fcc1869ac2e6f07350f13edc4914e8d">d_normal_x_noise</a>, normal_x_noise, nface_size);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab7ee7f4d8000df05047d76d8324e8ede">d_normal_y_noise</a>, normal_y_noise, nface_size);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac8e0ee203263170c071b14a1a2b90f68">d_normal_z_noise</a>, normal_z_noise, nface_size);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3363d4581b5b00f8f94798a2b48d690">d_mask_noise</a>, mask_noise, nface_size);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa2d937997815bc4f6bf6d5e78d367933">d_jacobian2D_top_crust_mantle</a>, jacobian2D_top_crust_mantle, nface_size);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="comment">// prepares noise strength kernel</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">noise_tomography</a> == 3) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae519e498ca8126979e0db0cd12401f8d">d_Sigma_kl</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// initializes kernel values to zero</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae519e498ca8126979e0db0cd12401f8d">d_Sigma_kl</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>, 0);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_fields_noise_device&quot;</span>);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;}</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">// OCEANS</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l01203"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a45ef6c92792fb2392a7f34175feab1d0"> 1203</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_oceans_device,</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;               PREPARE_OCEANS_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                       <span class="keywordtype">int</span> *<a class="code" href="../../db/da6/namespacespecfem__par.html#a5ffd52e5f97dac39af9929875097ffa8">npoin_oceans</a>,</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                       <span class="keywordtype">int</span> *h_iglob_ocean_load,</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rmass_ocean_load_selected,</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_normal_ocean_load) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_oceans_device&quot;</span>);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="comment">// arrays with global points on ocean surface</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8b7290c20ec523f02714afef5d2ae9b">npoin_oceans</a> = *<a class="code" href="../../db/da6/namespacespecfem__par.html#a5ffd52e5f97dac39af9929875097ffa8">npoin_oceans</a>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="comment">// checks for global partitions, each slice must have a top surface with points on i</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8b7290c20ec523f02714afef5d2ae9b">npoin_oceans</a> == 0) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;prepare_oceans_device has zero npoin_oceans&quot;</span>);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="comment">// global point indices</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad24a72ca9672db527b9c1a700ce8f756">d_ibool_ocean_load</a>, h_iglob_ocean_load, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8b7290c20ec523f02714afef5d2ae9b">npoin_oceans</a>);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="comment">// mass matrix</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad8a9491459c9cc04902ffd755f3bd66f">d_rmass_ocean_load</a>, h_rmass_ocean_load_selected, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8b7290c20ec523f02714afef5d2ae9b">npoin_oceans</a>);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="comment">// normals</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac8d8c983bcbf5cf8bc73800e91a9a584">d_normal_ocean_load</a>, h_normal_ocean_load, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8b7290c20ec523f02714afef5d2ae9b">npoin_oceans</a>);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_oceans_device&quot;</span>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;}</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">// LDDRK</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l01239"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a952a1bbfa8dcee9281d89c06516b8229"> 1239</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_lddrk_device,</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;               PREPARE_LDDRK_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="comment">// prepares LDDRK time scheme arrays on GPU</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_lddrk_device&quot;</span>);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">// sets flag</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a15ae83652e680fc48864f8f787eb3960">use_lddrk</a> = 1;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a> (<span class="stringliteral">&quot;prepare_lddrk_device not implemented yet&quot;</span>);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_lddrk_device&quot;</span>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;}</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">// Earth regions</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">// CRUST / MANTLE</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l01262"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a09a2b3394025a46c877a7d022788ed1c"> 1262</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_crust_mantle_device,</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;               PREPARE_CRUST_MANTLE_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xix, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xiy, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xiz,</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etax, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etay, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etaz,</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammax, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammay, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammaz,</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rho,</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_kappav, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_muv,</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_kappah, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_muh,</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_eta_aniso,</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rmassx, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rmassy, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rmassz,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_b_rmassx, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_b_rmassy,</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                             <span class="keywordtype">int</span> *h_ibool,</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rstore,</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                             <span class="keywordtype">int</span> *h_ispec_is_tiso,</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a148311ac010a9fc86c1038a35248cd22">c11store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#ab089796730cb5c065e83f3187091238f">c12store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a41597654ab442f9228f6f2226a8d8998">c13store</a>,</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a7dc43de575127bf996b15885aae7d364">c14store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a3702d9a47545037d7870b2568eac2917">c15store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a732bb327ddd85780293be67b67600cd6">c16store</a>,</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a38961824aaad27e3fa5ce407c223a2c2">c22store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#af74f67b2509b6daa198d1336f240bc1f">c23store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a05201d163c28cb39c5ce9a1fd294cc5f">c24store</a>,</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a213d1b13a2775feb345ecc1b9ad4befd">c25store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#afaf57f320aa9029ba1a64c51c8f98ad8">c26store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#aaee302f1e5ea618bf1c8c8c2cdd220bc">c33store</a>,</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a81a3273ffe5171f96bab3735bacdec46">c34store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a4b4462798cc3fff4ebf03c2791c8f826">c35store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a87e554c490527e842f17eefb2b349568">c36store</a>,</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a65faffef391fb2a2b3a60fd0bee3b517">c44store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a1e2fd791527963786436e3b3c1fa473f">c45store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a6461e21c463af6a48e63e38db555b33a">c46store</a>,</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                             <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a174b6e236a112b882eb1acc841f72c35">c55store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#abb14b77aa330fd5260ab816f856447e4">c56store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a560d12fcced6f3cbcae57d34335ed804">c66store</a>,</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                             <span class="keywordtype">int</span> *num_phase_ispec,</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                                             <span class="keywordtype">int</span> *phase_ispec_inner,</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                                             <span class="keywordtype">int</span> *nspec_outer,</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                             <span class="keywordtype">int</span> *nspec_inner,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                             <span class="keywordtype">int</span> *NSPEC2D_BOTTOM_CM,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                             <span class="keywordtype">int</span> *h_ibelm_bottom_crust_mantle,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                             <span class="keywordtype">int</span> *NCHUNKS_VAL,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                             <span class="keywordtype">int</span> *num_colors_outer,</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                             <span class="keywordtype">int</span> *num_colors_inner,</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                                             <span class="keywordtype">int</span> *num_elem_colors) {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_crust_mantle_device&quot;</span>);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">/*Assuming NGLLX=5. Padded is then 128 (5^3+3) */</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordtype">int</span> size_padded = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordtype">int</span> size_glob = mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a666ace38b302f6cf2b04f50d89cc4c13">NGLOB_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="comment">// mesh</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_crust_mantle gll mesh&quot;</span>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3474881fb737a088d5d39aa99c60a07e">d_xix_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a58052ea6faf38efdd2e3f6c0fb12e0ca">d_xiy_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f9f5b9ce5f0c21fb1e66eea91b6ceb">d_xiz_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afb5c630a75fed79535e9b6bc03673f5a">d_etax_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5b4a2d8806c451c2d7260656c7fa4574">d_etay_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a88fae143685e4b2cd65b8f027502218b">d_etaz_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ada96fe6d42f013cee8eff3d6d5396483">d_gammax_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a348dc7b1fa2dfa1d9b3a781738820139">d_gammay_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8e81d6461b1b04617deeb952132db38">d_gammaz_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="comment">// transfer constant element data with padding</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>; i++) {</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3474881fb737a088d5d39aa99c60a07e">d_xix_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                                     <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xix[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a58052ea6faf38efdd2e3f6c0fb12e0ca">d_xiy_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                                     NGLL3 * sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xiy[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f9f5b9ce5f0c21fb1e66eea91b6ceb">d_xiz_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xiz[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afb5c630a75fed79535e9b6bc03673f5a">d_etax_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etax[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5b4a2d8806c451c2d7260656c7fa4574">d_etay_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etay[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a88fae143685e4b2cd65b8f027502218b">d_etaz_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etaz[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ada96fe6d42f013cee8eff3d6d5396483">d_gammax_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_gammax[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a348dc7b1fa2dfa1d9b3a781738820139">d_gammay_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_gammay[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8e81d6461b1b04617deeb952132db38">d_gammaz_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),&amp;h_gammaz[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3474881fb737a088d5d39aa99c60a07e">d_xix_crust_mantle</a>.cuda+i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>, &amp;h_xix[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1501);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a58052ea6faf38efdd2e3f6c0fb12e0ca">d_xiy_crust_mantle</a>.cuda+i*NGLL3_PADDED, &amp;h_xiy[i*NGLL3],</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1502);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f9f5b9ce5f0c21fb1e66eea91b6ceb">d_xiz_crust_mantle</a>.cuda+i*NGLL3_PADDED, &amp;h_xiz[i*NGLL3],</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1503);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afb5c630a75fed79535e9b6bc03673f5a">d_etax_crust_mantle</a>.cuda+i*NGLL3_PADDED, &amp;h_etax[i*NGLL3],</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1504);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5b4a2d8806c451c2d7260656c7fa4574">d_etay_crust_mantle</a>.cuda+i*NGLL3_PADDED, &amp;h_etay[i*NGLL3],</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1505);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a88fae143685e4b2cd65b8f027502218b">d_etaz_crust_mantle</a>.cuda+i*NGLL3_PADDED, &amp;h_etaz[i*NGLL3],</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1506);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ada96fe6d42f013cee8eff3d6d5396483">d_gammax_crust_mantle</a>.cuda+i*NGLL3_PADDED, &amp;h_gammax[i*NGLL3],</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1507);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a348dc7b1fa2dfa1d9b3a781738820139">d_gammay_crust_mantle</a>.cuda+i*NGLL3_PADDED, &amp;h_gammay[i*NGLL3],</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1508);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8e81d6461b1b04617deeb952132db38">d_gammaz_crust_mantle</a>.cuda+i*NGLL3_PADDED, &amp;h_gammaz[i*NGLL3],</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1509);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="comment">// global indexing</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_crust_mantle global indexing&quot;</span>);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac0b9eb9864c39537e161c860a8a550f5">d_ibool_crust_mantle</a>, h_ibool, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <span class="comment">// Earth model arrays</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_crust_mantle model arrays&quot;</span>);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0d6ef87cdf2480b2e8280f635144ae5a">anisotropic_3D_mantle</a>) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">// no anisotropy</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="comment">// only needed if not anisotropic 3D mantle</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">// transverse isotropic elements</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="comment">// transverse isotropy flag</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a949afc03c8658efa0641aa0988db12dc">d_ispec_is_tiso_crust_mantle</a>, h_ispec_is_tiso, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">// kappavstore, kappahstore</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2ae8526e691dad242929cab1f68bcff1">d_kappavstore_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a25eb457a2fed340a148c1d4de5921b66">d_kappahstore_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">// muvstore, muhstore</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4120bec6f89dcb81eab72ab60c811503">d_muvstore_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a82e47572f87c54e13ee5a26fb6b132d4">d_muhstore_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="comment">// eta_anisostore</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff0049608e4e282dd08f9172e699cb50">d_eta_anisostore_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">// transfer with padding</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>; i++) {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2ae8526e691dad242929cab1f68bcff1">d_kappavstore_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_kappav[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a25eb457a2fed340a148c1d4de5921b66">d_kappahstore_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_kappah[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4120bec6f89dcb81eab72ab60c811503">d_muvstore_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_muv[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a82e47572f87c54e13ee5a26fb6b132d4">d_muhstore_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_muh[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff0049608e4e282dd08f9172e699cb50">d_eta_anisostore_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_eta_aniso[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2ae8526e691dad242929cab1f68bcff1">d_kappavstore_crust_mantle</a>.cuda+i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>,&amp;h_kappav[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1510);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a25eb457a2fed340a148c1d4de5921b66">d_kappahstore_crust_mantle</a>.cuda+i*NGLL3_PADDED,&amp;h_kappah[i*NGLL3],</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1511);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4120bec6f89dcb81eab72ab60c811503">d_muvstore_crust_mantle</a>.cuda+i*NGLL3_PADDED,  &amp;h_muv[i*NGLL3],</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1512);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a82e47572f87c54e13ee5a26fb6b132d4">d_muhstore_crust_mantle</a>.cuda+i*NGLL3_PADDED,&amp;h_muh[i*NGLL3],</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1513);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff0049608e4e282dd08f9172e699cb50">d_eta_anisostore_crust_mantle</a>.cuda+i*NGLL3_PADDED,&amp;h_eta_aniso[i*NGLL3],</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1514);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// anisotropic 3D mantle</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="comment">// allocates memory on GPU</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0a1c274cac4d0b253381447289f2a8e1">d_c11store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a162ebdf4b0261023b78e4bf120048aeb">d_c12store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6c0733577673683cf5ed080ff9a05a20">d_c13store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a316eb289b6d1d7962df6a3256db36906">d_c14store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a04812b8c4b78841c86582c6a4c6aa6d4">d_c15store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a599961adcac4337921307c5dce650a1e">d_c16store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5ba24b0195bf41f64a15194ad603f132">d_c22store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a8021ab98bb29218f3a1de0a3e33d76">d_c23store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a75fe641c1a0fa474f4517a00545c7652">d_c24store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aca1f642fe526cfd357cc5240f68e0863">d_c25store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed16cea62e3086eb499aaedb26ad7dfc">d_c26store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a92e906caafa02d3b219ea330f9466031">d_c33store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2e6fb83ecd9001f5d664ec0839f57972">d_c34store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0862a18cddae6423e721dacab974e93e">d_c35store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9d76cbf3c6992debc5b0e70890fb2f49">d_c36store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7c4e8b67ff8de9093172a2a3e45e7939">d_c44store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0b282d32b6d427c499cf614c4701390c">d_c45store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a32d4d6fdda9286ae349655e14183f22c">d_c46store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0a443e256fbf33b2286fda44d44b407a">d_c55store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ace6dc60fb69bc859412f317d881bf4b6">d_c56store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a859a2daf33c0b38f58a4523d6c271ba5">d_c66store_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">// transfer constant element data with padding</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>; i++) {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0a1c274cac4d0b253381447289f2a8e1">d_c11store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),&amp;c11store[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a162ebdf4b0261023b78e4bf120048aeb">d_c12store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c12store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6c0733577673683cf5ed080ff9a05a20">d_c13store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c13store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a316eb289b6d1d7962df6a3256db36906">d_c14store_crust_mantle</a>.ocl, CL_FALSE,  offset,</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c14store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a04812b8c4b78841c86582c6a4c6aa6d4">d_c15store_crust_mantle</a>.ocl, CL_FALSE,  offset,</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c15store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a599961adcac4337921307c5dce650a1e">d_c16store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c16store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5ba24b0195bf41f64a15194ad603f132">d_c22store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c22store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a8021ab98bb29218f3a1de0a3e33d76">d_c23store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c23store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a75fe641c1a0fa474f4517a00545c7652">d_c24store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c24store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aca1f642fe526cfd357cc5240f68e0863">d_c25store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c25store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed16cea62e3086eb499aaedb26ad7dfc">d_c26store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c26store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a92e906caafa02d3b219ea330f9466031">d_c33store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c33store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2e6fb83ecd9001f5d664ec0839f57972">d_c34store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c34store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0862a18cddae6423e721dacab974e93e">d_c35store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c35store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9d76cbf3c6992debc5b0e70890fb2f49">d_c36store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c36store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7c4e8b67ff8de9093172a2a3e45e7939">d_c44store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c44store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0b282d32b6d427c499cf614c4701390c">d_c45store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c45store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a32d4d6fdda9286ae349655e14183f22c">d_c46store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c46store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0a443e256fbf33b2286fda44d44b407a">d_c55store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c55store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ace6dc60fb69bc859412f317d881bf4b6">d_c56store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c56store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a859a2daf33c0b38f58a4523d6c271ba5">d_c66store_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c66store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0a1c274cac4d0b253381447289f2a8e1">d_c11store_crust_mantle</a>.cuda + i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>, &amp;c11store[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4800);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a162ebdf4b0261023b78e4bf120048aeb">d_c12store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c12store[i*NGLL3],</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4801);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6c0733577673683cf5ed080ff9a05a20">d_c13store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c13store[i*NGLL3],</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4802);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a316eb289b6d1d7962df6a3256db36906">d_c14store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c14store[i*NGLL3],</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4803);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a04812b8c4b78841c86582c6a4c6aa6d4">d_c15store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c15store[i*NGLL3],</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4804);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a599961adcac4337921307c5dce650a1e">d_c16store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c16store[i*NGLL3],</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4805);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5ba24b0195bf41f64a15194ad603f132">d_c22store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c22store[i*NGLL3],</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4806);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a8021ab98bb29218f3a1de0a3e33d76">d_c23store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c23store[i*NGLL3],</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4807);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a75fe641c1a0fa474f4517a00545c7652">d_c24store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c24store[i*NGLL3],</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4808);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aca1f642fe526cfd357cc5240f68e0863">d_c25store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c25store[i*NGLL3],</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4809);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed16cea62e3086eb499aaedb26ad7dfc">d_c26store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c26store[i*NGLL3],</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4810);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a92e906caafa02d3b219ea330f9466031">d_c33store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c33store[i*NGLL3],</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4811);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2e6fb83ecd9001f5d664ec0839f57972">d_c34store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c34store[i*NGLL3],</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4812);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0862a18cddae6423e721dacab974e93e">d_c35store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c35store[i*NGLL3],</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4813);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9d76cbf3c6992debc5b0e70890fb2f49">d_c36store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c36store[i*NGLL3],</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4814);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7c4e8b67ff8de9093172a2a3e45e7939">d_c44store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c44store[i*NGLL3],</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4815);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0b282d32b6d427c499cf614c4701390c">d_c45store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c45store[i*NGLL3],</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4816);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a32d4d6fdda9286ae349655e14183f22c">d_c46store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c46store[i*NGLL3],</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4817);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0a443e256fbf33b2286fda44d44b407a">d_c55store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c55store[i*NGLL3],</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4818);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ace6dc60fb69bc859412f317d881bf4b6">d_c56store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c56store[i*NGLL3],</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4819);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a859a2daf33c0b38f58a4523d6c271ba5">d_c66store_crust_mantle</a>.cuda + i*NGLL3_PADDED, &amp;c66store[i*NGLL3],</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4820);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  }</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <span class="comment">// needed for boundary kernel calculations</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3 &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad42e27d6a609002565b3c2abf70e4892">save_boundary_mesh</a>) {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6877d2f44d16a79b0c994c54504a00a9">d_rhostore_crust_mantle</a>, size_padded);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>; i++) {</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6877d2f44d16a79b0c994c54504a00a9">d_rhostore_crust_mantle</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_rho[i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6877d2f44d16a79b0c994c54504a00a9">d_rhostore_crust_mantle</a>.cuda+i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>, &amp;h_rho[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),2106);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  }</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="comment">// mesh locations</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_crust_mantle mesh locations&quot;</span>);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">// rstore</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aac9468750f58d853dcb09489c956ad0c">d_rstore_crust_mantle</a>, h_rstore, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*size_glob);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="comment">// inner/outer elements</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a093790ab61d9614f1234ea79b9bb3c8a">num_phase_ispec_crust_mantle</a> = *num_phase_ispec;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa10bf105c51c215544cbe200e00897d2">d_phase_ispec_inner_crust_mantle</a>, phase_ispec_inner, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a093790ab61d9614f1234ea79b9bb3c8a">num_phase_ispec_crust_mantle</a>*2);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac40025a666d151f55f4d8c1ff1555ca0">nspec_outer_crust_mantle</a> = *nspec_outer;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a97c2f82fe10d4b6860e4492c7021a055">nspec_inner_crust_mantle</a> = *nspec_inner;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  <span class="comment">// CMB/fluid outer core coupling</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a547020fd4ab267b0ac494d1a50bae7a4">nspec2D_bottom_crust_mantle</a> = *NSPEC2D_BOTTOM_CM;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3e656f2ee4180330a0ae335324d94e17">d_ibelm_bottom_crust_mantle</a>, h_ibelm_bottom_crust_mantle, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a547020fd4ab267b0ac494d1a50bae7a4">nspec2D_bottom_crust_mantle</a>);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="comment">// wavefield</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_crust_mantle wavefields&quot;</span>);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="keywordtype">int</span> size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a666ace38b302f6cf2b04f50d89cc4c13">NGLOB_CRUST_MANTLE</a>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab944aeffdd9acbb80123c2aaecff98cb">d_displ_crust_mantle</a>, size);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ade04d8d40a6a2050d24369d9b99c410b">d_veloc_crust_mantle</a>, size);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a47bd672e294029e6af28a5bee6ee2c56">d_accel_crust_mantle</a>, size);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="comment">// backward/reconstructed wavefield</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a56f9e57b568ede45123c606ddfbb407e">d_b_displ_crust_mantle</a>, size);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab21c4ab0bd96eda84f605fc883f3825b">d_b_veloc_crust_mantle</a>, size);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3dd23b6d77afcfeba48b12164a8fb6fe">d_b_accel_crust_mantle</a>, size);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">//debugging with empty arrays</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad94b01dc9602909a802e23bb09272b4f">DEBUG_BACKWARD_SIMULATIONS</a> == 1) {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a56f9e57b568ede45123c606ddfbb407e">d_b_displ_crust_mantle</a>, size, 0);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab21c4ab0bd96eda84f605fc883f3825b">d_b_veloc_crust_mantle</a>, size, 0);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3dd23b6d77afcfeba48b12164a8fb6fe">d_b_accel_crust_mantle</a>, size, 0);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    cl_int errcode;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    cl_image_format format = {CL_R, CL_UNSIGNED_INT32};</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    mp-&gt;d_displ_cm_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab944aeffdd9acbb80123c2aaecff98cb">d_displ_crust_mantle</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    mp-&gt;d_accel_cm_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a47bd672e294029e6af28a5bee6ee2c56">d_accel_crust_mantle</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">// backward/reconstructed fields</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      mp-&gt;d_b_displ_cm_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a56f9e57b568ede45123c606ddfbb407e">d_b_displ_crust_mantle</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      mp-&gt;d_b_accel_cm_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3dd23b6d77afcfeba48b12164a8fb6fe">d_b_accel_crust_mantle</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      mp-&gt;d_b_displ_cm_tex = moclGetDummyImage2D(mp);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      mp-&gt;d_b_accel_cm_tex = moclGetDummyImage2D(mp);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    }</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  }</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    {</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="comment">// checks single precision</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>) != <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a>(<span class="stringliteral">&quot;TEXTURES only work with realw selected as float&quot;</span>);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="comment">// binds textures</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="preprocessor">#ifdef USE_OLDER_CUDA4_GPU</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc&lt;realw&gt;();</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="keyword">const</span> textureReference* d_displ_cm_tex_ref_ptr;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_displ_cm_tex_ref_ptr, <span class="stringliteral">&quot;d_displ_cm_tex&quot;</span>), 4021);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_displ_cm_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab944aeffdd9acbb80123c2aaecff98cb">d_displ_crust_mantle</a>.cuda,</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 4021);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keyword">const</span> textureReference* d_accel_cm_tex_ref_ptr;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_accel_cm_tex_ref_ptr, <span class="stringliteral">&quot;d_accel_cm_tex&quot;</span>), 4023);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_accel_cm_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a47bd672e294029e6af28a5bee6ee2c56">d_accel_crust_mantle</a>.cuda,</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 4023);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="comment">// backward/reconstructed wavefields</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keyword">const</span> textureReference* d_b_displ_cm_tex_ref_ptr;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_b_displ_cm_tex_ref_ptr, <span class="stringliteral">&quot;d_b_displ_cm_tex&quot;</span>), 4021);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_b_displ_cm_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a56f9e57b568ede45123c606ddfbb407e">d_b_displ_crust_mantle</a>.cuda,</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 4021);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="keyword">const</span> textureReference* d_b_accel_cm_tex_ref_ptr;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_b_accel_cm_tex_ref_ptr, <span class="stringliteral">&quot;d_b_accel_cm_tex&quot;</span>), 4023);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_b_accel_cm_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3dd23b6d77afcfeba48b12164a8fb6fe">d_b_accel_crust_mantle</a>.cuda,</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 4023);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc&lt;realw&gt;();</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_displ_cm_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab944aeffdd9acbb80123c2aaecff98cb">d_displ_crust_mantle</a>.cuda,</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 4021);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_accel_cm_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a47bd672e294029e6af28a5bee6ee2c56">d_accel_crust_mantle</a>.cuda,</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 4023);</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <span class="comment">// backward/reconstructed wavefields</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_b_displ_cm_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a56f9e57b568ede45123c606ddfbb407e">d_b_displ_crust_mantle</a>.cuda,</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 4021);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_b_accel_cm_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3dd23b6d77afcfeba48b12164a8fb6fe">d_b_accel_crust_mantle</a>.cuda,</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 4023);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;  <span class="comment">// mass matrices</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_crust_mantle mass matrices&quot;</span>);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8a0a398578bd14189dbf513e910b9802">d_rmassz_crust_mantle</a>, h_rmassz, size_glob);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="keywordflow">if</span> ((*NCHUNKS_VAL != 6 &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f2accdd148d23c3d3fbd5d486fe87b">absorbing_conditions</a>) || (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a> &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">exact_mass_matrix_for_rotation</a>)) {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae7b2a53ca55badab06155f4e0892775c">d_rmassx_crust_mantle</a>, h_rmassx, size_glob);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a49b82d07189347243be39b7f3ac673ac">d_rmassy_crust_mantle</a>, h_rmassy, size_glob);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae7b2a53ca55badab06155f4e0892775c">d_rmassx_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8a0a398578bd14189dbf513e910b9802">d_rmassz_crust_mantle</a>);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a49b82d07189347243be39b7f3ac673ac">d_rmassy_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8a0a398578bd14189dbf513e910b9802">d_rmassz_crust_mantle</a>);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  }</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="comment">// kernel simulations</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac97a6a9f3465602c2c26876f69fc16d8">d_b_rmassz_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8a0a398578bd14189dbf513e910b9802">d_rmassz_crust_mantle</a>);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a> &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">exact_mass_matrix_for_rotation</a>) {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad9a41b549ef236a06e10a96992787a22">d_b_rmassx_crust_mantle</a>, h_b_rmassx, size_glob);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae64b00249134a94e0f1c542c2a67b8e1">d_b_rmassy_crust_mantle</a>, h_b_rmassy, size_glob);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad9a41b549ef236a06e10a96992787a22">d_b_rmassx_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae7b2a53ca55badab06155f4e0892775c">d_rmassx_crust_mantle</a>);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae64b00249134a94e0f1c542c2a67b8e1">d_b_rmassy_crust_mantle</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a49b82d07189347243be39b7f3ac673ac">d_rmassy_crust_mantle</a>);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="comment">// kernels</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">NSPEC_CRUST_MANTLE</a>);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="comment">// density kernel</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3afb06a4b056fa58dce2f637d3f7f099">d_rho_kl_crust_mantle</a>, size);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">// initializes kernel values to zero</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3afb06a4b056fa58dce2f637d3f7f099">d_rho_kl_crust_mantle</a>, size, 0);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="comment">// wavespeed kernels</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6efbdbbf072565c01800e39dee48cae6">anisotropic_kl</a>) {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <span class="comment">// isotropic kernels</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae8caf49682d13f5bc717e0e57243e257">d_alpha_kl_crust_mantle</a>, size);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a69fb33bf716b90b1961381ac440e2f97">d_beta_kl_crust_mantle</a>, size);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="comment">// sets array values to zero</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae8caf49682d13f5bc717e0e57243e257">d_alpha_kl_crust_mantle</a>, size, 0);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a69fb33bf716b90b1961381ac440e2f97">d_beta_kl_crust_mantle</a>, size, 0);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <span class="comment">// anisotropic kernels</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae16c1bcebb2111e6fda79f0a4efcaa8c">d_cijkl_kl_crust_mantle</a>, 21 * size);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae16c1bcebb2111e6fda79f0a4efcaa8c">d_cijkl_kl_crust_mantle</a>, 21 * size, 0);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="comment">// preconditioner</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abf5df7ac66d415133867fae752f5b52e">approximate_hess_kl</a>) {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3cd4e1e4e0741f411def3c206bffa6f">d_hess_kl_crust_mantle</a>, size);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3cd4e1e4e0741f411def3c206bffa6f">d_hess_kl_crust_mantle</a>, size, 0);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <span class="comment">// mesh coloring</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afab61e54de1beb22aca30d02d54580fc">num_colors_outer_crust_mantle</a> = *num_colors_outer;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6818d1f46200cabba20c1405a1c613e8">num_colors_inner_crust_mantle</a> = *num_colors_inner;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a449222c07988fabb826b8842179d00ad">h_num_elem_colors_crust_mantle</a> = (<span class="keywordtype">int</span> *) num_elem_colors;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="comment">// executes gpu calls</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;  <span class="comment">// (especially needed for OpenCL kernels to finish executing)</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a8188c1c360944920584b2a0a1f9bf8ac">gpuSynchronize</a>();</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_crust_mantle_device&quot;</span>);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="comment">// debug</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">//printf(&quot;%d rank - prepare_crust_mantle done&quot;,mp-&gt;myrank);</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;}</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment">// OUTER CORE</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l01787"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a68bd87adcfa15b5658bf1b63f04cad60"> 1787</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_outer_core_device,</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;               PREPARE_OUTER_CORE_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xix, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xiy, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xiz,</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etax, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etay, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etaz,</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammax, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammay, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammaz,</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rho, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_kappav,</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rmass,</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                                           <span class="keywordtype">int</span> *h_ibool,</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rstore,</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                                           <span class="keywordtype">int</span> *num_phase_ispec,</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                                           <span class="keywordtype">int</span> *phase_ispec_inner,</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                                           <span class="keywordtype">int</span> *nspec_outer,</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                                           <span class="keywordtype">int</span> *nspec_inner,</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                                           <span class="keywordtype">int</span> *NSPEC2D_TOP_OC,</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                                           <span class="keywordtype">int</span> *NSPEC2D_BOTTOM_OC,</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_normal_top_outer_core,</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_normal_bottom_outer_core,</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_jacobian2D_top_outer_core,</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_jacobian2D_bottom_outer_core,</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                                           <span class="keywordtype">int</span> *h_ibelm_top_outer_core,</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                                           <span class="keywordtype">int</span> *h_ibelm_bottom_outer_core,</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                                           <span class="keywordtype">int</span> *num_colors_outer,</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                                           <span class="keywordtype">int</span> *num_colors_inner,</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                                           <span class="keywordtype">int</span> *num_elem_colors) {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_outer_core_device&quot;</span>);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="comment">/*Assuming NGLLX=5. Padded is then 128 (5^3+3) */</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="keywordtype">int</span> size_padded = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keywordtype">int</span> size_glob = mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a91945dcf3506fc89e08b15cbba533f88">NGLOB_OUTER_CORE</a>;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="comment">// mesh</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a14fd55b5867c389cf8eaa4cddc762414">d_xix_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf669d6085c50bd730e42c4f53047db9">d_xiy_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8c5db60f71e9bb39efc472ca2082b56c">d_xiz_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac0ff5de95c752a3189d31caa4e706abf">d_etax_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abb4c25f21ec2ed043cf83c604f2614fc">d_etay_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a738d24d6134b050eb391132067af7798">d_etaz_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aad2a78ccebd992954ad9b469e3249096">d_gammax_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0cde8155ceae21df90dfd8765f9088cd">d_gammay_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aae418083893e4d5380e5d70dfa866216">d_gammaz_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac8bd28eb81b8d941cce99742fb50c477">d_kappavstore_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  <span class="comment">// transfer constant element data with padding</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>; i++) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a14fd55b5867c389cf8eaa4cddc762414">d_xix_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                                     <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xix[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf669d6085c50bd730e42c4f53047db9">d_xiy_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xiy[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8c5db60f71e9bb39efc472ca2082b56c">d_xiz_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xiz[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac0ff5de95c752a3189d31caa4e706abf">d_etax_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                                     NGLL3 * sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etax[i * NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abb4c25f21ec2ed043cf83c604f2614fc">d_etay_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                                     NGLL3 * sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etay[i * NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a738d24d6134b050eb391132067af7798">d_etaz_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                                     NGLL3 * sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etaz[i * NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aad2a78ccebd992954ad9b469e3249096">d_gammax_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_gammax[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0cde8155ceae21df90dfd8765f9088cd">d_gammay_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_gammay[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aae418083893e4d5380e5d70dfa866216">d_gammaz_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_gammaz[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac8bd28eb81b8d941cce99742fb50c477">d_kappavstore_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_kappav[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a14fd55b5867c389cf8eaa4cddc762414">d_xix_outer_core</a>.cuda+i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>, &amp;h_xix[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1501);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf669d6085c50bd730e42c4f53047db9">d_xiy_outer_core</a>.cuda+i*NGLL3_PADDED, &amp;h_xiy[i*NGLL3],</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1502);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8c5db60f71e9bb39efc472ca2082b56c">d_xiz_outer_core</a>.cuda+i*NGLL3_PADDED, &amp;h_xiz[i*NGLL3],</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1503);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac0ff5de95c752a3189d31caa4e706abf">d_etax_outer_core</a>.cuda+i*NGLL3_PADDED, &amp;h_etax[i*NGLL3],</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1504);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abb4c25f21ec2ed043cf83c604f2614fc">d_etay_outer_core</a>.cuda+i*NGLL3_PADDED, &amp;h_etay[i*NGLL3],</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1505);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a738d24d6134b050eb391132067af7798">d_etaz_outer_core</a>.cuda+i*NGLL3_PADDED, &amp;h_etaz[i*NGLL3],</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1506);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aad2a78ccebd992954ad9b469e3249096">d_gammax_outer_core</a>.cuda+i*NGLL3_PADDED, &amp;h_gammax[i*NGLL3],</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1507);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0cde8155ceae21df90dfd8765f9088cd">d_gammay_outer_core</a>.cuda+i*NGLL3_PADDED, &amp;h_gammay[i*NGLL3],</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1508);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aae418083893e4d5380e5d70dfa866216">d_gammaz_outer_core</a>.cuda+i*NGLL3_PADDED, &amp;h_gammaz[i*NGLL3],</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1509);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac8bd28eb81b8d941cce99742fb50c477">d_kappavstore_outer_core</a>.cuda+i*NGLL3_PADDED,&amp;h_kappav[i*NGLL3],</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1510);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    }</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <span class="comment">// needed for kernel calculations</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac9d70f575e0ea3105d11764317e9ae6d">d_rhostore_outer_core</a>, size_padded);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>; i++) {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac9d70f575e0ea3105d11764317e9ae6d">d_rhostore_outer_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_rho[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      }</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac9d70f575e0ea3105d11764317e9ae6d">d_rhostore_outer_core</a>.cuda+i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>, &amp;h_rho[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),2106);</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      }</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    }</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  }</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="comment">// global indexing</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a554e81001ff33f78ee750dd113107090">d_ibool_outer_core</a>, h_ibool, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>));</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  <span class="comment">// mesh locations</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <span class="comment">// always needed</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a59227309ceb61cdc13d211ac2ca5cfe6">d_rstore_outer_core</a>, h_rstore, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * size_glob);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  <span class="comment">// inner/outer elements</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad02eb20d22dd252f5b00bec74039880c">num_phase_ispec_outer_core</a> = *num_phase_ispec;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a072bba99783be461d8b275af3bf203b0">d_phase_ispec_inner_outer_core</a>, phase_ispec_inner, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad02eb20d22dd252f5b00bec74039880c">num_phase_ispec_outer_core</a>*2);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af5011e99c154470d6c0b9c5ad34e9c19">nspec_outer_outer_core</a> = *nspec_outer;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af27051c86fee76f55b1aaadfdc487d44">nspec_inner_outer_core</a> = *nspec_inner;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="comment">// CMB/ICB coupling</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab2860282b6465c331133a8faa40c3868">nspec2D_top_outer_core</a> = *NSPEC2D_TOP_OC;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6788199e4725eea124255033aa5ec505">nspec2D_bottom_outer_core</a> = *NSPEC2D_BOTTOM_OC;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="keywordtype">int</span> size_toc = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab2860282b6465c331133a8faa40c3868">nspec2D_top_outer_core</a>;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a480e776746f641eb54b841c95b8d58d7">d_ibelm_top_outer_core</a>, h_ibelm_top_outer_core, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab2860282b6465c331133a8faa40c3868">nspec2D_top_outer_core</a>);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22453488c9229e180dc8449ac09bb98">d_jacobian2D_top_outer_core</a>, h_jacobian2D_top_outer_core, size_toc);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa2d5a81904111e4af763e904d2557b97">d_normal_top_outer_core</a>, h_normal_top_outer_core, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*size_toc);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  <span class="keywordtype">int</span> size_boc = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6788199e4725eea124255033aa5ec505">nspec2D_bottom_outer_core</a>;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af8362e581318c8faf5265f30196c08f4">d_ibelm_bottom_outer_core</a>, h_ibelm_bottom_outer_core, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6788199e4725eea124255033aa5ec505">nspec2D_bottom_outer_core</a>);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac031dcf07c1303b85cf7ed8ab7296a46">d_jacobian2D_bottom_outer_core</a>, h_jacobian2D_bottom_outer_core, size_boc);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a82737fe68b0f2360c5f41419d5e06128">d_normal_bottom_outer_core</a>, h_normal_bottom_outer_core, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a>*size_boc);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;  <span class="comment">// wavefield</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a776d223b1578c8625d0190f848eebfc2">d_displ_outer_core</a>, size_glob);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2741c23333476745f033741e5d4c2ff2">d_veloc_outer_core</a>, size_glob);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a614e141074294d6b0f21efd963d082ee">d_accel_outer_core</a>, size_glob);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="comment">// backward/reconstructed wavefield</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7fba1361e9c8f55e7c30c9ab1771ceca">d_b_displ_outer_core</a>, size_glob);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a68ec59ad595287935c7e02fdda8e5913">d_b_veloc_outer_core</a>, size_glob);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad29bca98750a15b4851199271753c0ae">d_b_accel_outer_core</a>, size_glob);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="comment">//debugging with empty arrays</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad94b01dc9602909a802e23bb09272b4f">DEBUG_BACKWARD_SIMULATIONS</a> == 1) {</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7fba1361e9c8f55e7c30c9ab1771ceca">d_b_displ_outer_core</a>, size_glob, 0);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a68ec59ad595287935c7e02fdda8e5913">d_b_veloc_outer_core</a>, size_glob, 0);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad29bca98750a15b4851199271753c0ae">d_b_accel_outer_core</a>, size_glob, 0);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    cl_int errcode;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    cl_image_format format = {CL_R, CL_UNSIGNED_INT32};</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    mp-&gt;d_displ_oc_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size_glob, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a776d223b1578c8625d0190f848eebfc2">d_displ_outer_core</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    mp-&gt;d_accel_oc_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size_glob, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a614e141074294d6b0f21efd963d082ee">d_accel_outer_core</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="comment">// backward/reconstructed fields</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      mp-&gt;d_b_displ_oc_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size_glob, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7fba1361e9c8f55e7c30c9ab1771ceca">d_b_displ_outer_core</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      mp-&gt;d_b_accel_oc_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size_glob, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad29bca98750a15b4851199271753c0ae">d_b_accel_outer_core</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      mp-&gt;d_b_displ_oc_tex = moclGetDummyImage2D(mp);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;      mp-&gt;d_b_accel_oc_tex = moclGetDummyImage2D(mp);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  }</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="preprocessor">#ifdef USE_OLDER_CUDA4_GPU</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc&lt;realw&gt;();</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keyword">const</span> textureReference* d_displ_oc_tex_ref_ptr;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_displ_oc_tex_ref_ptr, <span class="stringliteral">&quot;d_displ_oc_tex&quot;</span>), 5021);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_displ_oc_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a776d223b1578c8625d0190f848eebfc2">d_displ_outer_core</a>.cuda,</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                                            &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_glob), 5021);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="keyword">const</span> textureReference* d_accel_oc_tex_ref_ptr;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_accel_oc_tex_ref_ptr, <span class="stringliteral">&quot;d_accel_oc_tex&quot;</span>), 5023);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_accel_oc_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a614e141074294d6b0f21efd963d082ee">d_accel_outer_core</a>.cuda,</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                                            &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_glob), 5023);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="comment">// backward/reconstructed wavefields</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <span class="keyword">const</span> textureReference* d_b_displ_oc_tex_ref_ptr;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_b_displ_oc_tex_ref_ptr, <span class="stringliteral">&quot;d_b_displ_oc_tex&quot;</span>), 5021);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_b_displ_oc_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7fba1361e9c8f55e7c30c9ab1771ceca">d_b_displ_outer_core</a>.cuda,</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_glob), 5021);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keyword">const</span> textureReference* d_b_accel_oc_tex_ref_ptr;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_b_accel_oc_tex_ref_ptr, <span class="stringliteral">&quot;d_b_accel_oc_tex&quot;</span>), 5023);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_b_accel_oc_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad29bca98750a15b4851199271753c0ae">d_b_accel_outer_core</a>.cuda,</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_glob), 5023);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    }</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc&lt;realw&gt;();</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_displ_oc_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a776d223b1578c8625d0190f848eebfc2">d_displ_outer_core</a>.cuda,</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                                            &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_glob), 5021);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_accel_oc_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a614e141074294d6b0f21efd963d082ee">d_accel_outer_core</a>.cuda,</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                                            &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_glob), 5023);</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">// backward/reconstructed wavefields</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_b_displ_oc_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7fba1361e9c8f55e7c30c9ab1771ceca">d_b_displ_outer_core</a>.cuda,</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_glob), 5021);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_b_accel_oc_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad29bca98750a15b4851199271753c0ae">d_b_accel_outer_core</a>.cuda,</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size_glob), 5023);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  }</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <span class="comment">// mass matrix</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaba3efd3edea77cea2253be81c45e3d5">d_rmass_outer_core</a>, h_rmass, size_glob);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="comment">// kernel simulations</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="comment">// mass matrix</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2f86a4c9e96828b680b7e1e26a83abfb">d_b_rmass_outer_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaba3efd3edea77cea2253be81c45e3d5">d_rmass_outer_core</a>);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="comment">//kernels</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordtype">int</span> size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">NSPEC_OUTER_CORE</a>);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">// density kernel</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3a5060a75213f19a59c89c39654557ce">d_rho_kl_outer_core</a>, size);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3a5060a75213f19a59c89c39654557ce">d_rho_kl_outer_core</a>, size, 0);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="comment">// isotropic kernel</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0d0410d090f288c0edc270d315e5cf94">d_alpha_kl_outer_core</a>, size);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0d0410d090f288c0edc270d315e5cf94">d_alpha_kl_outer_core</a>, size, 0);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="comment">// mesh coloring</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4e67f675b4f6a78c144aeb4d6d0ee30d">num_colors_outer_outer_core</a> = *num_colors_outer;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6a72c219cab018873d6f7b665190db6f">num_colors_inner_outer_core</a> = *num_colors_inner;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4d0aaa5a46f341c2f0396e6df0541acb">h_num_elem_colors_outer_core</a> = (<span class="keywordtype">int</span> *) num_elem_colors;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <span class="comment">// executes gpu calls</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="comment">// (especially needed for OpenCL kernels to finish executing)</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a8188c1c360944920584b2a0a1f9bf8ac">gpuSynchronize</a>();</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_outer_core_device&quot;</span>);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;}</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">// INNER CORE</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l02069"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#ae64b293c382296dd2de8a56fbb0049a5"> 2069</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_inner_core_device,</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;               PREPARE_INNER_CORE_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xix, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xiy, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_xiz,</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etax, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etay, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_etaz,</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammax, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammay, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_gammaz,</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rho, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_kappav, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_muv,</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rmassx, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rmassy, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rmassz,</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_b_rmassx, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_b_rmassy,</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                                           <span class="keywordtype">int</span> *h_ibool,</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *h_rstore,</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a148311ac010a9fc86c1038a35248cd22">c11store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#ab089796730cb5c065e83f3187091238f">c12store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a41597654ab442f9228f6f2226a8d8998">c13store</a>,</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                                           <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#aaee302f1e5ea618bf1c8c8c2cdd220bc">c33store</a>, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a> *<a class="code" href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a65faffef391fb2a2b3a60fd0bee3b517">c44store</a>,</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                                           <span class="keywordtype">int</span> *h_idoubling_inner_core,</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                                           <span class="keywordtype">int</span> *num_phase_ispec,</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                                           <span class="keywordtype">int</span> *phase_ispec_inner,</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                                           <span class="keywordtype">int</span> *nspec_outer,</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                                           <span class="keywordtype">int</span> *nspec_inner,</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                                           <span class="keywordtype">int</span> *NSPEC2D_TOP_IC,</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                                           <span class="keywordtype">int</span> *h_ibelm_top_inner_core,</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                                           <span class="keywordtype">int</span> *num_colors_outer,</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                                           <span class="keywordtype">int</span> *num_colors_inner,</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                                           <span class="keywordtype">int</span> *num_elem_colors) {</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_inner_core_device&quot;</span>);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <span class="comment">/* Assuming NGLLX=5. Padded is then 128 (5^3+3) */</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <span class="keywordtype">int</span> size_padded = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keywordtype">int</span> size_glob = mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a720c153b4667a50f70c05dc14b212af0">NGLOB_INNER_CORE</a>;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="comment">// mesh</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57e82474be8cecdbd37c380ef22148cd">d_xix_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a04f370729e3340a4e6dee2cacc96e3f6">d_xiy_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae81fd851d70948d0a2c1957a1229ce22">d_xiz_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abda4fa2df68a103116b077e840683b3f">d_etax_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a23bfd0da9ad8e1eddd0ab0869a661b49">d_etay_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad9e462351ccee130beebd8093a452104">d_etaz_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a216b70fc7e57bb30a41620535beeb9df">d_gammax_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9240c3f4f491bba3e1d3328eec0636dd">d_gammay_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a78d861ecd2bbc990c583afdc2cb41c7c">d_gammaz_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  <span class="comment">// muvstore needed for attenuation also for anisotropic inner core</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6e20a534dbb19cd2221e95180cbc3cbe">d_muvstore_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="comment">// transfer constant element data with padding</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="keywordflow">for</span> (i = 0;i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>;i++) {</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57e82474be8cecdbd37c380ef22148cd">d_xix_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                                     <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xix[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a04f370729e3340a4e6dee2cacc96e3f6">d_xiy_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xiy[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae81fd851d70948d0a2c1957a1229ce22">d_xiz_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_xiz[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abda4fa2df68a103116b077e840683b3f">d_etax_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etax[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a23bfd0da9ad8e1eddd0ab0869a661b49">d_etay_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etay[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad9e462351ccee130beebd8093a452104">d_etaz_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_etaz[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a216b70fc7e57bb30a41620535beeb9df">d_gammax_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_gammax[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9240c3f4f491bba3e1d3328eec0636dd">d_gammay_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),&amp;h_gammay[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a78d861ecd2bbc990c583afdc2cb41c7c">d_gammaz_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_gammaz[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6e20a534dbb19cd2221e95180cbc3cbe">d_muvstore_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                                     NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_muv[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    }</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57e82474be8cecdbd37c380ef22148cd">d_xix_inner_core</a>.cuda+i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>, &amp;h_xix[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1501);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a04f370729e3340a4e6dee2cacc96e3f6">d_xiy_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_xiy[i*NGLL3],</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1502);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae81fd851d70948d0a2c1957a1229ce22">d_xiz_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_xiz[i*NGLL3],</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1503);</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abda4fa2df68a103116b077e840683b3f">d_etax_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_etax[i*NGLL3],</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1504);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a23bfd0da9ad8e1eddd0ab0869a661b49">d_etay_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_etay[i*NGLL3],</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1505);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad9e462351ccee130beebd8093a452104">d_etaz_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_etaz[i*NGLL3],</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1506);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a216b70fc7e57bb30a41620535beeb9df">d_gammax_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_gammax[i*NGLL3],</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1507);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9240c3f4f491bba3e1d3328eec0636dd">d_gammay_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_gammay[i*NGLL3],</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1508);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a78d861ecd2bbc990c583afdc2cb41c7c">d_gammaz_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_gammaz[i*NGLL3],</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1509);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6e20a534dbb19cd2221e95180cbc3cbe">d_muvstore_inner_core</a>.cuda+i*NGLL3_PADDED, &amp;h_muv[i*NGLL3],</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                                         NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1511);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;  <span class="comment">// anisotropy</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae1cec79cc3c64d136833423748e8fd8d">anisotropic_inner_core</a>) {</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">// no anisotropy (uses kappav and muv in inner core)</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="comment">// kappavstore needed</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a75032ae0909b2717863929ff331c6f69">d_kappavstore_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keywordflow">for</span> (i = 0;i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>;i++) {</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a75032ae0909b2717863929ff331c6f69">d_kappavstore_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_kappav[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      }</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a75032ae0909b2717863929ff331c6f69">d_kappavstore_inner_core</a>.cuda+i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>,&amp;h_kappav[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),1510);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="comment">// anisotropic inner core</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2125fe633561ddaf329280856865ab0a">d_c11store_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaa92f69e8383d5866cbe5f2500e1804f">d_c12store_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a26173243f6a3b795521c5b7bb7918d86">d_c13store_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aeb15cb097eeff248ac8a5e1169f0d938">d_c33store_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6367a6f4d15c8ddcb3ea3542b9c8ac1a">d_c44store_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="comment">// transfer constant element data with padding</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">for</span> (i = 0;i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>; i++) {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2125fe633561ddaf329280856865ab0a">d_c11store_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c11store[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaa92f69e8383d5866cbe5f2500e1804f">d_c12store_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c12store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a26173243f6a3b795521c5b7bb7918d86">d_c13store_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c13store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aeb15cb097eeff248ac8a5e1169f0d938">d_c33store_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c33store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6367a6f4d15c8ddcb3ea3542b9c8ac1a">d_c44store_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                                       NGLL3*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;c44store[i*NGLL3], 0, NULL, NULL));</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2125fe633561ddaf329280856865ab0a">d_c11store_inner_core</a>.cuda + i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>, &amp;c11store[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4800);</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaa92f69e8383d5866cbe5f2500e1804f">d_c12store_inner_core</a>.cuda + i*NGLL3_PADDED, &amp;c12store[i*NGLL3],</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4801);</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a26173243f6a3b795521c5b7bb7918d86">d_c13store_inner_core</a>.cuda + i*NGLL3_PADDED, &amp;c13store[i*NGLL3],</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4802);</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aeb15cb097eeff248ac8a5e1169f0d938">d_c33store_inner_core</a>.cuda + i*NGLL3_PADDED, &amp;c33store[i*NGLL3],</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4803);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6367a6f4d15c8ddcb3ea3542b9c8ac1a">d_c44store_inner_core</a>.cuda + i*NGLL3_PADDED, &amp;c44store[i*NGLL3],</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),4804);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    }</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="comment">// needed for boundary kernel calculations</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3 &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad42e27d6a609002565b3c2abf70e4892">save_boundary_mesh</a>) {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6599701ed77716191e24bd17cf57e852">d_rhostore_inner_core</a>, size_padded);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>; i++) {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <span class="keywordtype">int</span> offset = i * <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a> * <span class="keyword">sizeof</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a> (clEnqueueWriteBuffer (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6599701ed77716191e24bd17cf57e852">d_rhostore_inner_core</a>.ocl, CL_FALSE, offset,</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                                       <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>*sizeof (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>), &amp;h_rho[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>], 0, NULL, NULL));</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;      }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaMemcpy(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6599701ed77716191e24bd17cf57e852">d_rhostore_inner_core</a>.cuda+i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a>, &amp;h_rho[i*<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a>],</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                                           NGLL3*<span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>),cudaMemcpyHostToDevice),2106);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      }</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  <span class="comment">// global indexing</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a576ab0a536d5ac7d274abef84754d251">d_ibool_inner_core</a>, h_ibool, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>));</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <span class="comment">// fictious element flags</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a47610a04930017eff8586b9cfd69cff2">d_idoubling_inner_core</a>, h_idoubling_inner_core, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <span class="comment">// mesh locations</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="comment">// only needed when gravity is on</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#add67861d6106aea8784d1998c5f1bf9d">gravity</a>) {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74999f45582b040260ce031e39e99a18">d_rstore_inner_core</a>, h_rstore, <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * size_glob);</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="comment">// inner/outer elements</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab5527d29686c5e83c7e021b9173ca5a6">num_phase_ispec_inner_core</a> = *num_phase_ispec;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6c0625852d8c90918dfc2aa94b5d30fe">d_phase_ispec_inner_inner_core</a>, phase_ispec_inner, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab5527d29686c5e83c7e021b9173ca5a6">num_phase_ispec_inner_core</a>*2);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a732e614647c2628f1855044c8665e774">nspec_outer_inner_core</a> = *nspec_outer;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aeeedf9a38cb4978e606f65fd5d8ef456">nspec_inner_inner_core</a> = *nspec_inner;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  <span class="comment">// boundary elements on top</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1821a18962267bd254d7ef3ae6d762df">nspec2D_top_inner_core</a> = *NSPEC2D_TOP_IC;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aceeb1e8a077f04ed80c171801f189c34">d_ibelm_top_inner_core</a>, h_ibelm_top_inner_core, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1821a18962267bd254d7ef3ae6d762df">nspec2D_top_inner_core</a>);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  <span class="comment">// wavefield</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  <span class="keywordtype">int</span> size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a> * mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a720c153b4667a50f70c05dc14b212af0">NGLOB_INNER_CORE</a>;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22d056ba319fd172ad524859fa8f4a8">d_displ_inner_core</a>, size);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aab0dbb2ca6a9e39ad894b04050ad654e">d_veloc_inner_core</a>, size);</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a516bcef456f2739884b6a6291096ef35">d_accel_inner_core</a>, size);</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="comment">// backward/reconstructed wavefield</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a91b628f3c31e510c04ea3ce4d7be1adb">d_b_displ_inner_core</a>, size);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a199944453a6af45db111791ae31c60">d_b_veloc_inner_core</a>, size);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4e59bc60eb3d74bd40b8a844e47fe65f">d_b_accel_inner_core</a>, size);</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="comment">//debugging with empty arrays</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#ad94b01dc9602909a802e23bb09272b4f">DEBUG_BACKWARD_SIMULATIONS</a> == 1) {</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22d056ba319fd172ad524859fa8f4a8">d_displ_inner_core</a>, size, 0);</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aab0dbb2ca6a9e39ad894b04050ad654e">d_veloc_inner_core</a>, size, 0);</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a516bcef456f2739884b6a6291096ef35">d_accel_inner_core</a>, size, 0);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    }</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  }</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    cl_int errcode;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    cl_image_format format = {CL_R, CL_UNSIGNED_INT32};</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    mp-&gt;d_displ_ic_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22d056ba319fd172ad524859fa8f4a8">d_displ_inner_core</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    mp-&gt;d_accel_ic_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a516bcef456f2739884b6a6291096ef35">d_accel_inner_core</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="comment">// backward/reconstructed fields</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      mp-&gt;d_b_displ_ic_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a91b628f3c31e510c04ea3ce4d7be1adb">d_b_displ_inner_core</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      mp-&gt;d_b_accel_ic_tex = clCreateImage2D (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">context</a>, CL_MEM_READ_ONLY, &amp;format, size, 1, 0, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4e59bc60eb3d74bd40b8a844e47fe65f">d_b_accel_inner_core</a>.ocl, <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a>(&amp;errcode));</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      mp-&gt;d_b_displ_ic_tex = moclGetDummyImage2D(mp);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      mp-&gt;d_b_accel_ic_tex = moclGetDummyImage2D(mp);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    }</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    {</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="preprocessor">#ifdef USE_OLDER_CUDA4_GPU</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc&lt;realw&gt;();</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <span class="keyword">const</span> textureReference* d_displ_ic_tex_ref_ptr;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_displ_ic_tex_ref_ptr, <span class="stringliteral">&quot;d_displ_ic_tex&quot;</span>), 6021);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_displ_ic_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22d056ba319fd172ad524859fa8f4a8">d_displ_inner_core</a>,</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 6021);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      <span class="keyword">const</span> textureReference* d_accel_ic_tex_ref_ptr;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_accel_ic_tex_ref_ptr, <span class="stringliteral">&quot;d_accel_ic_tex&quot;</span>), 6023);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_accel_ic_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a516bcef456f2739884b6a6291096ef35">d_accel_inner_core</a>,</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 6023);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="comment">// backward/reconstructed wavefields</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <span class="keyword">const</span> textureReference* d_b_displ_ic_tex_ref_ptr;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_b_displ_ic_tex_ref_ptr, <span class="stringliteral">&quot;d_b_displ_ic_tex&quot;</span>), 6021);</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_b_displ_ic_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a91b628f3c31e510c04ea3ce4d7be1adb">d_b_displ_inner_core</a>,</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 6021);</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        <span class="keyword">const</span> textureReference* d_b_accel_ic_tex_ref_ptr;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaGetTextureReference(&amp;d_b_accel_ic_tex_ref_ptr, <span class="stringliteral">&quot;d_b_accel_ic_tex&quot;</span>), 6023);</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, d_b_accel_ic_tex_ref_ptr, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4e59bc60eb3d74bd40b8a844e47fe65f">d_b_accel_inner_core</a>,</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 6023);</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc&lt;realw&gt;();</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_displ_ic_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22d056ba319fd172ad524859fa8f4a8">d_displ_inner_core</a>.cuda,</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 6021);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_accel_ic_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a516bcef456f2739884b6a6291096ef35">d_accel_inner_core</a>.cuda,</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                                              &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 6023);</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      <span class="comment">// backward/reconstructed wavefields</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_b_displ_ic_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a91b628f3c31e510c04ea3ce4d7be1adb">d_b_displ_inner_core</a>.cuda,</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 6021);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <a class="code" href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a>(cudaBindTexture(0, &amp;d_b_accel_ic_tex, mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4e59bc60eb3d74bd40b8a844e47fe65f">d_b_accel_inner_core</a>.cuda,</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                                                &amp;channelDesc, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a>)*size), 6023);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    }</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  }</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <span class="comment">// mass matrix</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a3991d9942ffeceaf8ea5cb2610fcd9">d_rmassz_inner_core</a>, h_rmassz, size_glob);</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a> &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">exact_mass_matrix_for_rotation</a>) {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a93add741cbc781355cc64d0ab97a8de2">d_rmassx_inner_core</a>, h_rmassx, size_glob);</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2ed941cb43ecb5700fb7ac6e8e752479">d_rmassy_inner_core</a>, h_rmassy, size_glob);</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a93add741cbc781355cc64d0ab97a8de2">d_rmassx_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a3991d9942ffeceaf8ea5cb2610fcd9">d_rmassz_inner_core</a>);</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2ed941cb43ecb5700fb7ac6e8e752479">d_rmassy_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a3991d9942ffeceaf8ea5cb2610fcd9">d_rmassz_inner_core</a>);</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  }</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <span class="comment">// kernel simulations</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="comment">// mass matrices</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad42a2d9a362bbea93e1f541684da6f78">d_b_rmassz_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a3991d9942ffeceaf8ea5cb2610fcd9">d_rmassz_inner_core</a>);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a> &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">exact_mass_matrix_for_rotation</a>) {</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4aae6e672ec4f1be740c01216edf04bf">d_b_rmassx_inner_core</a>, h_b_rmassx, size_glob);</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad93bb2712679b6d2c5c8a1eba0911244">d_b_rmassy_inner_core</a>, h_b_rmassy, size_glob);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4aae6e672ec4f1be740c01216edf04bf">d_b_rmassx_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a93add741cbc781355cc64d0ab97a8de2">d_rmassx_inner_core</a>);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad93bb2712679b6d2c5c8a1eba0911244">d_b_rmassy_inner_core</a> = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a>(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2ed941cb43ecb5700fb7ac6e8e752479">d_rmassy_inner_core</a>);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    }</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="comment">// kernels</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    size = <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a> * (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">NSPEC_INNER_CORE</a>);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="comment">// density kernel</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0c6822d0bce7e7064fbc10c13750b9e5">d_rho_kl_inner_core</a>, size);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0c6822d0bce7e7064fbc10c13750b9e5">d_rho_kl_inner_core</a>, size, 0);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="comment">// isotropic kernel</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed265b02678db7ffacf67141712fe50f">d_alpha_kl_inner_core</a>, size);</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed265b02678db7ffacf67141712fe50f">d_alpha_kl_inner_core</a>, size, 0);</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaf14856a459a08f33ded6e6664a2d257">d_beta_kl_inner_core</a>, size);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaf14856a459a08f33ded6e6664a2d257">d_beta_kl_inner_core</a>, size, 0);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  }</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <span class="comment">// mesh coloring</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9f4a8ed1b49615e5853a8df2c1f9962c">num_colors_outer_inner_core</a> = *num_colors_outer;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0f86cbc257331ac61ed26e5c223bcd46">num_colors_inner_inner_core</a> = *num_colors_inner;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a45a8c9b5d0615e443242d1787dc128ab">h_num_elem_colors_inner_core</a> = (<span class="keywordtype">int</span> *) num_elem_colors;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <span class="comment">// executes gpu calls</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  <span class="comment">// (especially needed for OpenCL kernels to finish executing)</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a8188c1c360944920584b2a0a1f9bf8ac">gpuSynchronize</a>();</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a> (<span class="stringliteral">&quot;prepare_inner_core_device&quot;</span>);</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;}</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">// cleanup</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">/*----------------------------------------------------------------------------------------------- */</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div>
<div class="line"><a name="l02437"></a><span class="lineno"><a class="line" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#ac5a1f049a042d65c8a7901b767e60233"> 2437</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a> (prepare_cleanup_device,</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;               PREPARE_CLEANUP_DEVICE) (<span class="keywordtype">long</span> *Mesh_pointer_f,</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                                        <span class="keywordtype">int</span> *NCHUNKS_VAL) {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  <a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a> (<span class="stringliteral">&quot;prepare_cleanup_device&quot;</span>);</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="comment">// frees allocated memory arrays</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *mp = (<a class="code" href="../../d2/d88/structmesh__.html">Mesh</a> *) *Mesh_pointer_f;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="comment">// synchronizes device</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a8188c1c360944920584b2a0a1f9bf8ac">gpuSynchronize</a>();</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  <span class="comment">// frees memory on GPU</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  <span class="comment">// textures</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_CONSTANTS</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    cudaUnbindTexture(d_hprime_xx_tex);</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    cudaUnbindTexture(d_hprimewgll_xx_tex);</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    cudaUnbindTexture(d_displ_cm_tex);</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    cudaUnbindTexture(d_accel_cm_tex);</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      cudaUnbindTexture(d_b_displ_cm_tex);</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      cudaUnbindTexture(d_b_accel_cm_tex);</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    }</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    cudaUnbindTexture(d_displ_ic_tex);</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    cudaUnbindTexture(d_accel_ic_tex);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      cudaUnbindTexture(d_b_displ_ic_tex);</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      cudaUnbindTexture(d_b_accel_ic_tex);</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    }</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    cudaUnbindTexture(d_displ_oc_tex);</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    cudaUnbindTexture(d_accel_oc_tex);</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      cudaUnbindTexture(d_b_displ_oc_tex);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      cudaUnbindTexture(d_b_accel_oc_tex);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    }</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;  }</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;  <span class="comment">// pinned memory</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;  <span class="comment">// receiver seismograms</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a> &gt; 0) {</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (station_seismo_field);</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7bd4681d488cb7929ea7f7a44d98a7f2">h_station_seismo_field</a>);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      free (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7bd4681d488cb7929ea7f7a44d98a7f2">h_station_seismo_field</a>);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    }</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;  }</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;  <span class="comment">// adjoint source arrays</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a> &gt; 0) {</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (adj_sourcearrays_slice);</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f0273a931d5d73e16b52232fa03281">h_adj_sourcearrays_slice</a>);</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      free (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f0273a931d5d73e16b52232fa03281">h_adj_sourcearrays_slice</a>);</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    }</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;  }</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  <span class="comment">// mpi buffers</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">num_interfaces_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (send_accel_buffer_cm);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (recv_accel_buffer_cm);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (b_send_accel_buffer_cm);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (b_recv_accel_buffer_cm);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        }</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      }</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">num_interfaces_inner_core</a> &gt; 0) {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (send_accel_buffer_ic);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (recv_accel_buffer_ic);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (b_send_accel_buffer_ic);</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (b_recv_accel_buffer_ic);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        }</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      }</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    }</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">num_interfaces_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (send_accel_buffer_oc);</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (recv_accel_buffer_oc);</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (b_send_accel_buffer_oc);</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;          <a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a> (b_recv_accel_buffer_oc);</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        }</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      }</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    }</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">num_interfaces_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad00c7054f9b86752da332b155d9fb6ac">h_send_accel_buffer_cm</a>);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaf6b896c78677f5253c0422dd76331b4">h_recv_accel_buffer_cm</a>);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;          cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa485a6b10d9716d20c4b06dc8ea8c5e5">h_b_send_accel_buffer_cm</a>);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;          cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae1c979458a0c87759b6a6bb03498b5c7">h_b_recv_accel_buffer_cm</a>);</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        }</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      }</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    }</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">num_interfaces_inner_core</a> &gt; 0) {</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa7eb120024ba76ddc38bf0321aa8a35c">h_send_accel_buffer_ic</a>);</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3775d6785cfdf260464cd71d9d844146">h_recv_accel_buffer_ic</a>);</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;          cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a94dae0867df03ced9873de73db6fd428">h_b_send_accel_buffer_ic</a>);</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;          cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a85540618f50dca95bdbd7eda1eb80916">h_b_recv_accel_buffer_ic</a>);</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        }</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      }</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    }</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">num_interfaces_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) {</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a38ef87e9553ec5ed4f613fcc7d5c7cb0">h_send_accel_buffer_oc</a>);</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af1e280d7cac724ded01c9fde7e8d0fb9">h_recv_accel_buffer_oc</a>);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;          cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afb692dc5c8ba388d6179d622daddae8e">h_b_send_accel_buffer_oc</a>);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;          cudaFreeHost(mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a17819433e875d9b944d91830e9184942">h_b_recv_accel_buffer_oc</a>);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        }</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      }</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    }</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  }</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  <span class="comment">// constants</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_CONSTANTS</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    clReleaseMemObject (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa8b367229b0357f2ffc995ceb1481b59">d_hprime_xx</a>.ocl);</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    clReleaseMemObject (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa494ced6a0aefce755316d7881d7f350">d_hprimewgll_xx</a>.ocl);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    clReleaseMemObject (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#adc64359edf2a87893eddd4cf5cf6fce4">d_wgllwgll_xy</a>.ocl);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    clReleaseMemObject (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a521202fdc8f532221b5d3bb511f3da11">d_wgllwgll_xz</a>.ocl);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    clReleaseMemObject (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a766c20bb0f862bcb9fda52d216baf266">d_wgllwgll_yz</a>.ocl);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    clReleaseMemObject (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af08c0acf55538f5408e5ef38bfec9c14">d_wgll_cube</a>.ocl);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  }</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  <span class="comment">// sources</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 1 || mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a30f1cbb0e80d6839e5243e28874c2c55">d_sourcearrays</a>);</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4ba3bc5cb5d83c7cf3a2529690972cf6">d_stf_pre_compute</a>);</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;  }</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4337f7490448e25af5bc44230270ce1d">d_islice_selected_source</a>);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a46fd62f2a18df5fee4323c126e904a9a">d_ispec_selected_source</a>);</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;  <span class="comment">// receivers</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">nrec_local</a> &gt; 0) {</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa020a4e27290b96ff34aa0efb2c0ec23">d_number_receiver_global</a>);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab2427c5b309fdc32ea4bda0759b8e6c5">d_station_seismo_field</a>);</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 2) {</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a543f8dfc4d0eb6918d4b6311e5dbc841">d_station_strain_field</a>);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    }</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;  }</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad404fad4a9d6ab87708de919974850e4">d_ispec_selected_rec</a>);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">nadj_rec_local</a> &gt; 0) {</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad72bc437a1b6e31d51c90b21d395a894">d_adj_sourcearrays</a>);</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a45dfd81d4414869744dea84b67a292db">d_pre_computed_irec</a>);</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  }</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5b2bb6e71a612e82d011de3380445121">d_norm_max</a>);</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  <span class="comment">// rotation arrays</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a>) {</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a040f596b4e803a1ca439e29dad9e25a3">d_A_array_rotation</a>);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a697f1440498e8a89321f35a60f94e68d">d_B_array_rotation</a>);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a20889301eb6aebebcc62fd450e903337">d_b_A_array_rotation</a>);</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4c3b7504c2164627800c2e02afe8347e">d_b_B_array_rotation</a>);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  }</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;  <span class="comment">// gravity arrays</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#add67861d6106aea8784d1998c5f1bf9d">gravity</a>) {</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a914b75504cecab3c01b2136d87dad438">d_d_ln_density_dr_table</a>);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a088123526218cdd346388b677f272acc">d_minus_rho_g_over_kappa_fluid</a>);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2474e65348de287385f1783d08757635">d_minus_gravity_table</a>);</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a277c63d71bafe01200a4b9699e73d02e">d_minus_deriv_gravity_table</a>);</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a887c3a0fd18bee41caf8c974028bc59b">d_density_table</a>);</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  }</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  <span class="comment">// attenuation arrays</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2f75e1ea687c10ba2be829306146bc07">attenuation</a>) {</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a553b6e29f88b6cdc8c9579a369fd2e83">d_one_minus_sum_beta_crust_mantle</a>);</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a62a91a122e4e1ffc161b17d7c088fcae">d_one_minus_sum_beta_inner_core</a>);</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9dc8d971c041bd9ed76db6efa94b2f95">partial_phys_dispersion_only</a>) {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#adb4fe4d689e1b54986b21462362c6e17">d_factor_common_crust_mantle</a>);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8b5d44da0448862e6dff3f9768b7a387">d_R_xx_crust_mantle</a>);</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a828f870e9738bb778920e6cbb4e27c26">d_R_yy_crust_mantle</a>);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad17b618ef4424736feef1e0a7536f299">d_R_xy_crust_mantle</a>);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abd2a0ea38bf4d5f605e88124ebed2123">d_R_xz_crust_mantle</a>);</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad98a9518680f56d4ce1f6c2e7f6e2ce0">d_R_yz_crust_mantle</a>);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab92f56d46a7c7f8748d26d17290d20a0">d_factor_common_inner_core</a>);</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad5e42fcf68a2053965029c0725c5305f">d_R_xx_inner_core</a>);</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afd905bb6aa0bd951e0f97931f14dcaf2">d_R_yy_inner_core</a>);</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa772b8837e77ed340f0c6af5cdfa73ea">d_R_xy_inner_core</a>);</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a862349f3ee6655dcdefea1d0364dd9a4">d_R_xz_inner_core</a>);</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35353d78198f805b8820aafaada5c7c4">d_R_yz_inner_core</a>);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    }</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae76c60914b944131d687ecb85b337835">d_alphaval</a>);</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a12137d1e3db2cdd7d5fcb63a7c7085e4">d_betaval</a>);</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4bfeec96b6fae162cba9bcacebefbbbe">d_gammaval</a>);</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab027bfc3485ed571028a1d35c9b2627d">d_b_alphaval</a>);</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af15850cf201bf9ceea045d775045f674">d_b_betaval</a>);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22d60235f9a92926b4db648eb5bf464">d_b_gammaval</a>);</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    }</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  }</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  <span class="comment">// strain</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a02f54fb788adbc4c2cdc0ef1aa6af675">compute_and_store_strain</a>) {</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3031d8304f5c5ba2ff1af0708909ffdb">d_epsilondev_xx_crust_mantle</a>);</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ada3d32d67768986408c59934ae3419ff">d_epsilondev_yy_crust_mantle</a>);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8d022c01dc285d81a6f2f609b05aebd4">d_epsilondev_xy_crust_mantle</a>);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa81ead1f92ffef0fc9e45606814e606c">d_epsilondev_xz_crust_mantle</a>);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a52d5a8e4dceed2fd59279003c594b5a0">d_epsilondev_yz_crust_mantle</a>);</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a15094f7c6fd3180c961aedf9a2790ef7">d_epsilondev_xx_inner_core</a>);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a4ca0cb83ae4b36c5b5d6a844970987">d_epsilondev_yy_inner_core</a>);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae67d8ce2ec9fb40cc53aaa08d51a9a91">d_epsilondev_xy_inner_core</a>);</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a31ead77ca0a77f247fa9fdb406e4dd56">d_epsilondev_xz_inner_core</a>);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a5c6dac0533a51d2551bccdb1ff5a21">d_epsilondev_yz_inner_core</a>);</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afeb1c65fd7d0827a663fa286cb07dde5">d_eps_trace_over_3_crust_mantle</a>);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3d75627c48c86823e4cadfee2b5fa26e">d_eps_trace_over_3_inner_core</a>);</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3 &amp;&amp; ! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af9ed3392c5155cd8ef14831c97fb8e4a">undo_attenuation</a>) {</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3527d35e7c96aa03b9efce9613767592">d_b_epsilondev_xx_crust_mantle</a>);</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0e5b1c3e4efe36916902880ee5ee0b43">d_b_epsilondev_yy_crust_mantle</a>);</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8c9b781c9bb0ea693399f14971e5ce7">d_b_epsilondev_xy_crust_mantle</a>);</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af8bd069f109d24c07e4935e8b8a11e80">d_b_epsilondev_xz_crust_mantle</a>);</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a942ba73a8631a5efea8683e0d9d7d980">d_b_epsilondev_yz_crust_mantle</a>);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae4c74710535027d0060b48e4f7c25908">d_b_epsilondev_xx_inner_core</a>);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3c5585d9684da69e8bd37a87437dfaa3">d_b_epsilondev_yy_inner_core</a>);</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab4605156829d24601b63e2a33693d258">d_b_epsilondev_xy_inner_core</a>);</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad7d379e75cd23c21405ca7b28eff414a">d_b_epsilondev_xz_inner_core</a>);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab720949e150adec27caa401394a0aa42">d_b_epsilondev_yz_inner_core</a>);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac2e444710777a5041eb42090670a8b66">d_b_eps_trace_over_3_crust_mantle</a>);</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0e7b57e9d26992326ac637c11e345ca9">d_b_eps_trace_over_3_inner_core</a>);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    }</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;  }</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  <span class="comment">// absorbing boundaries arrays</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f2accdd148d23c3d3fbd5d486fe87b">absorbing_conditions</a>) {</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6640e89ba1dbf1f52a8476299245e61c">d_rho_vp_crust_mantle</a>);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a364225eb71cc5d1f3e07b0e612866a5b">d_rho_vs_crust_mantle</a>);</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a751b93454f8a335682b009089ba1c42f">d_nkmin_xi_crust_mantle</a>);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7359e7b881886f9640274e0b830a0313">d_nkmin_eta_crust_mantle</a>);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a93844111b6b5c5ce0646344ff0bd1b86">d_njmin_crust_mantle</a>);</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a55fbd1bbfa6cf28a2acc529596a91c1a">d_njmax_crust_mantle</a>);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7a01ec98899aec24bbab047328fe0e23">d_nimin_crust_mantle</a>);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1ee87f3481e27c06e7a355aeed24cc46">d_nimax_crust_mantle</a>);</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff06dab5e4c140b9181104caf915cd09">nspec2D_xmin_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8a68cf9e50c65403318966bc32f0feac">d_ibelm_xmin_crust_mantle</a>);</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1278dcc0aec8bc5e2400005e16505e06">d_normal_xmin_crust_mantle</a>);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9787325a6dc6f90b28e6d5b0c047c2ba">d_jacobian2D_xmin_crust_mantle</a>);</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0bb8ee2d74ebaeb68e0d54005e48c310">d_absorb_xmin_crust_mantle</a>);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      }</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    }</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab16d7257d92a7cb9b29d1b461843db63">nspec2D_xmax_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ade386b82a626cf9fc0ef3a4a0559d04f">d_ibelm_xmax_crust_mantle</a>);</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad010d00c166f1bdef85447a5e3cae3b2">d_normal_xmax_crust_mantle</a>);</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae5ce7e58987a20afe4bf0d93ced01e45">d_jacobian2D_xmax_crust_mantle</a>);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a101156fa97590c52662408617fa79e7e">d_absorb_xmax_crust_mantle</a>);</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      }</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    }</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf09f07450524877347548fdb88ffd22">nspec2D_ymin_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a94497e687bfcaf659677bea2b41705">d_ibelm_ymin_crust_mantle</a>);</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a78592cd625fc9f65e28d686c259c111c">d_normal_ymin_crust_mantle</a>);</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa07d13732521f9b75c5786b65ea865f8">d_jacobian2D_ymin_crust_mantle</a>);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abb029b9b141eef7ab53da75594ca92be">d_absorb_ymin_crust_mantle</a>);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      }</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    }</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa1f641dd67cff778bce7ff8403bf06fa">nspec2D_ymax_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a76c841709f62363d5d46318df9c3c9f4">d_ibelm_ymax_crust_mantle</a>);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8db3ee3a1cabd76554dd7118ad057109">d_normal_ymax_crust_mantle</a>);</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a46339796930aae060164e700f0a9c99f">d_jacobian2D_ymax_crust_mantle</a>);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a93d94d0c3537c00eafd8c556e846ac24">d_absorb_ymax_crust_mantle</a>);</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      }</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    }</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a454a8bfca214d6368fe31beb162a1ee2">d_vp_outer_core</a>);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9f652523eeebae4f18f68dd4430f5c44">d_nkmin_xi_outer_core</a>);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5dba209d935c8742faeec8a2b42faaf3">d_nkmin_eta_outer_core</a>);</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a64fc6e4b22b5167f9fa6588079497890">d_njmin_outer_core</a>);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afaf83dadc024b96704da0755c2bcb256">d_njmax_outer_core</a>);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a43d05db64c2b77160fbbe332477ddf29">d_nimin_outer_core</a>);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a78eeb1e93b7dbb4a4b3d5592f4f9934e">d_nimax_outer_core</a>);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4eb515980cb5002e5d54a3d220e85c13">nspec2D_xmin_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaeb71d1a82c9f5660f89cae589ff14b1">d_ibelm_xmin_outer_core</a>);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac0018c1471e2634f619072f26905de88">d_jacobian2D_xmin_outer_core</a>);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5e09abf122afc522d084179bfbc57028">d_absorb_xmin_outer_core</a>);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;      }</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    }</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a228cd6822e22e73e757666ae371a57">nspec2D_xmax_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9c76d9e7af55d02d8e07e1b57c28fd98">d_ibelm_xmax_outer_core</a>);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3bd686edbeffc96caebd86f8e5d7acd8">d_jacobian2D_xmax_outer_core</a>);</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac2da2b9c51ef05597ebf07887beb0514">d_absorb_xmax_outer_core</a>);</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      }</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    }</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae87462e60db1da0aa2e3a3d27bca626d">nspec2D_ymin_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a34d36dff216801f1b524d9382642a2a3">d_ibelm_ymin_outer_core</a>);</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2d16ee43a986b610ad75b655d75c12c9">d_jacobian2D_ymin_outer_core</a>);</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aef7bc36faad3d73528e43865d9df83ac">d_absorb_ymin_outer_core</a>);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      }</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    }</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a042606a2b56dcc00d30e9d9c26a80d12">nspec2D_ymax_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afb9ec80ae0c39aceb79e4c252bac0a8f">d_ibelm_ymax_outer_core</a>);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5bd19e66662956b156f674320c3dcb77">d_jacobian2D_ymax_outer_core</a>);</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a97742ee0dcb0ffe0897b51372e4a8c04">d_absorb_ymax_outer_core</a>);</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      }</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    }</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a13e89a7396d89ba209d7f83a2a168280">nspec2D_zmin_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">save_stacey</a>) {</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a642a63f522d93d71785abff97b045023">d_absorb_zmin_outer_core</a>);</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      }</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    }</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  }</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <span class="comment">// MPI buffers</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">num_interfaces_crust_mantle</a> &gt; 0) {</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa11f7cabea501f93ee8eae9c62805167">d_nibool_interfaces_crust_mantle</a>);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#adef8666c17727c1bd8efb0b9000607bf">d_ibool_interfaces_crust_mantle</a>);</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af4a7778304768cb9168190b378c5e585">d_send_accel_buffer_crust_mantle</a>);</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8b7866dfc5c6fff2554ec6889b088abc">d_b_send_accel_buffer_crust_mantle</a>);</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;  }</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">num_interfaces_inner_core</a> &gt; 0) {</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4ab78b34ac901bf210a4646093964370">d_nibool_interfaces_inner_core</a>);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6b64a3db433854de8e65c25c4d00b392">d_ibool_interfaces_inner_core</a>);</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae895eecdf95d57c65b681ca43e7232d1">d_send_accel_buffer_inner_core</a>);</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5e1239a68ee582004c95479540a03f20">d_b_send_accel_buffer_inner_core</a>);</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  }</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">num_interfaces_outer_core</a> &gt; 0) {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a756f40e55ceb0e610fd064a71c3e28f0">d_nibool_interfaces_outer_core</a>);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6cebb837bf8ae85a273033ef39054232">d_ibool_interfaces_outer_core</a>);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae29f844d277df67bab0930a4f9a2f578">d_send_accel_buffer_outer_core</a>);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a008e31fd1f2a027c441a62cb2e81be31">d_b_send_accel_buffer_outer_core</a>);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  }</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;  <span class="comment">// NOISE arrays</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">noise_tomography</a> &gt; 0) {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abd7c1e2df1ee271fc1a47a836bd793b2">d_ibelm_top_crust_mantle</a>);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1989f8adfab2b3e7b8e580b94898edb6">d_noise_surface_movie</a>);</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">noise_tomography</a> == 1) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a1793ff103290e8c06c17d4ccc24c924a">d_noise_sourcearray</a>);</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">noise_tomography</a> &gt; 1) {</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4fcc1869ac2e6f07350f13edc4914e8d">d_normal_x_noise</a>);</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab7ee7f4d8000df05047d76d8324e8ede">d_normal_y_noise</a>);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac8e0ee203263170c071b14a1a2b90f68">d_normal_z_noise</a>);</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3363d4581b5b00f8f94798a2b48d690">d_mask_noise</a>);</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa2d937997815bc4f6bf6d5e78d367933">d_jacobian2D_top_crust_mantle</a>);</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    }</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">noise_tomography</a> == 3) <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae519e498ca8126979e0db0cd12401f8d">d_Sigma_kl</a>);</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;  }</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;  <span class="comment">// crust_mantle</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3474881fb737a088d5d39aa99c60a07e">d_xix_crust_mantle</a>);</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a58052ea6faf38efdd2e3f6c0fb12e0ca">d_xiy_crust_mantle</a>);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f9f5b9ce5f0c21fb1e66eea91b6ceb">d_xiz_crust_mantle</a>);</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#afb5c630a75fed79535e9b6bc03673f5a">d_etax_crust_mantle</a>);</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5b4a2d8806c451c2d7260656c7fa4574">d_etay_crust_mantle</a>);</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a88fae143685e4b2cd65b8f027502218b">d_etaz_crust_mantle</a>);</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ada96fe6d42f013cee8eff3d6d5396483">d_gammax_crust_mantle</a>);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a348dc7b1fa2dfa1d9b3a781738820139">d_gammay_crust_mantle</a>);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab8e81d6461b1b04617deeb952132db38">d_gammaz_crust_mantle</a>);</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac0b9eb9864c39537e161c860a8a550f5">d_ibool_crust_mantle</a>);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0d6ef87cdf2480b2e8280f635144ae5a">anisotropic_3D_mantle</a>) {</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a949afc03c8658efa0641aa0988db12dc">d_ispec_is_tiso_crust_mantle</a>);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2ae8526e691dad242929cab1f68bcff1">d_kappavstore_crust_mantle</a>);</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a25eb457a2fed340a148c1d4de5921b66">d_kappahstore_crust_mantle</a>);</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4120bec6f89dcb81eab72ab60c811503">d_muvstore_crust_mantle</a>);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a82e47572f87c54e13ee5a26fb6b132d4">d_muhstore_crust_mantle</a>);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aff0049608e4e282dd08f9172e699cb50">d_eta_anisostore_crust_mantle</a>);</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0a1c274cac4d0b253381447289f2a8e1">d_c11store_crust_mantle</a>);</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a162ebdf4b0261023b78e4bf120048aeb">d_c12store_crust_mantle</a>);</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6c0733577673683cf5ed080ff9a05a20">d_c13store_crust_mantle</a>);</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a316eb289b6d1d7962df6a3256db36906">d_c14store_crust_mantle</a>);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a04812b8c4b78841c86582c6a4c6aa6d4">d_c15store_crust_mantle</a>);</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a599961adcac4337921307c5dce650a1e">d_c16store_crust_mantle</a>);</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a5ba24b0195bf41f64a15194ad603f132">d_c22store_crust_mantle</a>);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a8021ab98bb29218f3a1de0a3e33d76">d_c23store_crust_mantle</a>);</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a75fe641c1a0fa474f4517a00545c7652">d_c24store_crust_mantle</a>);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aca1f642fe526cfd357cc5240f68e0863">d_c25store_crust_mantle</a>);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed16cea62e3086eb499aaedb26ad7dfc">d_c26store_crust_mantle</a>);</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a92e906caafa02d3b219ea330f9466031">d_c33store_crust_mantle</a>);</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2e6fb83ecd9001f5d664ec0839f57972">d_c34store_crust_mantle</a>);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0862a18cddae6423e721dacab974e93e">d_c35store_crust_mantle</a>);</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9d76cbf3c6992debc5b0e70890fb2f49">d_c36store_crust_mantle</a>);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7c4e8b67ff8de9093172a2a3e45e7939">d_c44store_crust_mantle</a>);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0b282d32b6d427c499cf614c4701390c">d_c45store_crust_mantle</a>);</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a32d4d6fdda9286ae349655e14183f22c">d_c46store_crust_mantle</a>);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0a443e256fbf33b2286fda44d44b407a">d_c55store_crust_mantle</a>);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ace6dc60fb69bc859412f317d881bf4b6">d_c56store_crust_mantle</a>);</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a859a2daf33c0b38f58a4523d6c271ba5">d_c66store_crust_mantle</a>);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  }</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3 &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad42e27d6a609002565b3c2abf70e4892">save_boundary_mesh</a>) {</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6877d2f44d16a79b0c994c54504a00a9">d_rhostore_crust_mantle</a>);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;  }</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aac9468750f58d853dcb09489c956ad0c">d_rstore_crust_mantle</a>);</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa10bf105c51c215544cbe200e00897d2">d_phase_ispec_inner_crust_mantle</a>);</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3e656f2ee4180330a0ae335324d94e17">d_ibelm_bottom_crust_mantle</a>);</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  <span class="comment">// wavefield</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab944aeffdd9acbb80123c2aaecff98cb">d_displ_crust_mantle</a>);</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ade04d8d40a6a2050d24369d9b99c410b">d_veloc_crust_mantle</a>);</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a47bd672e294029e6af28a5bee6ee2c56">d_accel_crust_mantle</a>);</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a56f9e57b568ede45123c606ddfbb407e">d_b_displ_crust_mantle</a>);</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ab21c4ab0bd96eda84f605fc883f3825b">d_b_veloc_crust_mantle</a>);</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3dd23b6d77afcfeba48b12164a8fb6fe">d_b_accel_crust_mantle</a>);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;  }</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;  <span class="comment">// mass matrix</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8a0a398578bd14189dbf513e910b9802">d_rmassz_crust_mantle</a>);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <span class="keywordflow">if</span> (*NCHUNKS_VAL != 6 &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a72f2accdd148d23c3d3fbd5d486fe87b">absorbing_conditions</a>) {</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae7b2a53ca55badab06155f4e0892775c">d_rmassx_crust_mantle</a>);</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a49b82d07189347243be39b7f3ac673ac">d_rmassy_crust_mantle</a>);</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;  }</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  <span class="comment">// kernel simulations</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a> &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">exact_mass_matrix_for_rotation</a>) {</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad9a41b549ef236a06e10a96992787a22">d_b_rmassx_crust_mantle</a>);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae64b00249134a94e0f1c542c2a67b8e1">d_b_rmassy_crust_mantle</a>);</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    }</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <span class="comment">// kernels</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3afb06a4b056fa58dce2f637d3f7f099">d_rho_kl_crust_mantle</a>);</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    <span class="keywordflow">if</span> (!mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6efbdbbf072565c01800e39dee48cae6">anisotropic_kl</a>) {</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae8caf49682d13f5bc717e0e57243e257">d_alpha_kl_crust_mantle</a>);</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a69fb33bf716b90b1961381ac440e2f97">d_beta_kl_crust_mantle</a>);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae16c1bcebb2111e6fda79f0a4efcaa8c">d_cijkl_kl_crust_mantle</a>);</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    }</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abf5df7ac66d415133867fae752f5b52e">approximate_hess_kl</a>) {</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac3cd4e1e4e0741f411def3c206bffa6f">d_hess_kl_crust_mantle</a>);</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    }</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;  }</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  <span class="comment">// outer_core</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a14fd55b5867c389cf8eaa4cddc762414">d_xix_outer_core</a>);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#acf669d6085c50bd730e42c4f53047db9">d_xiy_outer_core</a>);</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a8c5db60f71e9bb39efc472ca2082b56c">d_xiz_outer_core</a>);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac0ff5de95c752a3189d31caa4e706abf">d_etax_outer_core</a>);</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abb4c25f21ec2ed043cf83c604f2614fc">d_etay_outer_core</a>);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a738d24d6134b050eb391132067af7798">d_etaz_outer_core</a>);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aad2a78ccebd992954ad9b469e3249096">d_gammax_outer_core</a>);</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0cde8155ceae21df90dfd8765f9088cd">d_gammay_outer_core</a>);</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aae418083893e4d5380e5d70dfa866216">d_gammaz_outer_core</a>);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac8bd28eb81b8d941cce99742fb50c477">d_kappavstore_outer_core</a>);</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac9d70f575e0ea3105d11764317e9ae6d">d_rhostore_outer_core</a>);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  }</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a554e81001ff33f78ee750dd113107090">d_ibool_outer_core</a>);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a59227309ceb61cdc13d211ac2ca5cfe6">d_rstore_outer_core</a>);</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a072bba99783be461d8b275af3bf203b0">d_phase_ispec_inner_outer_core</a>);</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a480e776746f641eb54b841c95b8d58d7">d_ibelm_top_outer_core</a>);</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22453488c9229e180dc8449ac09bb98">d_jacobian2D_top_outer_core</a>);</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aa2d5a81904111e4af763e904d2557b97">d_normal_top_outer_core</a>);</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af8362e581318c8faf5265f30196c08f4">d_ibelm_bottom_outer_core</a>);</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a82737fe68b0f2360c5f41419d5e06128">d_normal_bottom_outer_core</a>);</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac031dcf07c1303b85cf7ed8ab7296a46">d_jacobian2D_bottom_outer_core</a>);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;  <span class="comment">// wavefield</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a776d223b1578c8625d0190f848eebfc2">d_displ_outer_core</a>);</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2741c23333476745f033741e5d4c2ff2">d_veloc_outer_core</a>);</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a614e141074294d6b0f21efd963d082ee">d_accel_outer_core</a>);</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a7fba1361e9c8f55e7c30c9ab1771ceca">d_b_displ_outer_core</a>);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a68ec59ad595287935c7e02fdda8e5913">d_b_veloc_outer_core</a>);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad29bca98750a15b4851199271753c0ae">d_b_accel_outer_core</a>);</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;  }</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;  <span class="comment">// mass matrix</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaba3efd3edea77cea2253be81c45e3d5">d_rmass_outer_core</a>);</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3a5060a75213f19a59c89c39654557ce">d_rho_kl_outer_core</a>);</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0d0410d090f288c0edc270d315e5cf94">d_alpha_kl_outer_core</a>);</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;  }</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;  <span class="comment">// inner_core</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a57e82474be8cecdbd37c380ef22148cd">d_xix_inner_core</a>);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a04f370729e3340a4e6dee2cacc96e3f6">d_xiy_inner_core</a>);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae81fd851d70948d0a2c1957a1229ce22">d_xiz_inner_core</a>);</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#abda4fa2df68a103116b077e840683b3f">d_etax_inner_core</a>);</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a23bfd0da9ad8e1eddd0ab0869a661b49">d_etay_inner_core</a>);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad9e462351ccee130beebd8093a452104">d_etaz_inner_core</a>);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a216b70fc7e57bb30a41620535beeb9df">d_gammax_inner_core</a>);</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a9240c3f4f491bba3e1d3328eec0636dd">d_gammay_inner_core</a>);</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a78d861ecd2bbc990c583afdc2cb41c7c">d_gammaz_inner_core</a>);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6e20a534dbb19cd2221e95180cbc3cbe">d_muvstore_inner_core</a>);</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;  <span class="keywordflow">if</span> (! mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ae1cec79cc3c64d136833423748e8fd8d">anisotropic_inner_core</a>) {</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a75032ae0909b2717863929ff331c6f69">d_kappavstore_inner_core</a>);</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2125fe633561ddaf329280856865ab0a">d_c11store_inner_core</a>);</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaa92f69e8383d5866cbe5f2500e1804f">d_c12store_inner_core</a>);</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a26173243f6a3b795521c5b7bb7918d86">d_c13store_inner_core</a>);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aeb15cb097eeff248ac8a5e1169f0d938">d_c33store_inner_core</a>);</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6367a6f4d15c8ddcb3ea3542b9c8ac1a">d_c44store_inner_core</a>);</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  }</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3 &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad42e27d6a609002565b3c2abf70e4892">save_boundary_mesh</a>) {</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6599701ed77716191e24bd17cf57e852">d_rhostore_inner_core</a>);</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  }</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a576ab0a536d5ac7d274abef84754d251">d_ibool_inner_core</a>);</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a47610a04930017eff8586b9cfd69cff2">d_idoubling_inner_core</a>);</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  <span class="comment">// gravity</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#add67861d6106aea8784d1998c5f1bf9d">gravity</a>) {</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74999f45582b040260ce031e39e99a18">d_rstore_inner_core</a>);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  }</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a6c0625852d8c90918dfc2aa94b5d30fe">d_phase_ispec_inner_inner_core</a>);</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aceeb1e8a077f04ed80c171801f189c34">d_ibelm_top_inner_core</a>);</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;  <span class="comment">// wavefield</span></div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#af22d056ba319fd172ad524859fa8f4a8">d_displ_inner_core</a>);</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aab0dbb2ca6a9e39ad894b04050ad654e">d_veloc_inner_core</a>);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a516bcef456f2739884b6a6291096ef35">d_accel_inner_core</a>);</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a91b628f3c31e510c04ea3ce4d7be1adb">d_b_displ_inner_core</a>);</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2a199944453a6af45db111791ae31c60">d_b_veloc_inner_core</a>);</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4e59bc60eb3d74bd40b8a844e47fe65f">d_b_accel_inner_core</a>);</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;  }</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;  <span class="comment">// mass matrix</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4a3991d9942ffeceaf8ea5cb2610fcd9">d_rmassz_inner_core</a>);</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a> &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">exact_mass_matrix_for_rotation</a>) {</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a93add741cbc781355cc64d0ab97a8de2">d_rmassx_inner_core</a>);</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a2ed941cb43ecb5700fb7ac6e8e752479">d_rmassy_inner_core</a>);</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;  }</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;  <span class="comment">// kernel simulations</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">simulation_type</a> == 3) {</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">rotation</a> &amp;&amp; mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">exact_mass_matrix_for_rotation</a>) {</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a4aae6e672ec4f1be740c01216edf04bf">d_b_rmassx_inner_core</a>);</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad93bb2712679b6d2c5c8a1eba0911244">d_b_rmassy_inner_core</a>);</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    }</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    <span class="comment">// kernels</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a0c6822d0bce7e7064fbc10c13750b9e5">d_rho_kl_inner_core</a>);</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aed265b02678db7ffacf67141712fe50f">d_alpha_kl_inner_core</a>);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#aaf14856a459a08f33ded6e6664a2d257">d_beta_kl_inner_core</a>);</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  }</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  <span class="comment">// oceans</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;  <span class="comment">//------------------------------------------</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  <span class="keywordflow">if</span> (mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#a3238ddad7629b5a91162df8e7159a453">oceans</a>) {</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad24a72ca9672db527b9c1a700ce8f756">d_ibool_ocean_load</a>);</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ad8a9491459c9cc04902ffd755f3bd66f">d_rmass_ocean_load</a>);</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a> (&amp;mp-&gt;<a class="code" href="../../d2/d88/structmesh__.html#ac8d8c983bcbf5cf8bc73800e91a9a584">d_normal_ocean_load</a>);</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;  }</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_FIELDS</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    clReleaseMemObject (mp-&gt;d_displ_cm_tex);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    clReleaseMemObject (mp-&gt;d_accel_cm_tex);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    clReleaseMemObject (mp-&gt;d_b_displ_cm_tex);</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    clReleaseMemObject (mp-&gt;d_b_accel_cm_tex);</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    clReleaseMemObject (mp-&gt;d_displ_oc_tex);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;    clReleaseMemObject (mp-&gt;d_accel_oc_tex);</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    clReleaseMemObject (mp-&gt;d_b_displ_oc_tex);</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    clReleaseMemObject (mp-&gt;d_b_accel_oc_tex);</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;    clReleaseMemObject (mp-&gt;d_displ_ic_tex);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    clReleaseMemObject (mp-&gt;d_accel_ic_tex);</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    clReleaseMemObject (mp-&gt;d_b_displ_ic_tex);</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    clReleaseMemObject (mp-&gt;d_b_accel_ic_tex);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;<span class="preprocessor">#ifdef USE_TEXTURES_CONSTANTS</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    clReleaseMemObject (mp-&gt;d_hprime_xx_cm_tex);</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    clReleaseMemObject (mp-&gt;d_hprimewgll_xx_cm_tex);</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  }</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  <span class="comment">// synchronizes device</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#a8188c1c360944920584b2a0a1f9bf8ac">gpuSynchronize</a>();</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  <span class="comment">// cleans up asynchronous streams/queues</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) {</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="comment">// cleans up queues</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    clReleaseCommandQueue (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">command_queue</a>);</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) clReleaseCommandQueue (<a class="code" href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a>.<a class="code" href="../../d9/df0/struct__mesh__opencl.html#a5a151439ee2627fa5d7fce0e31273617">copy_queue</a>);</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  }</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="preprocessor">#ifdef USE_CUDA</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a>) {</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    cudaStreamDestroy(mp-&gt;compute_stream);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a>) cudaStreamDestroy(mp-&gt;copy_stream);</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;  }</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  <span class="comment">// specific OpenCL: frees kernels and programs</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;<span class="preprocessor">#ifdef USE_OPENCL</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a>) release_kernels();</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;  <span class="comment">// releases previous contexts</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;  <a class="code" href="../../dd/de1/helper__functions__gpu_8c.html#aa07a58e7b163d2a0a1e02957218dedd2">gpuReset</a>();</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  <span class="comment">// mesh pointer - not needed anymore</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;  free (mp);</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;}</div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a732bb327ddd85780293be67b67600cd6"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a732bb327ddd85780293be67b67600cd6">create_regions_mesh_par2::c16store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c16store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_abf5df7ac66d415133867fae752f5b52e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#abf5df7ac66d415133867fae752f5b52e">mesh_::approximate_hess_kl</a></div><div class="ttdeci">int approximate_hess_kl</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00736">mesh_constants_gpu.h:736</a></div></div>
<div class="ttc" id="structmesh___html_ad93bb2712679b6d2c5c8a1eba0911244"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad93bb2712679b6d2c5c8a1eba0911244">mesh_::d_b_rmassy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_rmassy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00594">mesh_constants_gpu.h:594</a></div></div>
<div class="ttc" id="structmesh___html_a8d022c01dc285d81a6f2f609b05aebd4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8d022c01dc285d81a6f2f609b05aebd4">mesh_::d_epsilondev_xy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_xy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00465">mesh_constants_gpu.h:465</a></div></div>
<div class="ttc" id="mesh__constants__ocl_8h_html_afc6e336d754e00565c61340142e259c0"><div class="ttname"><a href="../../dc/d29/mesh__constants__ocl_8h.html#afc6e336d754e00565c61340142e259c0">clCheck</a></div><div class="ttdeci">#define clCheck(to_check)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d29/mesh__constants__ocl_8h_source.html#l00100">mesh_constants_ocl.h:100</a></div></div>
<div class="ttc" id="structmesh___html_ab2860282b6465c331133a8faa40c3868"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab2860282b6465c331133a8faa40c3868">mesh_::nspec2D_top_outer_core</a></div><div class="ttdeci">int nspec2D_top_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00549">mesh_constants_gpu.h:549</a></div></div>
<div class="ttc" id="structmesh___html_ad72bc437a1b6e31d51c90b21d395a894"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad72bc437a1b6e31d51c90b21d395a894">mesh_::d_adj_sourcearrays</a></div><div class="ttdeci">gpu_realw_mem d_adj_sourcearrays</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00794">mesh_constants_gpu.h:794</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a6ef57bfdc50bca92a882a93d040c5701"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a6ef57bfdc50bca92a882a93d040c5701">GPU_ERROR_CHECKING</a></div><div class="ttdeci">#define GPU_ERROR_CHECKING(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00127">mesh_constants_gpu.h:127</a></div></div>
<div class="ttc" id="structmesh___html_aa485a6b10d9716d20c4b06dc8ea8c5e5"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa485a6b10d9716d20c4b06dc8ea8c5e5">mesh_::h_b_send_accel_buffer_cm</a></div><div class="ttdeci">float * h_b_send_accel_buffer_cm</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00927">mesh_constants_gpu.h:927</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_ab033e54a75c99f91774a713597fc575e"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#ab033e54a75c99f91774a713597fc575e">gpuMalloc_int</a></div><div class="ttdeci">void gpuMalloc_int(gpu_int_mem *buffer, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00332">helper_functions_gpu.c:332</a></div></div>
<div class="ttc" id="structmesh___html_a82737fe68b0f2360c5f41419d5e06128"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a82737fe68b0f2360c5f41419d5e06128">mesh_::d_normal_bottom_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_normal_bottom_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00561">mesh_constants_gpu.h:561</a></div></div>
<div class="ttc" id="structmesh___html_a599961adcac4337921307c5dce650a1e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a599961adcac4337921307c5dce650a1e">mesh_::d_c16store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c16store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00420">mesh_constants_gpu.h:420</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a4f81050333e0c57f60b59ed7374c18b9"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a4f81050333e0c57f60b59ed7374c18b9">specfem_par_crustmantle::nimin_crust_mantle</a></div><div class="ttdeci">integer, dimension(:,:), allocatable nimin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00599">specfem3D_par.F90:599</a></div></div>
<div class="ttc" id="namespacempi__outer__core__par_html_aeee98a9cb86339598d5c4ec85231b35d"><div class="ttname"><a href="../../d0/d26/namespacempi__outer__core__par.html#aeee98a9cb86339598d5c4ec85231b35d">mpi_outer_core_par::max_nibool_interfaces_oc</a></div><div class="ttdeci">integer max_nibool_interfaces_oc</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00590">meshfem3D_par.f90:590</a></div></div>
<div class="ttc" id="structmesh___html_a4ab78b34ac901bf210a4646093964370"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4ab78b34ac901bf210a4646093964370">mesh_::d_nibool_interfaces_inner_core</a></div><div class="ttdeci">gpu_int_mem d_nibool_interfaces_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00816">mesh_constants_gpu.h:816</a></div></div>
<div class="ttc" id="structmesh___html_aa2d937997815bc4f6bf6d5e78d367933"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa2d937997815bc4f6bf6d5e78d367933">mesh_::d_jacobian2D_top_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_top_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00912">mesh_constants_gpu.h:912</a></div></div>
<div class="ttc" id="structmesh___html_a31ead77ca0a77f247fa9fdb406e4dd56"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a31ead77ca0a77f247fa9fdb406e4dd56">mesh_::d_epsilondev_xz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_xz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00640">mesh_constants_gpu.h:640</a></div></div>
<div class="ttc" id="struct__mesh__opencl_html_a4ed017f515e59a2a131a30dc32ce0465"><div class="ttname"><a href="../../d9/df0/struct__mesh__opencl.html#a4ed017f515e59a2a131a30dc32ce0465">_mesh_opencl::context</a></div><div class="ttdeci">cl_context context</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d29/mesh__constants__ocl_8h_source.html#l00140">mesh_constants_ocl.h:140</a></div></div>
<div class="ttc" id="structmesh___html_ab16d7257d92a7cb9b29d1b461843db63"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab16d7257d92a7cb9b29d1b461843db63">mesh_::nspec2D_xmax_crust_mantle</a></div><div class="ttdeci">int nspec2D_xmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00834">mesh_constants_gpu.h:834</a></div></div>
<div class="ttc" id="structmesh___html_a9f4a8ed1b49615e5853a8df2c1f9962c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a9f4a8ed1b49615e5853a8df2c1f9962c">mesh_::num_colors_outer_inner_core</a></div><div class="ttdeci">int num_colors_outer_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00666">mesh_constants_gpu.h:666</a></div></div>
<div class="ttc" id="structmesh___html_a6e20a534dbb19cd2221e95180cbc3cbe"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6e20a534dbb19cd2221e95180cbc3cbe">mesh_::d_muvstore_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_muvstore_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00588">mesh_constants_gpu.h:588</a></div></div>
<div class="ttc" id="structmesh___html_a0d6ef87cdf2480b2e8280f635144ae5a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0d6ef87cdf2480b2e8280f635144ae5a">mesh_::anisotropic_3D_mantle</a></div><div class="ttdeci">int anisotropic_3D_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00727">mesh_constants_gpu.h:727</a></div></div>
<div class="ttc" id="structmesh___html_a2a94497e687bfcaf659677bea2b41705"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2a94497e687bfcaf659677bea2b41705">mesh_::d_ibelm_ymin_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ibelm_ymin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00846">mesh_constants_gpu.h:846</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a7dc43de575127bf996b15885aae7d364"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a7dc43de575127bf996b15885aae7d364">create_regions_mesh_par2::c14store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c14store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_ae519e498ca8126979e0db0cd12401f8d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae519e498ca8126979e0db0cd12401f8d">mesh_::d_Sigma_kl</a></div><div class="ttdeci">gpu_realw_mem d_Sigma_kl</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00915">mesh_constants_gpu.h:915</a></div></div>
<div class="ttc" id="structmesh___html_a042606a2b56dcc00d30e9d9c26a80d12"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a042606a2b56dcc00d30e9d9c26a80d12">mesh_::nspec2D_ymax_outer_core</a></div><div class="ttdeci">int nspec2D_ymax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00868">mesh_constants_gpu.h:868</a></div></div>
<div class="ttc" id="structmesh___html_af15850cf201bf9ceea045d775045f674"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af15850cf201bf9ceea045d775045f674">mesh_::d_b_betaval</a></div><div class="ttdeci">gpu_realw_mem d_b_betaval</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00689">mesh_constants_gpu.h:689</a></div></div>
<div class="ttc" id="structmesh___html_ad7d379e75cd23c21405ca7b28eff414a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad7d379e75cd23c21405ca7b28eff414a">mesh_::d_b_epsilondev_xz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_xz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00646">mesh_constants_gpu.h:646</a></div></div>
<div class="ttc" id="structmesh___html_a521202fdc8f532221b5d3bb511f3da11"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a521202fdc8f532221b5d3bb511f3da11">mesh_::d_wgllwgll_xz</a></div><div class="ttdeci">gpu_realw_mem d_wgllwgll_xz</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00706">mesh_constants_gpu.h:706</a></div></div>
<div class="ttc" id="structmesh___html_ac0ff5de95c752a3189d31caa4e706abf"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac0ff5de95c752a3189d31caa4e706abf">mesh_::d_etax_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_etax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00509">mesh_constants_gpu.h:509</a></div></div>
<div class="ttc" id="structmesh___html_aceeb1e8a077f04ed80c171801f189c34"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aceeb1e8a077f04ed80c171801f189c34">mesh_::d_ibelm_top_inner_core</a></div><div class="ttdeci">gpu_int_mem d_ibelm_top_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00669">mesh_constants_gpu.h:669</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a70841e1d47341e69bd19ceba6d0b467d"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a70841e1d47341e69bd19ceba6d0b467d">gpuCreateCopy_todevice_realw</a></div><div class="ttdeci">void gpuCreateCopy_todevice_realw(gpu_realw_mem *d_array_addr_ptr, realw *h_array, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00168">helper_functions_gpu.c:168</a></div></div>
<div class="ttc" id="structmesh___html_aed265b02678db7ffacf67141712fe50f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aed265b02678db7ffacf67141712fe50f">mesh_::d_alpha_kl_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_alpha_kl_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00654">mesh_constants_gpu.h:654</a></div></div>
<div class="ttc" id="structmesh___html_af22d60235f9a92926b4db648eb5bf464"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af22d60235f9a92926b4db648eb5bf464">mesh_::d_b_gammaval</a></div><div class="ttdeci">gpu_realw_mem d_b_gammaval</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00690">mesh_constants_gpu.h:690</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a494d31903e7b0333dfa03b0778679113"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a494d31903e7b0333dfa03b0778679113">TRACE</a></div><div class="ttdeci">#define TRACE(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00076">mesh_constants_gpu.h:76</a></div></div>
<div class="ttc" id="structmesh___html_a6baad7ef1ad9769ac7fb321bd7c15069"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6baad7ef1ad9769ac7fb321bd7c15069">mesh_::minus_g_icb</a></div><div class="ttdeci">realw minus_g_icb</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00750">mesh_constants_gpu.h:750</a></div></div>
<div class="ttc" id="structmesh___html_abb029b9b141eef7ab53da75594ca92be"><div class="ttname"><a href="../../d2/d88/structmesh__.html#abb029b9b141eef7ab53da75594ca92be">mesh_::d_absorb_ymin_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_absorb_ymin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00861">mesh_constants_gpu.h:861</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a5abac66045579516f192d37e579907f4"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a5abac66045579516f192d37e579907f4">NGLL3_PADDED</a></div><div class="ttdeci">#define NGLL3_PADDED</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00147">mesh_constants_gpu.h:147</a></div></div>
<div class="ttc" id="structmesh___html_a6788199e4725eea124255033aa5ec505"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6788199e4725eea124255033aa5ec505">mesh_::nspec2D_bottom_outer_core</a></div><div class="ttdeci">int nspec2D_bottom_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00550">mesh_constants_gpu.h:550</a></div></div>
<div class="ttc" id="structmesh___html_a720c153b4667a50f70c05dc14b212af0"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a720c153b4667a50f70c05dc14b212af0">mesh_::NGLOB_INNER_CORE</a></div><div class="ttdeci">int NGLOB_INNER_CORE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00571">mesh_constants_gpu.h:571</a></div></div>
<div class="ttc" id="structmesh___html_a8a0a398578bd14189dbf513e910b9802"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8a0a398578bd14189dbf513e910b9802">mesh_::d_rmassz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_rmassz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00402">mesh_constants_gpu.h:402</a></div></div>
<div class="ttc" id="structmesh___html_a7bd4681d488cb7929ea7f7a44d98a7f2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a7bd4681d488cb7929ea7f7a44d98a7f2">mesh_::h_station_seismo_field</a></div><div class="ttdeci">realw * h_station_seismo_field</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00787">mesh_constants_gpu.h:787</a></div></div>
<div class="ttc" id="structmesh___html_aeeedf9a38cb4978e606f65fd5d8ef456"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aeeedf9a38cb4978e606f65fd5d8ef456">mesh_::nspec_inner_inner_core</a></div><div class="ttdeci">int nspec_inner_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00662">mesh_constants_gpu.h:662</a></div></div>
<div class="ttc" id="structmesh___html_a776d223b1578c8625d0190f848eebfc2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a776d223b1578c8625d0190f848eebfc2">mesh_::d_displ_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_displ_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00531">mesh_constants_gpu.h:531</a></div></div>
<div class="ttc" id="mesh__constants__ocl_8h_html_aa51b14e9d38666d88745e3df4c7e47b6"><div class="ttname"><a href="../../dc/d29/mesh__constants__ocl_8h.html#aa51b14e9d38666d88745e3df4c7e47b6">RELEASE_PINNED_BUFFER_OCL</a></div><div class="ttdeci">#define RELEASE_PINNED_BUFFER_OCL(_buffer_)                                                                          </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d29/mesh__constants__ocl_8h_source.html#l00076">mesh_constants_ocl.h:76</a></div></div>
<div class="ttc" id="structmesh___html_abd2a0ea38bf4d5f605e88124ebed2123"><div class="ttname"><a href="../../d2/d88/structmesh__.html#abd2a0ea38bf4d5f605e88124ebed2123">mesh_::d_R_xz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_R_xz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00451">mesh_constants_gpu.h:451</a></div></div>
<div class="ttc" id="structmesh___html_a7a01ec98899aec24bbab047328fe0e23"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a7a01ec98899aec24bbab047328fe0e23">mesh_::d_nimin_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_nimin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00837">mesh_constants_gpu.h:837</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_aea72272422e24b7eba77f1cce2e4596d"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#aea72272422e24b7eba77f1cce2e4596d">specfem_par::minus_deriv_gravity_table</a></div><div class="ttdeci">double precision, dimension(nrad_gravity) minus_deriv_gravity_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00255">specfem3D_par.F90:255</a></div></div>
<div class="ttc" id="structmesh___html_af27051c86fee76f55b1aaadfdc487d44"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af27051c86fee76f55b1aaadfdc487d44">mesh_::nspec_inner_outer_core</a></div><div class="ttdeci">int nspec_inner_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00548">mesh_constants_gpu.h:548</a></div></div>
<div class="ttc" id="namespacempi__crust__mantle__par_html_a835b5c9f5ff86d72cc5d102a8ccb7d01"><div class="ttname"><a href="../../d7/d1e/namespacempi__crust__mantle__par.html#a835b5c9f5ff86d72cc5d102a8ccb7d01">mpi_crust_mantle_par::num_interfaces_crust_mantle</a></div><div class="ttdeci">integer num_interfaces_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00467">meshfem3D_par.f90:467</a></div></div>
<div class="ttc" id="structmesh___html_aaa92f69e8383d5866cbe5f2500e1804f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aaa92f69e8383d5866cbe5f2500e1804f">mesh_::d_c12store_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_c12store_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00606">mesh_constants_gpu.h:606</a></div></div>
<div class="ttc" id="structmesh___html_a85540618f50dca95bdbd7eda1eb80916"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a85540618f50dca95bdbd7eda1eb80916">mesh_::h_b_recv_accel_buffer_ic</a></div><div class="ttdeci">float * h_b_recv_accel_buffer_ic</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00934">mesh_constants_gpu.h:934</a></div></div>
<div class="ttc" id="structmesh___html_a2a228cd6822e22e73e757666ae371a57"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2a228cd6822e22e73e757666ae371a57">mesh_::nspec2D_xmax_outer_core</a></div><div class="ttdeci">int nspec2D_xmax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00867">mesh_constants_gpu.h:867</a></div></div>
<div class="ttc" id="structmesh___html_a57e82474be8cecdbd37c380ef22148cd"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a57e82474be8cecdbd37c380ef22148cd">mesh_::d_xix_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_xix_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00575">mesh_constants_gpu.h:575</a></div></div>
<div class="ttc" id="structmesh___html_a2f75e1ea687c10ba2be829306146bc07"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2f75e1ea687c10ba2be829306146bc07">mesh_::attenuation</a></div><div class="ttdeci">int attenuation</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00721">mesh_constants_gpu.h:721</a></div></div>
<div class="ttc" id="structmesh___html_a7c4e8b67ff8de9093172a2a3e45e7939"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a7c4e8b67ff8de9093172a2a3e45e7939">mesh_::d_c44store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c44store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00430">mesh_constants_gpu.h:430</a></div></div>
<div class="ttc" id="structmesh___html_aca1f642fe526cfd357cc5240f68e0863"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aca1f642fe526cfd357cc5240f68e0863">mesh_::d_c25store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c25store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00424">mesh_constants_gpu.h:424</a></div></div>
<div class="ttc" id="structmesh___html_a82e47572f87c54e13ee5a26fb6b132d4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a82e47572f87c54e13ee5a26fb6b132d4">mesh_::d_muhstore_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_muhstore_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00396">mesh_constants_gpu.h:396</a></div></div>
<div class="ttc" id="structmesh___html_a6c0625852d8c90918dfc2aa94b5d30fe"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6c0625852d8c90918dfc2aa94b5d30fe">mesh_::d_phase_ispec_inner_inner_core</a></div><div class="ttdeci">gpu_int_mem d_phase_ispec_inner_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00658">mesh_constants_gpu.h:658</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_a3ca8b9344966daaff04fd2e497481167"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#a3ca8b9344966daaff04fd2e497481167">specfem_par_outercore::nimin_outer_core</a></div><div class="ttdeci">integer, dimension(:,:), allocatable nimin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00847">specfem3D_par.F90:847</a></div></div>
<div class="ttc" id="structmesh___html_a4c3b7504c2164627800c2e02afe8347e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4c3b7504c2164627800c2e02afe8347e">mesh_::d_b_B_array_rotation</a></div><div class="ttdeci">gpu_realw_mem d_b_B_array_rotation</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00766">mesh_constants_gpu.h:766</a></div></div>
<div class="ttc" id="structmesh___html_aff0049608e4e282dd08f9172e699cb50"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aff0049608e4e282dd08f9172e699cb50">mesh_::d_eta_anisostore_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_eta_anisostore_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00397">mesh_constants_gpu.h:397</a></div></div>
<div class="ttc" id="structmesh___html_a59227309ceb61cdc13d211ac2ca5cfe6"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a59227309ceb61cdc13d211ac2ca5cfe6">mesh_::d_rstore_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_rstore_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00527">mesh_constants_gpu.h:527</a></div></div>
<div class="ttc" id="struct__mesh__opencl_html_a4e1e4d48b630389013bd594627ff1bdb"><div class="ttname"><a href="../../d9/df0/struct__mesh__opencl.html#a4e1e4d48b630389013bd594627ff1bdb">_mesh_opencl::command_queue</a></div><div class="ttdeci">cl_command_queue command_queue</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d29/mesh__constants__ocl_8h_source.html#l00138">mesh_constants_ocl.h:138</a></div></div>
<div class="ttc" id="structmesh___html_a1793ff103290e8c06c17d4ccc24c924a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a1793ff103290e8c06c17d4ccc24c924a">mesh_::d_noise_sourcearray</a></div><div class="ttdeci">gpu_realw_mem d_noise_sourcearray</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00902">mesh_constants_gpu.h:902</a></div></div>
<div class="ttc" id="structmesh___html_ad9a41b549ef236a06e10a96992787a22"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad9a41b549ef236a06e10a96992787a22">mesh_::d_b_rmassx_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_rmassx_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00403">mesh_constants_gpu.h:403</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_ac947b1846fdd4c58c9ee9455d0f76ed3"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#ac947b1846fdd4c58c9ee9455d0f76ed3">specfem_par_innercore::factor_common_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:,:), allocatable factor_common_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00725">specfem3D_par.F90:725</a></div></div>
<div class="ttc" id="namespacempi__crust__mantle__par_html_af6edb949252c31a07d21875d1a9ebf7f"><div class="ttname"><a href="../../d7/d1e/namespacempi__crust__mantle__par.html#af6edb949252c31a07d21875d1a9ebf7f">mpi_crust_mantle_par::ibool_interfaces_crust_mantle</a></div><div class="ttdeci">integer, dimension(:,:), allocatable ibool_interfaces_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00470">meshfem3D_par.f90:470</a></div></div>
<div class="ttc" id="structmesh___html_ae87462e60db1da0aa2e3a3d27bca626d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae87462e60db1da0aa2e3a3d27bca626d">mesh_::nspec2D_ymin_outer_core</a></div><div class="ttdeci">int nspec2D_ymin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00868">mesh_constants_gpu.h:868</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_aaad41bce9a96bf9f96f4dda5f292eaa3"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#aaad41bce9a96bf9f96f4dda5f292eaa3">specfem_par_innercore::epsilondev_xy_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_xy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00731">specfem3D_par.F90:731</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a6aa349a4d68c77c7cb8053c22c69025d"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a6aa349a4d68c77c7cb8053c22c69025d">exit_on_error</a></div><div class="ttdeci">void exit_on_error(const char *info)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00731">helper_functions_gpu.c:731</a></div></div>
<div class="ttc" id="structmesh___html_a58052ea6faf38efdd2e3f6c0fb12e0ca"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a58052ea6faf38efdd2e3f6c0fb12e0ca">mesh_::d_xiy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_xiy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00382">mesh_constants_gpu.h:382</a></div></div>
<div class="ttc" id="structmesh___html_a887c3a0fd18bee41caf8c974028bc59b"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a887c3a0fd18bee41caf8c974028bc59b">mesh_::d_density_table</a></div><div class="ttdeci">gpu_realw_mem d_density_table</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00748">mesh_constants_gpu.h:748</a></div></div>
<div class="ttc" id="structmesh___html_adb4fe4d689e1b54986b21462362c6e17"><div class="ttname"><a href="../../d2/d88/structmesh__.html#adb4fe4d689e1b54986b21462362c6e17">mesh_::d_factor_common_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_factor_common_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00460">mesh_constants_gpu.h:460</a></div></div>
<div class="ttc" id="structmesh___html_a162ebdf4b0261023b78e4bf120048aeb"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a162ebdf4b0261023b78e4bf120048aeb">mesh_::d_c12store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c12store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00416">mesh_constants_gpu.h:416</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_add310657fc343aca4beb0444b63c696e"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#add310657fc343aca4beb0444b63c696e">specfem_par::d_ln_density_dr_table</a></div><div class="ttdeci">double precision, dimension(nrad_gravity) d_ln_density_dr_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00255">specfem3D_par.F90:255</a></div></div>
<div class="ttc" id="structmesh___html_a72f9f5b9ce5f0c21fb1e66eea91b6ceb"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a72f9f5b9ce5f0c21fb1e66eea91b6ceb">mesh_::d_xiz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_xiz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00383">mesh_constants_gpu.h:383</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a1081c1ea3957b4700a6b5167520e8b04"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a1081c1ea3957b4700a6b5167520e8b04">gpuInitialize_buffers</a></div><div class="ttdeci">void gpuInitialize_buffers(Mesh *mp)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00430">helper_functions_gpu.c:430</a></div></div>
<div class="ttc" id="structmesh___html_a9dc8d971c041bd9ed76db6efa94b2f95"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a9dc8d971c041bd9ed76db6efa94b2f95">mesh_::partial_phys_dispersion_only</a></div><div class="ttdeci">int partial_phys_dispersion_only</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00723">mesh_constants_gpu.h:723</a></div></div>
<div class="ttc" id="structmesh___html_a12137d1e3db2cdd7d5fcb63a7c7085e4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a12137d1e3db2cdd7d5fcb63a7c7085e4">mesh_::d_betaval</a></div><div class="ttdeci">gpu_realw_mem d_betaval</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00685">mesh_constants_gpu.h:685</a></div></div>
<div class="ttc" id="structmesh___html_ae895eecdf95d57c65b681ca43e7232d1"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae895eecdf95d57c65b681ca43e7232d1">mesh_::d_send_accel_buffer_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_send_accel_buffer_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00819">mesh_constants_gpu.h:819</a></div></div>
<div class="ttc" id="structmesh___html_a5ba24b0195bf41f64a15194ad603f132"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a5ba24b0195bf41f64a15194ad603f132">mesh_::d_c22store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c22store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00421">mesh_constants_gpu.h:421</a></div></div>
<div class="ttc" id="structmesh___html_ac3363d4581b5b00f8f94798a2b48d690"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac3363d4581b5b00f8f94798a2b48d690">mesh_::d_mask_noise</a></div><div class="ttdeci">gpu_realw_mem d_mask_noise</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00907">mesh_constants_gpu.h:907</a></div></div>
<div class="ttc" id="structmesh___html_ae8caf49682d13f5bc717e0e57243e257"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae8caf49682d13f5bc717e0e57243e257">mesh_::d_alpha_kl_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_alpha_kl_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00480">mesh_constants_gpu.h:480</a></div></div>
<div class="ttc" id="structmesh___html_a4bfeec96b6fae162cba9bcacebefbbbe"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4bfeec96b6fae162cba9bcacebefbbbe">mesh_::d_gammaval</a></div><div class="ttdeci">gpu_realw_mem d_gammaval</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00686">mesh_constants_gpu.h:686</a></div></div>
<div class="ttc" id="structmesh___html_a7f63fbf5229ca2f6879820443635bb44"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a7f63fbf5229ca2f6879820443635bb44">mesh_::h_station_strain_field</a></div><div class="ttdeci">realw * h_station_strain_field</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00790">mesh_constants_gpu.h:790</a></div></div>
<div class="ttc" id="structmesh___html_a35353d78198f805b8820aafaada5c7c4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a35353d78198f805b8820aafaada5c7c4">mesh_::d_R_yz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_R_yz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00626">mesh_constants_gpu.h:626</a></div></div>
<div class="ttc" id="structmesh___html_a4120bec6f89dcb81eab72ab60c811503"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4120bec6f89dcb81eab72ab60c811503">mesh_::d_muvstore_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_muvstore_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00394">mesh_constants_gpu.h:394</a></div></div>
<div class="ttc" id="structmesh___html_af5011e99c154470d6c0b9c5ad34e9c19"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af5011e99c154470d6c0b9c5ad34e9c19">mesh_::nspec_outer_outer_core</a></div><div class="ttdeci">int nspec_outer_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00547">mesh_constants_gpu.h:547</a></div></div>
<div class="ttc" id="structmesh___html_aa10bf105c51c215544cbe200e00897d2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa10bf105c51c215544cbe200e00897d2">mesh_::d_phase_ispec_inner_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_phase_ispec_inner_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00486">mesh_constants_gpu.h:486</a></div></div>
<div class="ttc" id="structmesh___html_aa1f641dd67cff778bce7ff8403bf06fa"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa1f641dd67cff778bce7ff8403bf06fa">mesh_::nspec2D_ymax_crust_mantle</a></div><div class="ttdeci">int nspec2D_ymax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00835">mesh_constants_gpu.h:835</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a213d1b13a2775feb345ecc1b9ad4befd"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a213d1b13a2775feb345ecc1b9ad4befd">create_regions_mesh_par2::c25store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c25store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_a3474881fb737a088d5d39aa99c60a07e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3474881fb737a088d5d39aa99c60a07e">mesh_::d_xix_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_xix_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00381">mesh_constants_gpu.h:381</a></div></div>
<div class="ttc" id="structmesh___html_a0e5b1c3e4efe36916902880ee5ee0b43"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0e5b1c3e4efe36916902880ee5ee0b43">mesh_::d_b_epsilondev_yy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_yy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00470">mesh_constants_gpu.h:470</a></div></div>
<div class="ttc" id="structmesh___html_aec5fe5c75fe1583e7b5af293a0de3b2c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aec5fe5c75fe1583e7b5af293a0de3b2c">mesh_::d_b_R_yy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_R_yy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00455">mesh_constants_gpu.h:455</a></div></div>
<div class="ttc" id="structmesh___html_ad42e27d6a609002565b3c2abf70e4892"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad42e27d6a609002565b3c2abf70e4892">mesh_::save_boundary_mesh</a></div><div class="ttdeci">int save_boundary_mesh</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00733">mesh_constants_gpu.h:733</a></div></div>
<div class="ttc" id="structmesh___html_a72f2accdd148d23c3d3fbd5d486fe87b"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a72f2accdd148d23c3d3fbd5d486fe87b">mesh_::absorbing_conditions</a></div><div class="ttdeci">int absorbing_conditions</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00718">mesh_constants_gpu.h:718</a></div></div>
<div class="ttc" id="structmesh___html_ae1c979458a0c87759b6a6bb03498b5c7"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae1c979458a0c87759b6a6bb03498b5c7">mesh_::h_b_recv_accel_buffer_cm</a></div><div class="ttdeci">float * h_b_recv_accel_buffer_cm</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00928">mesh_constants_gpu.h:928</a></div></div>
<div class="ttc" id="structmesh___html_ade386b82a626cf9fc0ef3a4a0559d04f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ade386b82a626cf9fc0ef3a4a0559d04f">mesh_::d_ibelm_xmax_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ibelm_xmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00845">mesh_constants_gpu.h:845</a></div></div>
<div class="ttc" id="namespacespecfem__par__noise_html_a0a77ca58e5baa64407977f26a2c6b3d6"><div class="ttname"><a href="../../df/daf/namespacespecfem__par__noise.html#a0a77ca58e5baa64407977f26a2c6b3d6">specfem_par_noise::normal_z_noise</a></div><div class="ttdeci">real(kind=custom_real), dimension(:), allocatable normal_z_noise</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00917">specfem3D_par.F90:917</a></div></div>
<div class="ttc" id="structmesh___html_aed16cea62e3086eb499aaedb26ad7dfc"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aed16cea62e3086eb499aaedb26ad7dfc">mesh_::d_c26store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c26store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00425">mesh_constants_gpu.h:425</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a560d12fcced6f3cbcae57d34335ed804"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a560d12fcced6f3cbcae57d34335ed804">create_regions_mesh_par2::c66store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c66store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_abda4fa2df68a103116b077e840683b3f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#abda4fa2df68a103116b077e840683b3f">mesh_::d_etax_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_etax_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00578">mesh_constants_gpu.h:578</a></div></div>
<div class="ttc" id="structmesh___html_af08c0acf55538f5408e5ef38bfec9c14"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af08c0acf55538f5408e5ef38bfec9c14">mesh_::d_wgll_cube</a></div><div class="ttdeci">gpu_realw_mem d_wgll_cube</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00708">mesh_constants_gpu.h:708</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a1c86d6711f67cc1ca7b0f986cbd9b019"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a1c86d6711f67cc1ca7b0f986cbd9b019">specfem_par_crustmantle::eps_trace_over_3_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target eps_trace_over_3_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00556">specfem3D_par.F90:556</a></div></div>
<div class="ttc" id="structmesh___html_a0824ccb340ed073cdc8b4daed03b1d02"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0824ccb340ed073cdc8b4daed03b1d02">mesh_::simulation_type</a></div><div class="ttdeci">int simulation_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00711">mesh_constants_gpu.h:711</a></div></div>
<div class="ttc" id="structmesh___html_a449222c07988fabb826b8842179d00ad"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a449222c07988fabb826b8842179d00ad">mesh_::h_num_elem_colors_crust_mantle</a></div><div class="ttdeci">int * h_num_elem_colors_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00495">mesh_constants_gpu.h:495</a></div></div>
<div class="ttc" id="structmesh___html_a78d861ecd2bbc990c583afdc2cb41c7c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a78d861ecd2bbc990c583afdc2cb41c7c">mesh_::d_gammaz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_gammaz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00583">mesh_constants_gpu.h:583</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a57bdfca4bfa372e3c9e225c6c5a9fb82"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a57bdfca4bfa372e3c9e225c6c5a9fb82">specfem_par_innercore::b_epsilondev_yy_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_yy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00742">specfem3D_par.F90:742</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_ab8acf6b7a548c8cf7f4e49e8fc995ebc"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#ab8acf6b7a548c8cf7f4e49e8fc995ebc">specfem_par::betaval</a></div><div class="ttdeci">real(kind=custom_real), dimension(n_sls) betaval</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00207">specfem3D_par.F90:207</a></div></div>
<div class="ttc" id="structmesh___html_aa11f7cabea501f93ee8eae9c62805167"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa11f7cabea501f93ee8eae9c62805167">mesh_::d_nibool_interfaces_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_nibool_interfaces_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00808">mesh_constants_gpu.h:808</a></div></div>
<div class="ttc" id="structmesh___html_ac0018c1471e2634f619072f26905de88"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac0018c1471e2634f619072f26905de88">mesh_::d_jacobian2D_xmin_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_xmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00883">mesh_constants_gpu.h:883</a></div></div>
<div class="ttc" id="structmesh___html_a34d36dff216801f1b524d9382642a2a3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a34d36dff216801f1b524d9382642a2a3">mesh_::d_ibelm_ymin_outer_core</a></div><div class="ttdeci">gpu_int_mem d_ibelm_ymin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00880">mesh_constants_gpu.h:880</a></div></div>
<div class="ttc" id="structmesh___html_a56660650b9817f854faa7ddac0509704"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a56660650b9817f854faa7ddac0509704">mesh_::minus_g_cmb</a></div><div class="ttdeci">realw minus_g_cmb</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00751">mesh_constants_gpu.h:751</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_a0e2c01157da6742a87f9d4b0c8d393fe"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#a0e2c01157da6742a87f9d4b0c8d393fe">specfem_par_outercore::ibelm_xmin_outer_core</a></div><div class="ttdeci">integer, dimension(:), allocatable ibelm_xmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00862">specfem3D_par.F90:862</a></div></div>
<div class="ttc" id="namespacempi__outer__core__par_html_af220e6bd457430198bc9c2d0f5a1c69a"><div class="ttname"><a href="../../d0/d26/namespacempi__outer__core__par.html#af220e6bd457430198bc9c2d0f5a1c69a">mpi_outer_core_par::num_interfaces_outer_core</a></div><div class="ttdeci">integer num_interfaces_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00589">meshfem3D_par.f90:589</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_ad009abf4d7e24545954b35f38b2193ae"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#ad009abf4d7e24545954b35f38b2193ae">N_SLS</a></div><div class="ttdeci">#define N_SLS</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00152">mesh_constants_gpu.h:152</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a41597654ab442f9228f6f2226a8d8998"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a41597654ab442f9228f6f2226a8d8998">create_regions_mesh_par2::c13store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c13store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a76119f983855d9e8873791d01b79df64"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a76119f983855d9e8873791d01b79df64">specfem_par_crustmantle::epsilondev_yy_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_yy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00552">specfem3D_par.F90:552</a></div></div>
<div class="ttc" id="structmesh___html_a0bb8ee2d74ebaeb68e0d54005e48c310"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0bb8ee2d74ebaeb68e0d54005e48c310">mesh_::d_absorb_xmin_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_absorb_xmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00859">mesh_constants_gpu.h:859</a></div></div>
<div class="ttc" id="structmesh___html_ada96fe6d42f013cee8eff3d6d5396483"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ada96fe6d42f013cee8eff3d6d5396483">mesh_::d_gammax_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_gammax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00387">mesh_constants_gpu.h:387</a></div></div>
<div class="ttc" id="structmesh___html_acf09f07450524877347548fdb88ffd22"><div class="ttname"><a href="../../d2/d88/structmesh__.html#acf09f07450524877347548fdb88ffd22">mesh_::nspec2D_ymin_crust_mantle</a></div><div class="ttdeci">int nspec2D_ymin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00835">mesh_constants_gpu.h:835</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a65faffef391fb2a2b3a60fd0bee3b517"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a65faffef391fb2a2b3a60fd0bee3b517">create_regions_mesh_par2::c44store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c44store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_accfb22fccbb7ddc7db535858481d41a2"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#accfb22fccbb7ddc7db535858481d41a2">specfem_par_crustmantle::one_minus_sum_beta_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable one_minus_sum_beta_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00544">specfem3D_par.F90:544</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a9f379a3538eda57a62dca8839eaa8ede"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a9f379a3538eda57a62dca8839eaa8ede">specfem_par::nrec_local</a></div><div class="ttdeci">integer nrec_local</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00283">specfem3D_par.F90:283</a></div></div>
<div class="ttc" id="structmesh___html_afe49023b8454b69b83f7f2d83bbf8f04"><div class="ttname"><a href="../../d2/d88/structmesh__.html#afe49023b8454b69b83f7f2d83bbf8f04">mesh_::d_b_R_xx_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_R_xx_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00454">mesh_constants_gpu.h:454</a></div></div>
<div class="ttc" id="structmesh___html_a8c5db60f71e9bb39efc472ca2082b56c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8c5db60f71e9bb39efc472ca2082b56c">mesh_::d_xiz_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_xiz_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00508">mesh_constants_gpu.h:508</a></div></div>
<div class="ttc" id="structmesh___html_a1821a18962267bd254d7ef3ae6d762df"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a1821a18962267bd254d7ef3ae6d762df">mesh_::nspec2D_top_inner_core</a></div><div class="ttdeci">int nspec2D_top_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00663">mesh_constants_gpu.h:663</a></div></div>
<div class="ttc" id="structmesh___html_ae67d8ce2ec9fb40cc53aaa08d51a9a91"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae67d8ce2ec9fb40cc53aaa08d51a9a91">mesh_::d_epsilondev_xy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_xy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00639">mesh_constants_gpu.h:639</a></div></div>
<div class="ttc" id="structmesh___html_ae4c74710535027d0060b48e4f7c25908"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae4c74710535027d0060b48e4f7c25908">mesh_::d_b_epsilondev_xx_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_xx_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00643">mesh_constants_gpu.h:643</a></div></div>
<div class="ttc" id="structmesh___html_af0c9213bf0c4b841746b5a76c549ba66"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af0c9213bf0c4b841746b5a76c549ba66">mesh_::nspec2D_top_crust_mantle</a></div><div class="ttdeci">int nspec2D_top_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00910">mesh_constants_gpu.h:910</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a52fe1cf5a65aaeaa8274a8c0d8eb4e9b"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a52fe1cf5a65aaeaa8274a8c0d8eb4e9b">specfem_par_crustmantle::normal_ymax_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable normal_ymax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00587">specfem3D_par.F90:587</a></div></div>
<div class="ttc" id="structmesh___html_a91b628f3c31e510c04ea3ce4d7be1adb"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a91b628f3c31e510c04ea3ce4d7be1adb">mesh_::d_b_displ_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_displ_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00617">mesh_constants_gpu.h:617</a></div></div>
<div class="ttc" id="structmesh___html_aa020a4e27290b96ff34aa0efb2c0ec23"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa020a4e27290b96ff34aa0efb2c0ec23">mesh_::d_number_receiver_global</a></div><div class="ttdeci">gpu_int_mem d_number_receiver_global</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00780">mesh_constants_gpu.h:780</a></div></div>
<div class="ttc" id="structmesh___html_ad498f1e815ea41528f72120ddb7533e3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad498f1e815ea41528f72120ddb7533e3">mesh_::d_b_R_xz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_R_xz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00631">mesh_constants_gpu.h:631</a></div></div>
<div class="ttc" id="structmesh___html_a9240c3f4f491bba3e1d3328eec0636dd"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a9240c3f4f491bba3e1d3328eec0636dd">mesh_::d_gammay_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_gammay_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00582">mesh_constants_gpu.h:582</a></div></div>
<div class="ttc" id="structmesh___html_a62a91a122e4e1ffc161b17d7c088fcae"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a62a91a122e4e1ffc161b17d7c088fcae">mesh_::d_one_minus_sum_beta_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_one_minus_sum_beta_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00635">mesh_constants_gpu.h:635</a></div></div>
<div class="ttc" id="structmesh___html_a75032ae0909b2717863929ff331c6f69"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a75032ae0909b2717863929ff331c6f69">mesh_::d_kappavstore_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_kappavstore_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00587">mesh_constants_gpu.h:587</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a686e0cade6b09290c835a7d39ee977c3"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a686e0cade6b09290c835a7d39ee977c3">specfem_par_innercore::epsilondev_xx_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_xx_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00731">specfem3D_par.F90:731</a></div></div>
<div class="ttc" id="structmesh___html_a09eb492400d963c10b7aae75d651938c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a09eb492400d963c10b7aae75d651938c">mesh_::nadj_rec_local</a></div><div class="ttdeci">int nadj_rec_local</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00793">mesh_constants_gpu.h:793</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a38b32e638a9586e79e6a82c60461ce5f"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a38b32e638a9586e79e6a82c60461ce5f">specfem_par::nrec</a></div><div class="ttdeci">integer nrec</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00283">specfem3D_par.F90:283</a></div></div>
<div class="ttc" id="structmesh___html_a9f652523eeebae4f18f68dd4430f5c44"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a9f652523eeebae4f18f68dd4430f5c44">mesh_::d_nkmin_xi_outer_core</a></div><div class="ttdeci">gpu_int_mem d_nkmin_xi_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00875">mesh_constants_gpu.h:875</a></div></div>
<div class="ttc" id="structmesh___html_a2ed941cb43ecb5700fb7ac6e8e752479"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2ed941cb43ecb5700fb7ac6e8e752479">mesh_::d_rmassy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_rmassy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00591">mesh_constants_gpu.h:591</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_aacf3b947adf6ba386b4f306aee09cd77"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#aacf3b947adf6ba386b4f306aee09cd77">realw</a></div><div class="ttdeci">float realw</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00063">mesh_constants_gpu.h:63</a></div></div>
<div class="ttc" id="structmesh___html_aa07d13732521f9b75c5786b65ea865f8"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa07d13732521f9b75c5786b65ea865f8">mesh_::d_jacobian2D_ymin_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_ymin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00856">mesh_constants_gpu.h:856</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a7f90acaf0aa083eb07f37d2199f3d7be"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a7f90acaf0aa083eb07f37d2199f3d7be">gpuMemset_realw</a></div><div class="ttdeci">void gpuMemset_realw(gpu_realw_mem *buffer, int size, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00353">helper_functions_gpu.c:353</a></div></div>
<div class="ttc" id="structmesh___html_a5e09abf122afc522d084179bfbc57028"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a5e09abf122afc522d084179bfbc57028">mesh_::d_absorb_xmin_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_absorb_xmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00888">mesh_constants_gpu.h:888</a></div></div>
<div class="ttc" id="structmesh___html_a3c5585d9684da69e8bd37a87437dfaa3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3c5585d9684da69e8bd37a87437dfaa3">mesh_::d_b_epsilondev_yy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_yy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00644">mesh_constants_gpu.h:644</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html">mesh_constants_gpu.h</a></div></div>
<div class="ttc" id="structmesh___html_a0e7b57e9d26992326ac637c11e345ca9"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0e7b57e9d26992326ac637c11e345ca9">mesh_::d_b_eps_trace_over_3_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_eps_trace_over_3_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00650">mesh_constants_gpu.h:650</a></div></div>
<div class="ttc" id="structmesh___html_a6818d1f46200cabba20c1405a1c613e8"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6818d1f46200cabba20c1405a1c613e8">mesh_::num_colors_inner_crust_mantle</a></div><div class="ttdeci">int num_colors_inner_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00493">mesh_constants_gpu.h:493</a></div></div>
<div class="ttc" id="namespacempi__inner__core__par_html_ae82026a7e84ab1723d3cf6d720f4f63c"><div class="ttname"><a href="../../db/d27/namespacempi__inner__core__par.html#ae82026a7e84ab1723d3cf6d720f4f63c">mpi_inner_core_par::nibool_interfaces_inner_core</a></div><div class="ttdeci">integer, dimension(:), allocatable nibool_interfaces_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00525">meshfem3D_par.f90:525</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a1bff53d8ce4e2da9592c2aa37989a78a"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a1bff53d8ce4e2da9592c2aa37989a78a">specfem_par::gammaval</a></div><div class="ttdeci">real(kind=custom_real), dimension(n_sls) gammaval</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00207">specfem3D_par.F90:207</a></div></div>
<div class="ttc" id="structmesh___html_a4d0aaa5a46f341c2f0396e6df0541acb"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4d0aaa5a46f341c2f0396e6df0541acb">mesh_::h_num_elem_colors_outer_core</a></div><div class="ttdeci">int * h_num_elem_colors_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00554">mesh_constants_gpu.h:554</a></div></div>
<div class="ttc" id="structmesh___html_a15094f7c6fd3180c961aedf9a2790ef7"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a15094f7c6fd3180c961aedf9a2790ef7">mesh_::d_epsilondev_xx_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_xx_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00637">mesh_constants_gpu.h:637</a></div></div>
<div class="ttc" id="structmesh___html_a97742ee0dcb0ffe0897b51372e4a8c04"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a97742ee0dcb0ffe0897b51372e4a8c04">mesh_::d_absorb_ymax_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_absorb_ymax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00891">mesh_constants_gpu.h:891</a></div></div>
<div class="ttc" id="structmesh___html_a3527d35e7c96aa03b9efce9613767592"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3527d35e7c96aa03b9efce9613767592">mesh_::d_b_epsilondev_xx_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_xx_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00469">mesh_constants_gpu.h:469</a></div></div>
<div class="ttc" id="structmesh___html_a316eb289b6d1d7962df6a3256db36906"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a316eb289b6d1d7962df6a3256db36906">mesh_::d_c14store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c14store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00418">mesh_constants_gpu.h:418</a></div></div>
<div class="ttc" id="structmesh___html_aaf6b896c78677f5253c0422dd76331b4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aaf6b896c78677f5253c0422dd76331b4">mesh_::h_recv_accel_buffer_cm</a></div><div class="ttdeci">float * h_recv_accel_buffer_cm</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00926">mesh_constants_gpu.h:926</a></div></div>
<div class="ttc" id="namespacempi__outer__core__par_html_a69bafaeaf350ca16b12ebfdc9e261fae"><div class="ttname"><a href="../../d0/d26/namespacempi__outer__core__par.html#a69bafaeaf350ca16b12ebfdc9e261fae">mpi_outer_core_par::nibool_interfaces_outer_core</a></div><div class="ttdeci">integer, dimension(:), allocatable nibool_interfaces_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00591">meshfem3D_par.f90:591</a></div></div>
<div class="ttc" id="namespacespecfem__par__noise_html_a81207487b39c311777e83cfb7175bfa3"><div class="ttname"><a href="../../df/daf/namespacespecfem__par__noise.html#a81207487b39c311777e83cfb7175bfa3">specfem_par_noise::normal_y_noise</a></div><div class="ttdeci">real(kind=custom_real), dimension(:), allocatable normal_y_noise</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00917">specfem3D_par.F90:917</a></div></div>
<div class="ttc" id="namespacempi__inner__core__par_html_a64178a6cf4a5da9a236dbfd2cffae477"><div class="ttname"><a href="../../db/d27/namespacempi__inner__core__par.html#a64178a6cf4a5da9a236dbfd2cffae477">mpi_inner_core_par::num_interfaces_inner_core</a></div><div class="ttdeci">integer num_interfaces_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00523">meshfem3D_par.f90:523</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_ab9832938b064d570ab7c9f479b7d9df3"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#ab9832938b064d570ab7c9f479b7d9df3">specfem_par_outercore::njmax_outer_core</a></div><div class="ttdeci">integer, dimension(:,:), allocatable njmax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00848">specfem3D_par.F90:848</a></div></div>
<div class="ttc" id="structmesh___html_af4a7778304768cb9168190b378c5e585"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af4a7778304768cb9168190b378c5e585">mesh_::d_send_accel_buffer_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_send_accel_buffer_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00811">mesh_constants_gpu.h:811</a></div></div>
<div class="ttc" id="structmesh___html_a0c6822d0bce7e7064fbc10c13750b9e5"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0c6822d0bce7e7064fbc10c13750b9e5">mesh_::d_rho_kl_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_rho_kl_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00653">mesh_constants_gpu.h:653</a></div></div>
<div class="ttc" id="namespacempi__crust__mantle__par_html_a2f42325088db3abf72e4a5b9190d04c8"><div class="ttname"><a href="../../d7/d1e/namespacempi__crust__mantle__par.html#a2f42325088db3abf72e4a5b9190d04c8">mpi_crust_mantle_par::max_nibool_interfaces_cm</a></div><div class="ttdeci">integer max_nibool_interfaces_cm</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00468">meshfem3D_par.f90:468</a></div></div>
<div class="ttc" id="structmesh___html_a9787325a6dc6f90b28e6d5b0c047c2ba"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a9787325a6dc6f90b28e6d5b0c047c2ba">mesh_::d_jacobian2D_xmin_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_xmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00854">mesh_constants_gpu.h:854</a></div></div>
<div class="ttc" id="structmesh___html_a81a257a82f245406d679614e460478f3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a81a257a82f245406d679614e460478f3">mesh_::deltat</a></div><div class="ttdeci">realw deltat</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00738">mesh_constants_gpu.h:738</a></div></div>
<div class="ttc" id="structmesh___html_a76c841709f62363d5d46318df9c3c9f4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a76c841709f62363d5d46318df9c3c9f4">mesh_::d_ibelm_ymax_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ibelm_ymax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00847">mesh_constants_gpu.h:847</a></div></div>
<div class="ttc" id="structmesh___html_ad9595451c1bb1e6c75812c3c2fcdcfaa"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad9595451c1bb1e6c75812c3c2fcdcfaa">mesh_::RHO_BOTTOM_OC</a></div><div class="ttdeci">realw RHO_BOTTOM_OC</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00753">mesh_constants_gpu.h:753</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a89fc4d59c0bbb8de587229f9df7febfc"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a89fc4d59c0bbb8de587229f9df7febfc">specfem_par_innercore::b_epsilondev_xy_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_xy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00742">specfem3D_par.F90:742</a></div></div>
<div class="ttc" id="structmesh___html_a7fba1361e9c8f55e7c30c9ab1771ceca"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a7fba1361e9c8f55e7c30c9ab1771ceca">mesh_::d_b_displ_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_b_displ_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00535">mesh_constants_gpu.h:535</a></div></div>
<div class="ttc" id="structmesh___html_a6cebb837bf8ae85a273033ef39054232"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6cebb837bf8ae85a273033ef39054232">mesh_::d_ibool_interfaces_outer_core</a></div><div class="ttdeci">gpu_int_mem d_ibool_interfaces_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00825">mesh_constants_gpu.h:825</a></div></div>
<div class="ttc" id="structmesh___html_a92e906caafa02d3b219ea330f9466031"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a92e906caafa02d3b219ea330f9466031">mesh_::d_c33store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c33store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00426">mesh_constants_gpu.h:426</a></div></div>
<div class="ttc" id="structmesh___html_a488717b9193bbc8b134e0c34ccc0f77d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a488717b9193bbc8b134e0c34ccc0f77d">mesh_::d_b_R_xy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_R_xy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00630">mesh_constants_gpu.h:630</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_adde89a3fca80e5e2e3f09768f504fc28"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#adde89a3fca80e5e2e3f09768f504fc28">specfem_par_crustmantle::njmin_crust_mantle</a></div><div class="ttdeci">integer, dimension(:,:), allocatable njmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00600">specfem3D_par.F90:600</a></div></div>
<div class="ttc" id="structmesh___html_a6877d2f44d16a79b0c994c54504a00a9"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6877d2f44d16a79b0c994c54504a00a9">mesh_::d_rhostore_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_rhostore_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00392">mesh_constants_gpu.h:392</a></div></div>
<div class="ttc" id="structmesh___html_adef8666c17727c1bd8efb0b9000607bf"><div class="ttname"><a href="../../d2/d88/structmesh__.html#adef8666c17727c1bd8efb0b9000607bf">mesh_::d_ibool_interfaces_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ibool_interfaces_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00809">mesh_constants_gpu.h:809</a></div></div>
<div class="ttc" id="structmesh___html_abd8bb2afb96cdfa54334123559884268"><div class="ttname"><a href="../../d2/d88/structmesh__.html#abd8bb2afb96cdfa54334123559884268">mesh_::b_deltat</a></div><div class="ttdeci">realw b_deltat</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00739">mesh_constants_gpu.h:739</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_aa355faffe8b88e62355f7b3ce72828c1"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#aa355faffe8b88e62355f7b3ce72828c1">specfem_par_outercore::ibelm_ymax_outer_core</a></div><div class="ttdeci">integer, dimension(:), allocatable ibelm_ymax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00863">specfem3D_par.F90:863</a></div></div>
<div class="ttc" id="structmesh___html_a364225eb71cc5d1f3e07b0e612866a5b"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a364225eb71cc5d1f3e07b0e612866a5b">mesh_::d_rho_vs_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_rho_vs_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00865">mesh_constants_gpu.h:865</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_ab089796730cb5c065e83f3187091238f"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#ab089796730cb5c065e83f3187091238f">create_regions_mesh_par2::c12store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c12store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_ab21c4ab0bd96eda84f605fc883f3825b"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab21c4ab0bd96eda84f605fc883f3825b">mesh_::d_b_veloc_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_veloc_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00444">mesh_constants_gpu.h:444</a></div></div>
<div class="ttc" id="structmesh___html_a13e89a7396d89ba209d7f83a2a168280"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a13e89a7396d89ba209d7f83a2a168280">mesh_::nspec2D_zmin_outer_core</a></div><div class="ttdeci">int nspec2D_zmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00869">mesh_constants_gpu.h:869</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_aea1fca219d1f757235a8d2f525f02356"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#aea1fca219d1f757235a8d2f525f02356">specfem_par::nsources_local</a></div><div class="ttdeci">integer nsources_local</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00263">specfem3D_par.F90:263</a></div></div>
<div class="ttc" id="namespacempi__outer__core__par_html_a3110b1d946d62cf123b6c1274b979fb5"><div class="ttname"><a href="../../d0/d26/namespacempi__outer__core__par.html#a3110b1d946d62cf123b6c1274b979fb5">mpi_outer_core_par::ibool_interfaces_outer_core</a></div><div class="ttdeci">integer, dimension(:,:), allocatable ibool_interfaces_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00592">meshfem3D_par.f90:592</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a496ae848de5ecf8a51202b2bdf691c48"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a496ae848de5ecf8a51202b2bdf691c48">specfem_par_crustmantle::nkmin_xi_crust_mantle</a></div><div class="ttdeci">integer, dimension(:,:), allocatable nkmin_xi_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00600">specfem3D_par.F90:600</a></div></div>
<div class="ttc" id="structmesh___html_afb692dc5c8ba388d6179d622daddae8e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#afb692dc5c8ba388d6179d622daddae8e">mesh_::h_b_send_accel_buffer_oc</a></div><div class="ttdeci">float * h_b_send_accel_buffer_oc</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00939">mesh_constants_gpu.h:939</a></div></div>
<div class="ttc" id="namespacempi__inner__core__par_html_a3a4315d67a61198745325f0a0360d428"><div class="ttname"><a href="../../db/d27/namespacempi__inner__core__par.html#a3a4315d67a61198745325f0a0360d428">mpi_inner_core_par::ibool_interfaces_inner_core</a></div><div class="ttdeci">integer, dimension(:,:), allocatable ibool_interfaces_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00526">meshfem3D_par.f90:526</a></div></div>
<div class="ttc" id="structmesh___html_afeb1c65fd7d0827a663fa286cb07dde5"><div class="ttname"><a href="../../d2/d88/structmesh__.html#afeb1c65fd7d0827a663fa286cb07dde5">mesh_::d_eps_trace_over_3_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_eps_trace_over_3_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00475">mesh_constants_gpu.h:475</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a8790e4c2b52c1adff453e94b14d3d18f"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a8790e4c2b52c1adff453e94b14d3d18f">specfem_par::minus_g_icb</a></div><div class="ttdeci">real(kind=custom_real) minus_g_icb</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00254">specfem3D_par.F90:254</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_aaeb0a525a53440934c57f92239340064"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#aaeb0a525a53440934c57f92239340064">specfem_par_crustmantle::rho_vs_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable rho_vs_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00595">specfem3D_par.F90:595</a></div></div>
<div class="ttc" id="structmesh___html_aed54ca897f70153d4ae17879a9c38382"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aed54ca897f70153d4ae17879a9c38382">mesh_::num_interfaces_inner_core</a></div><div class="ttdeci">int num_interfaces_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00814">mesh_constants_gpu.h:814</a></div></div>
<div class="ttc" id="structmesh___html_a5dba209d935c8742faeec8a2b42faaf3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a5dba209d935c8742faeec8a2b42faaf3">mesh_::d_nkmin_eta_outer_core</a></div><div class="ttdeci">gpu_int_mem d_nkmin_eta_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00876">mesh_constants_gpu.h:876</a></div></div>
<div class="ttc" id="structmesh___html_a543f8dfc4d0eb6918d4b6311e5dbc841"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a543f8dfc4d0eb6918d4b6311e5dbc841">mesh_::d_station_strain_field</a></div><div class="ttdeci">gpu_realw_mem d_station_strain_field</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00789">mesh_constants_gpu.h:789</a></div></div>
<div class="ttc" id="structmesh___html_aa2d5a81904111e4af763e904d2557b97"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa2d5a81904111e4af763e904d2557b97">mesh_::d_normal_top_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_normal_top_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00560">mesh_constants_gpu.h:560</a></div></div>
<div class="ttc" id="structmesh___html_a820d5ac890b8ec1089e1817a68510b0d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a820d5ac890b8ec1089e1817a68510b0d">mesh_::myrank</a></div><div class="ttdeci">int myrank</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00804">mesh_constants_gpu.h:804</a></div></div>
<div class="ttc" id="structmesh___html_ac658b66a3451c8ab60e252a6a2e7ab3c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac658b66a3451c8ab60e252a6a2e7ab3c">mesh_::RHO_TOP_OC</a></div><div class="ttdeci">realw RHO_TOP_OC</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00754">mesh_constants_gpu.h:754</a></div></div>
<div class="ttc" id="structmesh___html_a8b5d44da0448862e6dff3f9768b7a387"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8b5d44da0448862e6dff3f9768b7a387">mesh_::d_R_xx_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_R_xx_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00448">mesh_constants_gpu.h:448</a></div></div>
<div class="ttc" id="structmesh___html_aa7eb120024ba76ddc38bf0321aa8a35c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa7eb120024ba76ddc38bf0321aa8a35c">mesh_::h_send_accel_buffer_ic</a></div><div class="ttdeci">float * h_send_accel_buffer_ic</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00931">mesh_constants_gpu.h:931</a></div></div>
<div class="ttc" id="structmesh___html_a088123526218cdd346388b677f272acc"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a088123526218cdd346388b677f272acc">mesh_::d_minus_rho_g_over_kappa_fluid</a></div><div class="ttdeci">gpu_realw_mem d_minus_rho_g_over_kappa_fluid</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00745">mesh_constants_gpu.h:745</a></div></div>
<div class="ttc" id="structmesh___html_ad02eb20d22dd252f5b00bec74039880c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad02eb20d22dd252f5b00bec74039880c">mesh_::num_phase_ispec_outer_core</a></div><div class="ttdeci">int num_phase_ispec_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00545">mesh_constants_gpu.h:545</a></div></div>
<div class="ttc" id="structmesh___html_af22453488c9229e180dc8449ac09bb98"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af22453488c9229e180dc8449ac09bb98">mesh_::d_jacobian2D_top_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_top_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00564">mesh_constants_gpu.h:564</a></div></div>
<div class="ttc" id="structmesh___html_ac8d8c983bcbf5cf8bc73800e91a9a584"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac8d8c983bcbf5cf8bc73800e91a9a584">mesh_::d_normal_ocean_load</a></div><div class="ttdeci">gpu_realw_mem d_normal_ocean_load</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00679">mesh_constants_gpu.h:679</a></div></div>
<div class="ttc" id="structmesh___html_a942ba73a8631a5efea8683e0d9d7d980"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a942ba73a8631a5efea8683e0d9d7d980">mesh_::d_b_epsilondev_yz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_yz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00473">mesh_constants_gpu.h:473</a></div></div>
<div class="ttc" id="structmesh___html_a1b723b9bc383b498b998e58cd965cfff"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a1b723b9bc383b498b998e58cd965cfff">mesh_::use_3d_attenuation_arrays</a></div><div class="ttdeci">int use_3d_attenuation_arrays</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00724">mesh_constants_gpu.h:724</a></div></div>
<div class="ttc" id="structmesh___html_a7359e7b881886f9640274e0b830a0313"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a7359e7b881886f9640274e0b830a0313">mesh_::d_nkmin_eta_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_nkmin_eta_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00842">mesh_constants_gpu.h:842</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a37018d157d792ef9b9ad2d2302224cf9"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a37018d157d792ef9b9ad2d2302224cf9">gpuCopy_todevice_int</a></div><div class="ttdeci">void gpuCopy_todevice_int(gpu_int_mem *d_array_addr_ptr, int *h_array, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00244">helper_functions_gpu.c:244</a></div></div>
<div class="ttc" id="structmesh___html_a2a5c6dac0533a51d2551bccdb1ff5a21"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2a5c6dac0533a51d2551bccdb1ff5a21">mesh_::d_epsilondev_yz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_yz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00641">mesh_constants_gpu.h:641</a></div></div>
<div class="ttc" id="prepare__mesh__constants__gpu_8c_html_a4a9d71a1ea3006d20b1dbc1010c762b3"><div class="ttname"><a href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html#a4a9d71a1ea3006d20b1dbc1010c762b3">FC_FUNC_</a></div><div class="ttdeci">EXTERN_LANG void FC_FUNC_(prepare_constants_device, PREPARE_CONSTANTS_DEVICE)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8e/prepare__mesh__constants__gpu_8c_source.html#l00073">prepare_mesh_constants_gpu.c:73</a></div></div>
<div class="ttc" id="structmesh___html_a1ee87f3481e27c06e7a355aeed24cc46"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a1ee87f3481e27c06e7a355aeed24cc46">mesh_::d_nimax_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_nimax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00838">mesh_constants_gpu.h:838</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_afaf57f320aa9029ba1a64c51c8f98ad8"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#afaf57f320aa9029ba1a64c51c8f98ad8">create_regions_mesh_par2::c26store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c26store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_a5bd19e66662956b156f674320c3dcb77"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a5bd19e66662956b156f674320c3dcb77">mesh_::d_jacobian2D_ymax_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_ymax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00886">mesh_constants_gpu.h:886</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_ab8505f78a1c5cc261234ccff68cebff9"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#ab8505f78a1c5cc261234ccff68cebff9">specfem_par::b_betaval</a></div><div class="ttdeci">real(kind=custom_real), dimension(n_sls) b_betaval</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00209">specfem3D_par.F90:209</a></div></div>
<div class="ttc" id="structmesh___html_ac031dcf07c1303b85cf7ed8ab7296a46"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac031dcf07c1303b85cf7ed8ab7296a46">mesh_::d_jacobian2D_bottom_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_bottom_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00565">mesh_constants_gpu.h:565</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a3fcef2949baf05eaaaef813179b762d2"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a3fcef2949baf05eaaaef813179b762d2">specfem_par_crustmantle::b_epsilondev_yy_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_yy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00563">specfem3D_par.F90:563</a></div></div>
<div class="ttc" id="structmesh___html_af9ed3392c5155cd8ef14831c97fb8e4a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af9ed3392c5155cd8ef14831c97fb8e4a">mesh_::undo_attenuation</a></div><div class="ttdeci">int undo_attenuation</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00722">mesh_constants_gpu.h:722</a></div></div>
<div class="ttc" id="structmesh___html_a0b282d32b6d427c499cf614c4701390c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0b282d32b6d427c499cf614c4701390c">mesh_::d_c45store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c45store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00431">mesh_constants_gpu.h:431</a></div></div>
<div class="ttc" id="structmesh___html_a2125fe633561ddaf329280856865ab0a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2125fe633561ddaf329280856865ab0a">mesh_::d_c11store_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_c11store_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00605">mesh_constants_gpu.h:605</a></div></div>
<div class="ttc" id="structmesh___html_ab8c9b781c9bb0ea693399f14971e5ce7"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab8c9b781c9bb0ea693399f14971e5ce7">mesh_::d_b_epsilondev_xy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_xy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00471">mesh_constants_gpu.h:471</a></div></div>
<div class="ttc" id="initialize__gpu_8c_html_ad3793f6b78b9182d35dd4607abd32c21"><div class="ttname"><a href="../../d9/d76/initialize__gpu_8c.html#ad3793f6b78b9182d35dd4607abd32c21">run_cuda</a></div><div class="ttdeci">int run_cuda</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d76/initialize__gpu_8c_source.html#l00080">initialize_gpu.c:80</a></div></div>
<div class="ttc" id="structmesh___html_a732e614647c2628f1855044c8665e774"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a732e614647c2628f1855044c8665e774">mesh_::nspec_outer_inner_core</a></div><div class="ttdeci">int nspec_outer_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00661">mesh_constants_gpu.h:661</a></div></div>
<div class="ttc" id="structmesh___html_a2d16ee43a986b610ad75b655d75c12c9"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2d16ee43a986b610ad75b655d75c12c9">mesh_::d_jacobian2D_ymin_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_ymin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00885">mesh_constants_gpu.h:885</a></div></div>
<div class="ttc" id="structmesh___html_a35b176fbd3e22cd518508e99df27abbe"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a35b176fbd3e22cd518508e99df27abbe">mesh_::num_interfaces_crust_mantle</a></div><div class="ttdeci">int num_interfaces_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00806">mesh_constants_gpu.h:806</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_aaee302f1e5ea618bf1c8c8c2cdd220bc"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#aaee302f1e5ea618bf1c8c8c2cdd220bc">create_regions_mesh_par2::c33store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c33store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_a47bd672e294029e6af28a5bee6ee2c56"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a47bd672e294029e6af28a5bee6ee2c56">mesh_::d_accel_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_accel_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00441">mesh_constants_gpu.h:441</a></div></div>
<div class="ttc" id="structmesh___html_a3f681504442bfd332fde6b131488d0e4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3f681504442bfd332fde6b131488d0e4">mesh_::NSPEC_INNER_CORE</a></div><div class="ttdeci">int NSPEC_INNER_CORE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00570">mesh_constants_gpu.h:570</a></div></div>
<div class="ttc" id="structmesh___html_a20889301eb6aebebcc62fd450e903337"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a20889301eb6aebebcc62fd450e903337">mesh_::d_b_A_array_rotation</a></div><div class="ttdeci">gpu_realw_mem d_b_A_array_rotation</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00765">mesh_constants_gpu.h:765</a></div></div>
<div class="ttc" id="structmesh___html_a47eb3eeb8cd237e52a4a2cec10862845"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a47eb3eeb8cd237e52a4a2cec10862845">mesh_::d_b_R_xx_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_R_xx_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00628">mesh_constants_gpu.h:628</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a56665f1a7d2cade723aa84b00b1afa30"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a56665f1a7d2cade723aa84b00b1afa30">specfem_par_innercore::b_eps_trace_over_3_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_eps_trace_over_3_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00746">specfem3D_par.F90:746</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a2b1fd2d28c6a7d4a3f7027cc1b6466f3"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a2b1fd2d28c6a7d4a3f7027cc1b6466f3">NDIM</a></div><div class="ttdeci">#define NDIM</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00139">mesh_constants_gpu.h:139</a></div></div>
<div class="ttc" id="structmesh___html_a553b6e29f88b6cdc8c9579a369fd2e83"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a553b6e29f88b6cdc8c9579a369fd2e83">mesh_::d_one_minus_sum_beta_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_one_minus_sum_beta_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00461">mesh_constants_gpu.h:461</a></div></div>
<div class="ttc" id="structmesh___html_a88fae143685e4b2cd65b8f027502218b"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a88fae143685e4b2cd65b8f027502218b">mesh_::d_etaz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_etaz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00386">mesh_constants_gpu.h:386</a></div></div>
<div class="ttc" id="structmesh___html_aeb15cb097eeff248ac8a5e1169f0d938"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aeb15cb097eeff248ac8a5e1169f0d938">mesh_::d_c33store_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_c33store_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00608">mesh_constants_gpu.h:608</a></div></div>
<div class="ttc" id="namespacespecfem__par__noise_html_a5b324276000b714a30bddeb554b8004b"><div class="ttname"><a href="../../df/daf/namespacespecfem__par__noise.html#a5b324276000b714a30bddeb554b8004b">specfem_par_noise::noise_sourcearray</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:,:), allocatable noise_sourcearray</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00916">specfem3D_par.F90:916</a></div></div>
<div class="ttc" id="structmesh___html_aef7bc36faad3d73528e43865d9df83ac"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aef7bc36faad3d73528e43865d9df83ac">mesh_::d_absorb_ymin_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_absorb_ymin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00890">mesh_constants_gpu.h:890</a></div></div>
<div class="ttc" id="structmesh___html_a56f9e57b568ede45123c606ddfbb407e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a56f9e57b568ede45123c606ddfbb407e">mesh_::d_b_displ_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_displ_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00443">mesh_constants_gpu.h:443</a></div></div>
<div class="ttc" id="structmesh___html_ad24a72ca9672db527b9c1a700ce8f756"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad24a72ca9672db527b9c1a700ce8f756">mesh_::d_ibool_ocean_load</a></div><div class="ttdeci">gpu_int_mem d_ibool_ocean_load</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00677">mesh_constants_gpu.h:677</a></div></div>
<div class="ttc" id="structmesh___html_a4337f7490448e25af5bc44230270ce1d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4337f7490448e25af5bc44230270ce1d">mesh_::d_islice_selected_source</a></div><div class="ttdeci">gpu_int_mem d_islice_selected_source</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00774">mesh_constants_gpu.h:774</a></div></div>
<div class="ttc" id="structmesh___html_a75fe641c1a0fa474f4517a00545c7652"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a75fe641c1a0fa474f4517a00545c7652">mesh_::d_c24store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c24store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00423">mesh_constants_gpu.h:423</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_a70b123213653570df018764edac05ce8"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#a70b123213653570df018764edac05ce8">specfem_par_outercore::ibelm_ymin_outer_core</a></div><div class="ttdeci">integer, dimension(:), allocatable ibelm_ymin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00863">specfem3D_par.F90:863</a></div></div>
<div class="ttc" id="structmesh___html_a4aae6e672ec4f1be740c01216edf04bf"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4aae6e672ec4f1be740c01216edf04bf">mesh_::d_b_rmassx_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_rmassx_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00593">mesh_constants_gpu.h:593</a></div></div>
<div class="ttc" id="structmesh___html_a78592cd625fc9f65e28d686c259c111c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a78592cd625fc9f65e28d686c259c111c">mesh_::d_normal_ymin_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_normal_ymin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00851">mesh_constants_gpu.h:851</a></div></div>
<div class="ttc" id="structmesh___html_a94dae0867df03ced9873de73db6fd428"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a94dae0867df03ced9873de73db6fd428">mesh_::h_b_send_accel_buffer_ic</a></div><div class="ttdeci">float * h_b_send_accel_buffer_ic</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00933">mesh_constants_gpu.h:933</a></div></div>
<div class="ttc" id="structmesh___html_a751b93454f8a335682b009089ba1c42f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a751b93454f8a335682b009089ba1c42f">mesh_::d_nkmin_xi_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_nkmin_xi_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00841">mesh_constants_gpu.h:841</a></div></div>
<div class="ttc" id="namespacespecfem__par__noise_html_abd19d594c0e065ae5dd7e70d052ef373"><div class="ttname"><a href="../../df/daf/namespacespecfem__par__noise.html#abd19d594c0e065ae5dd7e70d052ef373">specfem_par_noise::normal_x_noise</a></div><div class="ttdeci">real(kind=custom_real), dimension(:), allocatable normal_x_noise</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00917">specfem3D_par.F90:917</a></div></div>
<div class="ttc" id="structmesh___html_a97c2f82fe10d4b6860e4492c7021a055"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a97c2f82fe10d4b6860e4492c7021a055">mesh_::nspec_inner_crust_mantle</a></div><div class="ttdeci">int nspec_inner_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00490">mesh_constants_gpu.h:490</a></div></div>
<div class="ttc" id="structmesh___html_a4e67f675b4f6a78c144aeb4d6d0ee30d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4e67f675b4f6a78c144aeb4d6d0ee30d">mesh_::num_colors_outer_outer_core</a></div><div class="ttdeci">int num_colors_outer_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00553">mesh_constants_gpu.h:553</a></div></div>
<div class="ttc" id="structmesh___html_af8bd069f109d24c07e4935e8b8a11e80"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af8bd069f109d24c07e4935e8b8a11e80">mesh_::d_b_epsilondev_xz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_xz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00472">mesh_constants_gpu.h:472</a></div></div>
<div class="ttc" id="structmesh___html_ad8a9491459c9cc04902ffd755f3bd66f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad8a9491459c9cc04902ffd755f3bd66f">mesh_::d_rmass_ocean_load</a></div><div class="ttdeci">gpu_realw_mem d_rmass_ocean_load</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00678">mesh_constants_gpu.h:678</a></div></div>
<div class="ttc" id="structmesh___html_ad98a9518680f56d4ce1f6c2e7f6e2ce0"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad98a9518680f56d4ce1f6c2e7f6e2ce0">mesh_::d_R_yz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_R_yz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00452">mesh_constants_gpu.h:452</a></div></div>
<div class="ttc" id="structmesh___html_a9dc3e00e15727c169e05c2f5f6b8fe1d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a9dc3e00e15727c169e05c2f5f6b8fe1d">mesh_::max_nibool_interfaces_ic</a></div><div class="ttdeci">int max_nibool_interfaces_ic</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00815">mesh_constants_gpu.h:815</a></div></div>
<div class="ttc" id="structmesh___html_ab8e81d6461b1b04617deeb952132db38"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab8e81d6461b1b04617deeb952132db38">mesh_::d_gammaz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_gammaz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00389">mesh_constants_gpu.h:389</a></div></div>
<div class="ttc" id="structmesh___html_a216b70fc7e57bb30a41620535beeb9df"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a216b70fc7e57bb30a41620535beeb9df">mesh_::d_gammax_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_gammax_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00581">mesh_constants_gpu.h:581</a></div></div>
<div class="ttc" id="structmesh___html_a8f5791decaebb152fd8a4dc8bcc36889"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8f5791decaebb152fd8a4dc8bcc36889">mesh_::use_mesh_coloring_gpu</a></div><div class="ttdeci">int use_mesh_coloring_gpu</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00714">mesh_constants_gpu.h:714</a></div></div>
<div class="ttc" id="structmesh___html_ace6dc60fb69bc859412f317d881bf4b6"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ace6dc60fb69bc859412f317d881bf4b6">mesh_::d_c56store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c56store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00434">mesh_constants_gpu.h:434</a></div></div>
<div class="ttc" id="structmesh___html_a3dd23b6d77afcfeba48b12164a8fb6fe"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3dd23b6d77afcfeba48b12164a8fb6fe">mesh_::d_b_accel_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_accel_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00445">mesh_constants_gpu.h:445</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a7534b8a728f07ec6658ae68ec7c6c567"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a7534b8a728f07ec6658ae68ec7c6c567">specfem_par_crustmantle::b_epsilondev_yz_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_yz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00563">specfem3D_par.F90:563</a></div></div>
<div class="ttc" id="structmesh___html_a47610a04930017eff8586b9cfd69cff2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a47610a04930017eff8586b9cfd69cff2">mesh_::d_idoubling_inner_core</a></div><div class="ttdeci">gpu_int_mem d_idoubling_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00599">mesh_constants_gpu.h:599</a></div></div>
<div class="ttc" id="structmesh___html_a45dfd81d4414869744dea84b67a292db"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a45dfd81d4414869744dea84b67a292db">mesh_::d_pre_computed_irec</a></div><div class="ttdeci">gpu_int_mem d_pre_computed_irec</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00796">mesh_constants_gpu.h:796</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a8bfa3716eff7e36136643375026c81e1"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a8bfa3716eff7e36136643375026c81e1">get_blocks_xy</a></div><div class="ttdeci">static void get_blocks_xy(int num_blocks, int *num_blocks_x, int *num_blocks_y)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l01111">mesh_constants_gpu.h:1111</a></div></div>
<div class="ttc" id="structmesh___html_a9c76d9e7af55d02d8e07e1b57c28fd98"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a9c76d9e7af55d02d8e07e1b57c28fd98">mesh_::d_ibelm_xmax_outer_core</a></div><div class="ttdeci">gpu_int_mem d_ibelm_xmax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00879">mesh_constants_gpu.h:879</a></div></div>
<div class="ttc" id="structmesh___html_aaba3efd3edea77cea2253be81c45e3d5"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aaba3efd3edea77cea2253be81c45e3d5">mesh_::d_rmass_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_rmass_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00520">mesh_constants_gpu.h:520</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a14be334156b1d0dd55e1868f63e97282"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a14be334156b1d0dd55e1868f63e97282">specfem_par_innercore::eps_trace_over_3_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target eps_trace_over_3_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00735">specfem3D_par.F90:735</a></div></div>
<div class="ttc" id="structmesh___html_a5b2bb6e71a612e82d011de3380445121"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a5b2bb6e71a612e82d011de3380445121">mesh_::d_norm_max</a></div><div class="ttdeci">gpu_realw_mem d_norm_max</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00799">mesh_constants_gpu.h:799</a></div></div>
<div class="ttc" id="structmesh___html_ab944aeffdd9acbb80123c2aaecff98cb"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab944aeffdd9acbb80123c2aaecff98cb">mesh_::d_displ_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_displ_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00439">mesh_constants_gpu.h:439</a></div></div>
<div class="ttc" id="structmesh___html_ae7b2a53ca55badab06155f4e0892775c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae7b2a53ca55badab06155f4e0892775c">mesh_::d_rmassx_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_rmassx_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00400">mesh_constants_gpu.h:400</a></div></div>
<div class="ttc" id="structmesh___html_a914b75504cecab3c01b2136d87dad438"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a914b75504cecab3c01b2136d87dad438">mesh_::d_d_ln_density_dr_table</a></div><div class="ttdeci">gpu_realw_mem d_d_ln_density_dr_table</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00744">mesh_constants_gpu.h:744</a></div></div>
<div class="ttc" id="structmesh___html_a4eb515980cb5002e5d54a3d220e85c13"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4eb515980cb5002e5d54a3d220e85c13">mesh_::nspec2D_xmin_outer_core</a></div><div class="ttdeci">int nspec2D_xmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00867">mesh_constants_gpu.h:867</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a729af34ce8da88dce90f9bd709968319"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a729af34ce8da88dce90f9bd709968319">specfem_par_crustmantle::epsilondev_xx_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_xx_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00552">specfem3D_par.F90:552</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_abaec810dab5233772689b8d71670901d"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#abaec810dab5233772689b8d71670901d">specfem_par_crustmantle::epsilondev_xy_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_xy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00552">specfem3D_par.F90:552</a></div></div>
<div class="ttc" id="structmesh___html_afaf83dadc024b96704da0755c2bcb256"><div class="ttname"><a href="../../d2/d88/structmesh__.html#afaf83dadc024b96704da0755c2bcb256">mesh_::d_njmax_outer_core</a></div><div class="ttdeci">gpu_int_mem d_njmax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00874">mesh_constants_gpu.h:874</a></div></div>
<div class="ttc" id="structmesh___html_a3d75627c48c86823e4cadfee2b5fa26e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3d75627c48c86823e4cadfee2b5fa26e">mesh_::d_eps_trace_over_3_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_eps_trace_over_3_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00649">mesh_constants_gpu.h:649</a></div></div>
<div class="ttc" id="mesh__constants__ocl_8h_html_a7fa376a9a7e7808be19e7e3acaf15c6f"><div class="ttname"><a href="../../dc/d29/mesh__constants__ocl_8h.html#a7fa376a9a7e7808be19e7e3acaf15c6f">mocl</a></div><div class="ttdeci">struct _mesh_opencl mocl</div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a87e554c490527e842f17eefb2b349568"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a87e554c490527e842f17eefb2b349568">create_regions_mesh_par2::c36store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c36store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_a93add741cbc781355cc64d0ab97a8de2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a93add741cbc781355cc64d0ab97a8de2">mesh_::d_rmassx_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_rmassx_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00590">mesh_constants_gpu.h:590</a></div></div>
<div class="ttc" id="structmesh___html_a8b7866dfc5c6fff2554ec6889b088abc"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8b7866dfc5c6fff2554ec6889b088abc">mesh_::d_b_send_accel_buffer_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_send_accel_buffer_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00812">mesh_constants_gpu.h:812</a></div></div>
<div class="ttc" id="structmesh___html_aa772b8837e77ed340f0c6af5cdfa73ea"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa772b8837e77ed340f0c6af5cdfa73ea">mesh_::d_R_xy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_R_xy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00624">mesh_constants_gpu.h:624</a></div></div>
<div class="ttc" id="structmesh___html_ac40025a666d151f55f4d8c1ff1555ca0"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac40025a666d151f55f4d8c1ff1555ca0">mesh_::nspec_outer_crust_mantle</a></div><div class="ttdeci">int nspec_outer_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00489">mesh_constants_gpu.h:489</a></div></div>
<div class="ttc" id="structmesh___html_a040f596b4e803a1ca439e29dad9e25a3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a040f596b4e803a1ca439e29dad9e25a3">mesh_::d_A_array_rotation</a></div><div class="ttdeci">gpu_realw_mem d_A_array_rotation</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00760">mesh_constants_gpu.h:760</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a604f5de2c81526c92873d0845714c495"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a604f5de2c81526c92873d0845714c495">NGLL2</a></div><div class="ttdeci">#define NGLL2</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00143">mesh_constants_gpu.h:143</a></div></div>
<div class="ttc" id="structmesh___html_abb4c25f21ec2ed043cf83c604f2614fc"><div class="ttname"><a href="../../d2/d88/structmesh__.html#abb4c25f21ec2ed043cf83c604f2614fc">mesh_::d_etay_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_etay_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00510">mesh_constants_gpu.h:510</a></div></div>
<div class="ttc" id="structmesh___html_a6251bee022388a8296b0085642fda69a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6251bee022388a8296b0085642fda69a">mesh_::num_interfaces_outer_core</a></div><div class="ttdeci">int num_interfaces_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00822">mesh_constants_gpu.h:822</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a174b6e236a112b882eb1acc841f72c35"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a174b6e236a112b882eb1acc841f72c35">create_regions_mesh_par2::c55store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c55store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_a614e141074294d6b0f21efd963d082ee"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a614e141074294d6b0f21efd963d082ee">mesh_::d_accel_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_accel_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00533">mesh_constants_gpu.h:533</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a6236cd793e5e9c5bc2d6a87145aedd5c"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a6236cd793e5e9c5bc2d6a87145aedd5c">specfem_par_crustmantle::epsilondev_xz_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_xz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00552">specfem3D_par.F90:552</a></div></div>
<div class="ttc" id="namespacempi__crust__mantle__par_html_a6f62a44c0d47abbee113f4f7dab56c38"><div class="ttname"><a href="../../d7/d1e/namespacempi__crust__mantle__par.html#a6f62a44c0d47abbee113f4f7dab56c38">mpi_crust_mantle_par::nibool_interfaces_crust_mantle</a></div><div class="ttdeci">integer, dimension(:), allocatable nibool_interfaces_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00469">meshfem3D_par.f90:469</a></div></div>
<div class="ttc" id="structmesh___html_a348dc7b1fa2dfa1d9b3a781738820139"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a348dc7b1fa2dfa1d9b3a781738820139">mesh_::d_gammay_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_gammay_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00388">mesh_constants_gpu.h:388</a></div></div>
<div class="ttc" id="structmesh___html_ae9c91d83fe8ef8f588ad6d5124344e6f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae9c91d83fe8ef8f588ad6d5124344e6f">mesh_::NSPEC_OUTER_CORE</a></div><div class="ttdeci">int NSPEC_OUTER_CORE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00502">mesh_constants_gpu.h:502</a></div></div>
<div class="ttc" id="structmesh___html_a3e656f2ee4180330a0ae335324d94e17"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3e656f2ee4180330a0ae335324d94e17">mesh_::d_ibelm_bottom_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ibelm_bottom_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00497">mesh_constants_gpu.h:497</a></div></div>
<div class="ttc" id="structmesh___html_a277c63d71bafe01200a4b9699e73d02e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a277c63d71bafe01200a4b9699e73d02e">mesh_::d_minus_deriv_gravity_table</a></div><div class="ttdeci">gpu_realw_mem d_minus_deriv_gravity_table</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00747">mesh_constants_gpu.h:747</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a5ffd52e5f97dac39af9929875097ffa8"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a5ffd52e5f97dac39af9929875097ffa8">specfem_par::npoin_oceans</a></div><div class="ttdeci">integer npoin_oceans</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00227">specfem3D_par.F90:227</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_a40841234f7ce07beaf7698db262bb166"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#a40841234f7ce07beaf7698db262bb166">specfem_par_outercore::nkmin_xi_outer_core</a></div><div class="ttdeci">integer, dimension(:,:), allocatable nkmin_xi_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00848">specfem3D_par.F90:848</a></div></div>
<div class="ttc" id="structmesh___html_afb9ec80ae0c39aceb79e4c252bac0a8f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#afb9ec80ae0c39aceb79e4c252bac0a8f">mesh_::d_ibelm_ymax_outer_core</a></div><div class="ttdeci">gpu_int_mem d_ibelm_ymax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00881">mesh_constants_gpu.h:881</a></div></div>
<div class="ttc" id="structmesh___html_a8db3ee3a1cabd76554dd7118ad057109"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8db3ee3a1cabd76554dd7118ad057109">mesh_::d_normal_ymax_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_normal_ymax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00852">mesh_constants_gpu.h:852</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a0e3ec48df0ca1f6438f681f0d4ea8120"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a0e3ec48df0ca1f6438f681f0d4ea8120">specfem_par_innercore::b_epsilondev_xx_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_xx_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00742">specfem3D_par.F90:742</a></div></div>
<div class="ttc" id="structmesh___html_a3a5060a75213f19a59c89c39654557ce"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3a5060a75213f19a59c89c39654557ce">mesh_::d_rho_kl_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_rho_kl_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00540">mesh_constants_gpu.h:540</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_a8e9d726bdc6cffe7b682d3ee02d5025d"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#a8e9d726bdc6cffe7b682d3ee02d5025d">specfem_par_outercore::njmin_outer_core</a></div><div class="ttdeci">integer, dimension(:,:), allocatable njmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00848">specfem3D_par.F90:848</a></div></div>
<div class="ttc" id="structmesh___html_a101156fa97590c52662408617fa79e7e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a101156fa97590c52662408617fa79e7e">mesh_::d_absorb_xmax_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_absorb_xmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00860">mesh_constants_gpu.h:860</a></div></div>
<div class="ttc" id="structmesh___html_a64fc6e4b22b5167f9fa6588079497890"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a64fc6e4b22b5167f9fa6588079497890">mesh_::d_njmin_outer_core</a></div><div class="ttdeci">gpu_int_mem d_njmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00873">mesh_constants_gpu.h:873</a></div></div>
<div class="ttc" id="structmesh___html_ab5527d29686c5e83c7e021b9173ca5a6"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab5527d29686c5e83c7e021b9173ca5a6">mesh_::num_phase_ispec_inner_core</a></div><div class="ttdeci">int num_phase_ispec_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00659">mesh_constants_gpu.h:659</a></div></div>
<div class="ttc" id="structmesh___html_a6599701ed77716191e24bd17cf57e852"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6599701ed77716191e24bd17cf57e852">mesh_::d_rhostore_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_rhostore_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00586">mesh_constants_gpu.h:586</a></div></div>
<div class="ttc" id="structmesh___html_a697f1440498e8a89321f35a60f94e68d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a697f1440498e8a89321f35a60f94e68d">mesh_::d_B_array_rotation</a></div><div class="ttdeci">gpu_realw_mem d_B_array_rotation</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00761">mesh_constants_gpu.h:761</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a7c9c7b9d75a91f0b08157f4f3d8322cc"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a7c9c7b9d75a91f0b08157f4f3d8322cc">gpuMalloc_realw</a></div><div class="ttdeci">void gpuMalloc_realw(gpu_realw_mem *buffer, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00290">helper_functions_gpu.c:290</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a148311ac010a9fc86c1038a35248cd22"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a148311ac010a9fc86c1038a35248cd22">create_regions_mesh_par2::c11store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c11store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_a17819433e875d9b944d91830e9184942"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a17819433e875d9b944d91830e9184942">mesh_::h_b_recv_accel_buffer_oc</a></div><div class="ttdeci">float * h_b_recv_accel_buffer_oc</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00940">mesh_constants_gpu.h:940</a></div></div>
<div class="ttc" id="mesh__constants__cuda_8h_html_ab7e8a3159637a67955a4bbfd9784a5f7"><div class="ttname"><a href="../../db/d78/mesh__constants__cuda_8h.html#ab7e8a3159637a67955a4bbfd9784a5f7">print_CUDA_error_if_any</a></div><div class="ttdeci">void print_CUDA_error_if_any(cudaError_t err, int num)</div></div>
<div class="ttc" id="structmesh___html_a8ccc22b60c21d89cb0a3c6de925a2c0e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8ccc22b60c21d89cb0a3c6de925a2c0e">mesh_::d_b_R_xy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_R_xy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00456">mesh_constants_gpu.h:456</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a81a3273ffe5171f96bab3735bacdec46"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a81a3273ffe5171f96bab3735bacdec46">create_regions_mesh_par2::c34store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c34store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_af1aed0e0fe944d62f3fba633ce95cea7"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#af1aed0e0fe944d62f3fba633ce95cea7">EXTERN_LANG</a></div><div class="ttdeci">#define EXTERN_LANG</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00360">mesh_constants_gpu.h:360</a></div></div>
<div class="ttc" id="structmesh___html_aac9468750f58d853dcb09489c956ad0c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aac9468750f58d853dcb09489c956ad0c">mesh_::d_rstore_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_rstore_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00412">mesh_constants_gpu.h:412</a></div></div>
<div class="ttc" id="structmesh___html_afb5c630a75fed79535e9b6bc03673f5a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#afb5c630a75fed79535e9b6bc03673f5a">mesh_::d_etax_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_etax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00384">mesh_constants_gpu.h:384</a></div></div>
<div class="ttc" id="structmesh___html_a480e776746f641eb54b841c95b8d58d7"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a480e776746f641eb54b841c95b8d58d7">mesh_::d_ibelm_top_outer_core</a></div><div class="ttdeci">gpu_int_mem d_ibelm_top_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00556">mesh_constants_gpu.h:556</a></div></div>
<div class="ttc" id="structmesh___html_a46fd62f2a18df5fee4323c126e904a9a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a46fd62f2a18df5fee4323c126e904a9a">mesh_::d_ispec_selected_source</a></div><div class="ttdeci">gpu_int_mem d_ispec_selected_source</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00775">mesh_constants_gpu.h:775</a></div></div>
<div class="ttc" id="structmesh___html_a6b64a3db433854de8e65c25c4d00b392"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6b64a3db433854de8e65c25c4d00b392">mesh_::d_ibool_interfaces_inner_core</a></div><div class="ttdeci">gpu_int_mem d_ibool_interfaces_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00817">mesh_constants_gpu.h:817</a></div></div>
<div class="ttc" id="structmesh___html_aa1f0273a931d5d73e16b52232fa03281"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa1f0273a931d5d73e16b52232fa03281">mesh_::h_adj_sourcearrays_slice</a></div><div class="ttdeci">realw * h_adj_sourcearrays_slice</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00795">mesh_constants_gpu.h:795</a></div></div>
<div class="ttc" id="structmesh___html_a2a4ca0cb83ae4b36c5b5d6a844970987"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2a4ca0cb83ae4b36c5b5d6a844970987">mesh_::d_epsilondev_yy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_yy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00638">mesh_constants_gpu.h:638</a></div></div>
<div class="ttc" id="structmesh___html_a6c0733577673683cf5ed080ff9a05a20"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6c0733577673683cf5ed080ff9a05a20">mesh_::d_c13store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c13store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00417">mesh_constants_gpu.h:417</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a3aac86945ecfb39c3e1d989427b1b179"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a3aac86945ecfb39c3e1d989427b1b179">specfem_par_innercore::epsilondev_xz_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_xz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00731">specfem3D_par.F90:731</a></div></div>
<div class="ttc" id="structmesh___html_a3bd686edbeffc96caebd86f8e5d7acd8"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3bd686edbeffc96caebd86f8e5d7acd8">mesh_::d_jacobian2D_xmax_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_xmax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00884">mesh_constants_gpu.h:884</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a696b542f19eb97e47c2acd7e60c677c2"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a696b542f19eb97e47c2acd7e60c677c2">gpuFree</a></div><div class="ttdeci">void gpuFree(void *d_array_addr_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00395">helper_functions_gpu.c:395</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_aca9ac56779b1c2170f770e2be59bdc18"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#aca9ac56779b1c2170f770e2be59bdc18">specfem_par_crustmantle::ibelm_xmin_crust_mantle</a></div><div class="ttdeci">integer, dimension(:), allocatable ibelm_xmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00571">specfem3D_par.F90:571</a></div></div>
<div class="ttc" id="structmesh___html_ac3cd4e1e4e0741f411def3c206bffa6f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac3cd4e1e4e0741f411def3c206bffa6f">mesh_::d_hess_kl_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_hess_kl_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00483">mesh_constants_gpu.h:483</a></div></div>
<div class="ttc" id="structmesh___html_aa864f8a76a95345930b5fb96c48937a4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa864f8a76a95345930b5fb96c48937a4">mesh_::NSPEC_INNER_CORE_STRAIN_ONLY</a></div><div class="ttdeci">int NSPEC_INNER_CORE_STRAIN_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00572">mesh_constants_gpu.h:572</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a54c1072e5eb76d20783186dfeab590e5"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a54c1072e5eb76d20783186dfeab590e5">specfem_par_crustmantle::b_epsilondev_xz_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_xz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00563">specfem3D_par.F90:563</a></div></div>
<div class="ttc" id="structmesh___html_ac0b9eb9864c39537e161c860a8a550f5"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac0b9eb9864c39537e161c860a8a550f5">mesh_::d_ibool_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ibool_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00408">mesh_constants_gpu.h:408</a></div></div>
<div class="ttc" id="structmesh___html_a70d463d267f0659d26038d69012b2088"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a70d463d267f0659d26038d69012b2088">mesh_::max_nibool_interfaces_oc</a></div><div class="ttdeci">int max_nibool_interfaces_oc</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00823">mesh_constants_gpu.h:823</a></div></div>
<div class="ttc" id="structmesh___html_a1278dcc0aec8bc5e2400005e16505e06"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a1278dcc0aec8bc5e2400005e16505e06">mesh_::d_normal_xmin_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_normal_xmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00849">mesh_constants_gpu.h:849</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a8188c1c360944920584b2a0a1f9bf8ac"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a8188c1c360944920584b2a0a1f9bf8ac">gpuSynchronize</a></div><div class="ttdeci">void gpuSynchronize()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00482">helper_functions_gpu.c:482</a></div></div>
<div class="ttc" id="structmesh___html_a25eb457a2fed340a148c1d4de5921b66"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a25eb457a2fed340a148c1d4de5921b66">mesh_::d_kappahstore_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_kappahstore_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00395">mesh_constants_gpu.h:395</a></div></div>
<div class="ttc" id="structmesh___html_a6a72c219cab018873d6f7b665190db6f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6a72c219cab018873d6f7b665190db6f">mesh_::num_colors_inner_outer_core</a></div><div class="ttdeci">int num_colors_inner_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00552">mesh_constants_gpu.h:552</a></div></div>
<div class="ttc" id="structmesh___html_a57417aa6da3537428506d97d31fb69cf"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a57417aa6da3537428506d97d31fb69cf">mesh_::noise_tomography</a></div><div class="ttdeci">int noise_tomography</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00899">mesh_constants_gpu.h:899</a></div></div>
<div class="ttc" id="structmesh___html_ab720949e150adec27caa401394a0aa42"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab720949e150adec27caa401394a0aa42">mesh_::d_b_epsilondev_yz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_yz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00647">mesh_constants_gpu.h:647</a></div></div>
<div class="ttc" id="structmesh___html_a52d5a8e4dceed2fd59279003c594b5a0"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a52d5a8e4dceed2fd59279003c594b5a0">mesh_::d_epsilondev_yz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_yz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00467">mesh_constants_gpu.h:467</a></div></div>
<div class="ttc" id="structmesh___html_a554e81001ff33f78ee750dd113107090"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a554e81001ff33f78ee750dd113107090">mesh_::d_ibool_outer_core</a></div><div class="ttdeci">gpu_int_mem d_ibool_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00524">mesh_constants_gpu.h:524</a></div></div>
<div class="ttc" id="structmesh___html_ad404fad4a9d6ab87708de919974850e4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad404fad4a9d6ab87708de919974850e4">mesh_::d_ispec_selected_rec</a></div><div class="ttdeci">gpu_int_mem d_ispec_selected_rec</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00781">mesh_constants_gpu.h:781</a></div></div>
<div class="ttc" id="structmesh___html_a0a1c274cac4d0b253381447289f2a8e1"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0a1c274cac4d0b253381447289f2a8e1">mesh_::d_c11store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c11store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00415">mesh_constants_gpu.h:415</a></div></div>
<div class="ttc" id="structmesh___html_a9d76cbf3c6992debc5b0e70890fb2f49"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a9d76cbf3c6992debc5b0e70890fb2f49">mesh_::d_c36store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c36store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00429">mesh_constants_gpu.h:429</a></div></div>
<div class="ttc" id="structmesh___html_a576ab0a536d5ac7d274abef84754d251"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a576ab0a536d5ac7d274abef84754d251">mesh_::d_ibool_inner_core</a></div><div class="ttdeci">gpu_int_mem d_ibool_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00598">mesh_constants_gpu.h:598</a></div></div>
<div class="ttc" id="structmesh___html_a45a8c9b5d0615e443242d1787dc128ab"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a45a8c9b5d0615e443242d1787dc128ab">mesh_::h_num_elem_colors_inner_core</a></div><div class="ttdeci">int * h_num_elem_colors_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00667">mesh_constants_gpu.h:667</a></div></div>
<div class="ttc" id="structmesh___html_ac8bd28eb81b8d941cce99742fb50c477"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac8bd28eb81b8d941cce99742fb50c477">mesh_::d_kappavstore_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_kappavstore_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00518">mesh_constants_gpu.h:518</a></div></div>
<div class="ttc" id="structmesh___html_a1964cdc9086505e83de26cce859467ab"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a1964cdc9086505e83de26cce859467ab">mesh_::NSPEC_CRUST_MANTLE_STRAIN_ONLY</a></div><div class="ttdeci">int NSPEC_CRUST_MANTLE_STRAIN_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00378">mesh_constants_gpu.h:378</a></div></div>
<div class="ttc" id="structmesh___html_ab4605156829d24601b63e2a33693d258"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab4605156829d24601b63e2a33693d258">mesh_::d_b_epsilondev_xy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_epsilondev_xy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00645">mesh_constants_gpu.h:645</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_ac5a9f45740c1f7f90aefe52f7e73a27e"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#ac5a9f45740c1f7f90aefe52f7e73a27e">specfem_par_crustmantle::ibelm_ymax_crust_mantle</a></div><div class="ttdeci">integer, dimension(:), allocatable ibelm_ymax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00572">specfem3D_par.F90:572</a></div></div>
<div class="ttc" id="structmesh___html_a93844111b6b5c5ce0646344ff0bd1b86"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a93844111b6b5c5ce0646344ff0bd1b86">mesh_::d_njmin_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_njmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00839">mesh_constants_gpu.h:839</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a3702d9a47545037d7870b2568eac2917"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a3702d9a47545037d7870b2568eac2917">create_regions_mesh_par2::c15store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c15store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_a3855e14bb491e1b1594b401d458ae8df"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#a3855e14bb491e1b1594b401d458ae8df">specfem_par_outercore::nimax_outer_core</a></div><div class="ttdeci">integer, dimension(:,:), allocatable nimax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00847">specfem3D_par.F90:847</a></div></div>
<div class="ttc" id="structmesh___html_a093790ab61d9614f1234ea79b9bb3c8a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a093790ab61d9614f1234ea79b9bb3c8a">mesh_::num_phase_ispec_crust_mantle</a></div><div class="ttdeci">int num_phase_ispec_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00487">mesh_constants_gpu.h:487</a></div></div>
<div class="ttc" id="structmesh___html_ac30f1e23c623f792e94ce635d6e83291"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac30f1e23c623f792e94ce635d6e83291">mesh_::d_b_R_yz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_R_yz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00632">mesh_constants_gpu.h:632</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_acff5c35418e6a16157947464edf75a02"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#acff5c35418e6a16157947464edf75a02">specfem_par_crustmantle::njmax_crust_mantle</a></div><div class="ttdeci">integer, dimension(:,:), allocatable njmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00600">specfem3D_par.F90:600</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_aa0168d93da247207d6e594fd9d9d9858"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#aa0168d93da247207d6e594fd9d9d9858">specfem_par_crustmantle::nimax_crust_mantle</a></div><div class="ttdeci">integer, dimension(:,:), allocatable nimax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00599">specfem3D_par.F90:599</a></div></div>
<div class="ttc" id="namespacempi__inner__core__par_html_ac6d02e431e8cba8b8645f2729056ae06"><div class="ttname"><a href="../../db/d27/namespacempi__inner__core__par.html#ac6d02e431e8cba8b8645f2729056ae06">mpi_inner_core_par::max_nibool_interfaces_ic</a></div><div class="ttdeci">integer max_nibool_interfaces_ic</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00524">meshfem3D_par.f90:524</a></div></div>
<div class="ttc" id="structmesh___html_a859a2daf33c0b38f58a4523d6c271ba5"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a859a2daf33c0b38f58a4523d6c271ba5">mesh_::d_c66store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c66store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00435">mesh_constants_gpu.h:435</a></div></div>
<div class="ttc" id="initialize__gpu_8c_html_aec81bc3c382c07b26888476c335d6e47"><div class="ttname"><a href="../../d9/d76/initialize__gpu_8c.html#aec81bc3c382c07b26888476c335d6e47">run_opencl</a></div><div class="ttdeci">int run_opencl</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d76/initialize__gpu_8c_source.html#l00081">initialize_gpu.c:81</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a4b4462798cc3fff4ebf03c2791c8f826"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a4b4462798cc3fff4ebf03c2791c8f826">create_regions_mesh_par2::c35store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c35store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a364acd2e368b9cbc7bc0d4cb6de758c5"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a364acd2e368b9cbc7bc0d4cb6de758c5">specfem_par_crustmantle::nkmin_eta_crust_mantle</a></div><div class="ttdeci">integer, dimension(:,:), allocatable nkmin_eta_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00599">specfem3D_par.F90:599</a></div></div>
<div class="ttc" id="structmesh___html_a5e1239a68ee582004c95479540a03f20"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a5e1239a68ee582004c95479540a03f20">mesh_::d_b_send_accel_buffer_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_send_accel_buffer_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00820">mesh_constants_gpu.h:820</a></div></div>
<div class="ttc" id="structmesh___html_a4fcc1869ac2e6f07350f13edc4914e8d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4fcc1869ac2e6f07350f13edc4914e8d">mesh_::d_normal_x_noise</a></div><div class="ttdeci">gpu_realw_mem d_normal_x_noise</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00904">mesh_constants_gpu.h:904</a></div></div>
<div class="ttc" id="structmesh___html_ae16c1bcebb2111e6fda79f0a4efcaa8c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae16c1bcebb2111e6fda79f0a4efcaa8c">mesh_::d_cijkl_kl_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_cijkl_kl_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00482">mesh_constants_gpu.h:482</a></div></div>
<div class="ttc" id="structmesh___html_a30f1cbb0e80d6839e5243e28874c2c55"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a30f1cbb0e80d6839e5243e28874c2c55">mesh_::d_sourcearrays</a></div><div class="ttdeci">gpu_realw_mem d_sourcearrays</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00772">mesh_constants_gpu.h:772</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a8a0f3bd5734e22a81d6ff8899cda25dd"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a8a0f3bd5734e22a81d6ff8899cda25dd">specfem_par_crustmantle::ibelm_ymin_crust_mantle</a></div><div class="ttdeci">integer, dimension(:), allocatable ibelm_ymin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00572">specfem3D_par.F90:572</a></div></div>
<div class="ttc" id="structmesh___html_a4e59bc60eb3d74bd40b8a844e47fe65f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4e59bc60eb3d74bd40b8a844e47fe65f">mesh_::d_b_accel_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_accel_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00619">mesh_constants_gpu.h:619</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a0c24836ef860cb23b2e7dabbb3557cdc"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a0c24836ef860cb23b2e7dabbb3557cdc">specfem_par_crustmantle::normal_xmax_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable normal_xmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00585">specfem3D_par.F90:585</a></div></div>
<div class="ttc" id="structmesh___html_a26173243f6a3b795521c5b7bb7918d86"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a26173243f6a3b795521c5b7bb7918d86">mesh_::d_c13store_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_c13store_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00607">mesh_constants_gpu.h:607</a></div></div>
<div class="ttc" id="structmesh___html_ae81fd851d70948d0a2c1957a1229ce22"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae81fd851d70948d0a2c1957a1229ce22">mesh_::d_xiz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_xiz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00577">mesh_constants_gpu.h:577</a></div></div>
<div class="ttc" id="structmesh___html_a04f370729e3340a4e6dee2cacc96e3f6"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a04f370729e3340a4e6dee2cacc96e3f6">mesh_::d_xiy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_xiy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00576">mesh_constants_gpu.h:576</a></div></div>
<div class="ttc" id="structmesh___html_ab2427c5b309fdc32ea4bda0759b8e6c5"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab2427c5b309fdc32ea4bda0759b8e6c5">mesh_::d_station_seismo_field</a></div><div class="ttdeci">gpu_realw_mem d_station_seismo_field</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00786">mesh_constants_gpu.h:786</a></div></div>
<div class="ttc" id="structmesh___html_ac97a6a9f3465602c2c26876f69fc16d8"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac97a6a9f3465602c2c26876f69fc16d8">mesh_::d_b_rmassz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_rmassz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00405">mesh_constants_gpu.h:405</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a05201d163c28cb39c5ce9a1fd294cc5f"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a05201d163c28cb39c5ce9a1fd294cc5f">create_regions_mesh_par2::c24store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c24store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_afdf7cf23bc7ee59e527aa8e17fc745ad"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#afdf7cf23bc7ee59e527aa8e17fc745ad">specfem_par_crustmantle::ibelm_xmax_crust_mantle</a></div><div class="ttdeci">integer, dimension(:), allocatable ibelm_xmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00571">specfem3D_par.F90:571</a></div></div>
<div class="ttc" id="structmesh___html_a4a3991d9942ffeceaf8ea5cb2610fcd9"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4a3991d9942ffeceaf8ea5cb2610fcd9">mesh_::d_rmassz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_rmassz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00592">mesh_constants_gpu.h:592</a></div></div>
<div class="ttc" id="structmesh___html_a2e6fb83ecd9001f5d664ec0839f57972"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2e6fb83ecd9001f5d664ec0839f57972">mesh_::d_c34store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c34store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00427">mesh_constants_gpu.h:427</a></div></div>
<div class="ttc" id="structmesh___html_ab027bfc3485ed571028a1d35c9b2627d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab027bfc3485ed571028a1d35c9b2627d">mesh_::d_b_alphaval</a></div><div class="ttdeci">gpu_realw_mem d_b_alphaval</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00688">mesh_constants_gpu.h:688</a></div></div>
<div class="ttc" id="structmesh___html_a766c20bb0f862bcb9fda52d216baf266"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a766c20bb0f862bcb9fda52d216baf266">mesh_::d_wgllwgll_yz</a></div><div class="ttdeci">gpu_realw_mem d_wgllwgll_yz</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00707">mesh_constants_gpu.h:707</a></div></div>
<div class="ttc" id="structmesh___html_aa8b367229b0357f2ffc995ceb1481b59"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa8b367229b0357f2ffc995ceb1481b59">mesh_::d_hprime_xx</a></div><div class="ttdeci">gpu_realw_mem d_hprime_xx</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00697">mesh_constants_gpu.h:697</a></div></div>
<div class="ttc" id="structmesh___html_a17d12485a91230278ccf687c0aa23aaa"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a17d12485a91230278ccf687c0aa23aaa">mesh_::d_b_R_xz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_R_xz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00457">mesh_constants_gpu.h:457</a></div></div>
<div class="ttc" id="structmesh___html_a2ae8526e691dad242929cab1f68bcff1"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2ae8526e691dad242929cab1f68bcff1">mesh_::d_kappavstore_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_kappavstore_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00393">mesh_constants_gpu.h:393</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_af7e6ace16498f264a480ea2ede9e05a7"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#af7e6ace16498f264a480ea2ede9e05a7">specfem_par_crustmantle::epsilondev_yz_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_yz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00552">specfem3D_par.F90:552</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_ace0b4aaf3060b64372a065ed869a39f9"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#ace0b4aaf3060b64372a065ed869a39f9">specfem_par::minus_gravity_table</a></div><div class="ttdeci">double precision, dimension(nrad_gravity) minus_gravity_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00255">specfem3D_par.F90:255</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_aff169512faceffc002e35364eba59ce8"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#aff169512faceffc002e35364eba59ce8">specfem_par::b_gammaval</a></div><div class="ttdeci">real(kind=custom_real), dimension(n_sls) b_gammaval</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00209">specfem3D_par.F90:209</a></div></div>
<div class="ttc" id="structmesh___html_a74999f45582b040260ce031e39e99a18"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a74999f45582b040260ce031e39e99a18">mesh_::d_rstore_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_rstore_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00602">mesh_constants_gpu.h:602</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_af98fcd4418d36de4a401b9e81df1ce88"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#af98fcd4418d36de4a401b9e81df1ce88">gpuTakeRef</a></div><div class="ttdeci">#define gpuTakeRef(_buffer_)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l01066">mesh_constants_gpu.h:1066</a></div></div>
<div class="ttc" id="structmesh___html_af8362e581318c8faf5265f30196c08f4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af8362e581318c8faf5265f30196c08f4">mesh_::d_ibelm_bottom_outer_core</a></div><div class="ttdeci">gpu_int_mem d_ibelm_bottom_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00557">mesh_constants_gpu.h:557</a></div></div>
<div class="ttc" id="structmesh___html_a5b4a2d8806c451c2d7260656c7fa4574"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a5b4a2d8806c451c2d7260656c7fa4574">mesh_::d_etay_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_etay_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00385">mesh_constants_gpu.h:385</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a84cd50adbc76914ab50f01f587c9b4bf"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a84cd50adbc76914ab50f01f587c9b4bf">specfem_par::density_table</a></div><div class="ttdeci">double precision, dimension(nrad_gravity) density_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00255">specfem3D_par.F90:255</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_aa07a58e7b163d2a0a1e02957218dedd2"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#aa07a58e7b163d2a0a1e02957218dedd2">gpuReset</a></div><div class="ttdeci">void gpuReset()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00458">helper_functions_gpu.c:458</a></div></div>
<div class="ttc" id="structmesh___html_a0a443e256fbf33b2286fda44d44b407a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0a443e256fbf33b2286fda44d44b407a">mesh_::d_c55store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c55store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00433">mesh_constants_gpu.h:433</a></div></div>
<div class="ttc" id="structmesh___html_a15ae83652e680fc48864f8f787eb3960"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a15ae83652e680fc48864f8f787eb3960">mesh_::use_lddrk</a></div><div class="ttdeci">int use_lddrk</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l01013">mesh_constants_gpu.h:1013</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a57286a1a83f8909a008f5353c8cebe0d"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a57286a1a83f8909a008f5353c8cebe0d">specfem_par_crustmantle::b_epsilondev_xx_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_xx_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00563">specfem3D_par.F90:563</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a3c173838807a44c10e8bd7a682c9a006"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a3c173838807a44c10e8bd7a682c9a006">specfem_par_crustmantle::factor_common_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:,:), allocatable factor_common_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00546">specfem3D_par.F90:546</a></div></div>
<div class="ttc" id="structmesh___html_a4a8021ab98bb29218f3a1de0a3e33d76"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4a8021ab98bb29218f3a1de0a3e33d76">mesh_::d_c23store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c23store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00422">mesh_constants_gpu.h:422</a></div></div>
<div class="ttc" id="structmesh___html_ab7ee7f4d8000df05047d76d8324e8ede"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab7ee7f4d8000df05047d76d8324e8ede">mesh_::d_normal_y_noise</a></div><div class="ttdeci">gpu_realw_mem d_normal_y_noise</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00905">mesh_constants_gpu.h:905</a></div></div>
<div class="ttc" id="structmesh___html_a04812b8c4b78841c86582c6a4c6aa6d4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a04812b8c4b78841c86582c6a4c6aa6d4">mesh_::d_c15store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c15store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00419">mesh_constants_gpu.h:419</a></div></div>
<div class="ttc" id="structmesh___html_ae5ce7e58987a20afe4bf0d93ced01e45"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae5ce7e58987a20afe4bf0d93ced01e45">mesh_::d_jacobian2D_xmax_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_xmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00855">mesh_constants_gpu.h:855</a></div></div>
<div class="ttc" id="structmesh___html_af22d056ba319fd172ad524859fa8f4a8"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af22d056ba319fd172ad524859fa8f4a8">mesh_::d_displ_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_displ_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00613">mesh_constants_gpu.h:613</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a32c39df330bd0bda579e675ae95d562a"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a32c39df330bd0bda579e675ae95d562a">specfem_par::b_alphaval</a></div><div class="ttdeci">real(kind=custom_real), dimension(n_sls) b_alphaval</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00209">specfem3D_par.F90:209</a></div></div>
<div class="ttc" id="structmesh___html_a949afc03c8658efa0641aa0988db12dc"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a949afc03c8658efa0641aa0988db12dc">mesh_::d_ispec_is_tiso_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ispec_is_tiso_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00409">mesh_constants_gpu.h:409</a></div></div>
<div class="ttc" id="structmesh___html_a23bfd0da9ad8e1eddd0ab0869a661b49"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a23bfd0da9ad8e1eddd0ab0869a661b49">mesh_::d_etay_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_etay_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00579">mesh_constants_gpu.h:579</a></div></div>
<div class="ttc" id="structmesh___html_ac9d70f575e0ea3105d11764317e9ae6d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac9d70f575e0ea3105d11764317e9ae6d">mesh_::d_rhostore_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_rhostore_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00517">mesh_constants_gpu.h:517</a></div></div>
<div class="ttc" id="structmesh___html_afab61e54de1beb22aca30d02d54580fc"><div class="ttname"><a href="../../d2/d88/structmesh__.html#afab61e54de1beb22aca30d02d54580fc">mesh_::num_colors_outer_crust_mantle</a></div><div class="ttdeci">int num_colors_outer_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00494">mesh_constants_gpu.h:494</a></div></div>
<div class="ttc" id="structmesh___html_a0d0410d090f288c0edc270d315e5cf94"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0d0410d090f288c0edc270d315e5cf94">mesh_::d_alpha_kl_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_alpha_kl_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00541">mesh_constants_gpu.h:541</a></div></div>
<div class="ttc" id="structmesh___html_a74dea8a7b542a54c994df906d0d6ff20"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a74dea8a7b542a54c994df906d0d6ff20">mesh_::exact_mass_matrix_for_rotation</a></div><div class="ttdeci">int exact_mass_matrix_for_rotation</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00730">mesh_constants_gpu.h:730</a></div></div>
<div class="ttc" id="structmesh___html_a69fb33bf716b90b1961381ac440e2f97"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a69fb33bf716b90b1961381ac440e2f97">mesh_::d_beta_kl_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_beta_kl_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00481">mesh_constants_gpu.h:481</a></div></div>
<div class="ttc" id="structmesh___html_add66897c42cd7511d8b0c766f834c4b3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#add66897c42cd7511d8b0c766f834c4b3">mesh_::b_two_omega_earth</a></div><div class="ttdeci">realw b_two_omega_earth</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00764">mesh_constants_gpu.h:764</a></div></div>
<div class="ttc" id="struct__mesh__opencl_html_a5a151439ee2627fa5d7fce0e31273617"><div class="ttname"><a href="../../d9/df0/struct__mesh__opencl.html#a5a151439ee2627fa5d7fce0e31273617">_mesh_opencl::copy_queue</a></div><div class="ttdeci">cl_command_queue copy_queue</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d29/mesh__constants__ocl_8h_source.html#l00139">mesh_constants_ocl.h:139</a></div></div>
<div class="ttc" id="structmesh___html_a78eeb1e93b7dbb4a4b3d5592f4f9934e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a78eeb1e93b7dbb4a4b3d5592f4f9934e">mesh_::d_nimax_outer_core</a></div><div class="ttdeci">gpu_int_mem d_nimax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00872">mesh_constants_gpu.h:872</a></div></div>
<div class="ttc" id="structmesh___html_ad0365e780c05698da68d9b14fd4f4d9d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad0365e780c05698da68d9b14fd4f4d9d">mesh_::rotation</a></div><div class="ttdeci">int rotation</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00729">mesh_constants_gpu.h:729</a></div></div>
<div class="ttc" id="structmesh___html_ab92f56d46a7c7f8748d26d17290d20a0"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab92f56d46a7c7f8748d26d17290d20a0">mesh_::d_factor_common_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_factor_common_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00634">mesh_constants_gpu.h:634</a></div></div>
<div class="ttc" id="structmesh___html_aad2a78ccebd992954ad9b469e3249096"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aad2a78ccebd992954ad9b469e3249096">mesh_::d_gammax_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_gammax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00512">mesh_constants_gpu.h:512</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_a03d7c31905d6ab2bafe21f6998f466aa"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#a03d7c31905d6ab2bafe21f6998f466aa">specfem_par_outercore::nkmin_eta_outer_core</a></div><div class="ttdeci">integer, dimension(:,:), allocatable nkmin_eta_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00847">specfem3D_par.F90:847</a></div></div>
<div class="ttc" id="structmesh___html_a2f86a4c9e96828b680b7e1e26a83abfb"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2f86a4c9e96828b680b7e1e26a83abfb">mesh_::d_b_rmass_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_b_rmass_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00521">mesh_constants_gpu.h:521</a></div></div>
<div class="ttc" id="structmesh___html_ad42a2d9a362bbea93e1f541684da6f78"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad42a2d9a362bbea93e1f541684da6f78">mesh_::d_b_rmassz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_rmassz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00595">mesh_constants_gpu.h:595</a></div></div>
<div class="ttc" id="structmesh___html_a6367a6f4d15c8ddcb3ea3542b9c8ac1a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6367a6f4d15c8ddcb3ea3542b9c8ac1a">mesh_::d_c44store_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_c44store_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00609">mesh_constants_gpu.h:609</a></div></div>
<div class="ttc" id="structmesh___html_a738d24d6134b050eb391132067af7798"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a738d24d6134b050eb391132067af7798">mesh_::d_etaz_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_etaz_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00511">mesh_constants_gpu.h:511</a></div></div>
<div class="ttc" id="structmesh___html_acf669d6085c50bd730e42c4f53047db9"><div class="ttname"><a href="../../d2/d88/structmesh__.html#acf669d6085c50bd730e42c4f53047db9">mesh_::d_xiy_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_xiy_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00507">mesh_constants_gpu.h:507</a></div></div>
<div class="ttc" id="structmesh___html_ae76c60914b944131d687ecb85b337835"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae76c60914b944131d687ecb85b337835">mesh_::d_alphaval</a></div><div class="ttdeci">gpu_realw_mem d_alphaval</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00684">mesh_constants_gpu.h:684</a></div></div>
<div class="ttc" id="structmesh___html_a0862a18cddae6423e721dacab974e93e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0862a18cddae6423e721dacab974e93e">mesh_::d_c35store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c35store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00428">mesh_constants_gpu.h:428</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a2cd8b81e24d392b78d39dc30d4181e81"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a2cd8b81e24d392b78d39dc30d4181e81">specfem_par::alphaval</a></div><div class="ttdeci">real(kind=custom_real), dimension(n_sls) alphaval</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00207">specfem3D_par.F90:207</a></div></div>
<div class="ttc" id="structmesh___html_a69d60ae1c90efdc57064c7c37dbfea43"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a69d60ae1c90efdc57064c7c37dbfea43">mesh_::nsources_local</a></div><div class="ttdeci">int nsources_local</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00771">mesh_constants_gpu.h:771</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_af868e4fb902404c57716fed4050b0e50"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#af868e4fb902404c57716fed4050b0e50">specfem_par_crustmantle::b_eps_trace_over_3_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_eps_trace_over_3_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00567">specfem3D_par.F90:567</a></div></div>
<div class="ttc" id="structmesh___html_a68ec59ad595287935c7e02fdda8e5913"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a68ec59ad595287935c7e02fdda8e5913">mesh_::d_b_veloc_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_b_veloc_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00536">mesh_constants_gpu.h:536</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a1e2fd791527963786436e3b3c1fa473f"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a1e2fd791527963786436e3b3c1fa473f">create_regions_mesh_par2::c45store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c45store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_aaeb71d1a82c9f5660f89cae589ff14b1"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aaeb71d1a82c9f5660f89cae589ff14b1">mesh_::d_ibelm_xmin_outer_core</a></div><div class="ttdeci">gpu_int_mem d_ibelm_xmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00878">mesh_constants_gpu.h:878</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_aa43762d4e89d7edfd94cd9e36002ae69"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#aa43762d4e89d7edfd94cd9e36002ae69">specfem_par_crustmantle::normal_xmin_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable normal_xmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00585">specfem3D_par.F90:585</a></div></div>
<div class="ttc" id="structmesh___html_ada3d32d67768986408c59934ae3419ff"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ada3d32d67768986408c59934ae3419ff">mesh_::d_epsilondev_yy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_yy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00464">mesh_constants_gpu.h:464</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_ab33f78a3524ed71bd229ef29961c30e5"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#ab33f78a3524ed71bd229ef29961c30e5">specfem_par_innercore::b_epsilondev_xz_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_xz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00742">specfem3D_par.F90:742</a></div></div>
<div class="ttc" id="structmesh___html_a6efbdbbf072565c01800e39dee48cae6"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6efbdbbf072565c01800e39dee48cae6">mesh_::anisotropic_kl</a></div><div class="ttdeci">int anisotropic_kl</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00735">mesh_constants_gpu.h:735</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_ada2b3c6ed5b544b7585d9540c134c6f9"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#ada2b3c6ed5b544b7585d9540c134c6f9">MAX</a></div><div class="ttdeci">#define MAX(x, y)                                </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00131">mesh_constants_gpu.h:131</a></div></div>
<div class="ttc" id="structmesh___html_a2741c23333476745f033741e5d4c2ff2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2741c23333476745f033741e5d4c2ff2">mesh_::d_veloc_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_veloc_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00532">mesh_constants_gpu.h:532</a></div></div>
<div class="ttc" id="structmesh___html_a3afb06a4b056fa58dce2f637d3f7f099"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3afb06a4b056fa58dce2f637d3f7f099">mesh_::d_rho_kl_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_rho_kl_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00479">mesh_constants_gpu.h:479</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a2e141d2dc4a3ec334e819645e1e2dfb6"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a2e141d2dc4a3ec334e819645e1e2dfb6">specfem_par_crustmantle::normal_ymin_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable normal_ymin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00587">specfem3D_par.F90:587</a></div></div>
<div class="ttc" id="structmesh___html_afd905bb6aa0bd951e0f97931f14dcaf2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#afd905bb6aa0bd951e0f97931f14dcaf2">mesh_::d_R_yy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_R_yy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00623">mesh_constants_gpu.h:623</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_ad94b01dc9602909a802e23bb09272b4f"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#ad94b01dc9602909a802e23bb09272b4f">DEBUG_BACKWARD_SIMULATIONS</a></div><div class="ttdeci">#define DEBUG_BACKWARD_SIMULATIONS</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00096">mesh_constants_gpu.h:96</a></div></div>
<div class="ttc" id="structmesh___html_a6773cb1c7acc2a72b62e9567dc8f07c3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6773cb1c7acc2a72b62e9567dc8f07c3">mesh_::nrec_local</a></div><div class="ttdeci">int nrec_local</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00784">mesh_constants_gpu.h:784</a></div></div>
<div class="ttc" id="structmesh___html_a3238ddad7629b5a91162df8e7159a453"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3238ddad7629b5a91162df8e7159a453">mesh_::oceans</a></div><div class="ttdeci">int oceans</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00731">mesh_constants_gpu.h:731</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_a3b0e807f26ec763964da61255548f5d5"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#a3b0e807f26ec763964da61255548f5d5">gpuSetConst</a></div><div class="ttdeci">void gpuSetConst(gpu_realw_mem *buffer, size_t size, realw *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00373">helper_functions_gpu.c:373</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_abe78859dd304b9e1b6fdf86ca238f35a"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#abe78859dd304b9e1b6fdf86ca238f35a">BLOCKSIZE_TRANSFER</a></div><div class="ttdeci">#define BLOCKSIZE_TRANSFER</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00258">mesh_constants_gpu.h:258</a></div></div>
<div class="ttc" id="structmesh___html_a454a8bfca214d6368fe31beb162a1ee2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a454a8bfca214d6368fe31beb162a1ee2">mesh_::d_vp_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_vp_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00894">mesh_constants_gpu.h:894</a></div></div>
<div class="ttc" id="structmesh___html_a3775d6785cfdf260464cd71d9d844146"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3775d6785cfdf260464cd71d9d844146">mesh_::h_recv_accel_buffer_ic</a></div><div class="ttdeci">float * h_recv_accel_buffer_ic</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00932">mesh_constants_gpu.h:932</a></div></div>
<div class="ttc" id="structmesh___html_a32d4d6fdda9286ae349655e14183f22c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a32d4d6fdda9286ae349655e14183f22c">mesh_::d_c46store_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_c46store_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00432">mesh_constants_gpu.h:432</a></div></div>
<div class="ttc" id="structmesh___html_adc64359edf2a87893eddd4cf5cf6fce4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#adc64359edf2a87893eddd4cf5cf6fce4">mesh_::d_wgllwgll_xy</a></div><div class="ttdeci">gpu_realw_mem d_wgllwgll_xy</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00705">mesh_constants_gpu.h:705</a></div></div>
<div class="ttc" id="structmesh___html_a55fbd1bbfa6cf28a2acc529596a91c1a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a55fbd1bbfa6cf28a2acc529596a91c1a">mesh_::d_njmax_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_njmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00840">mesh_constants_gpu.h:840</a></div></div>
<div class="ttc" id="structmesh___html_a547020fd4ab267b0ac494d1a50bae7a4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a547020fd4ab267b0ac494d1a50bae7a4">mesh_::nspec2D_bottom_crust_mantle</a></div><div class="ttdeci">int nspec2D_bottom_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00491">mesh_constants_gpu.h:491</a></div></div>
<div class="ttc" id="structmesh___html_a93d94d0c3537c00eafd8c556e846ac24"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a93d94d0c3537c00eafd8c556e846ac24">mesh_::d_absorb_ymax_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_absorb_ymax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00862">mesh_constants_gpu.h:862</a></div></div>
<div class="ttc" id="structmesh___html_ad5e42fcf68a2053965029c0725c5305f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad5e42fcf68a2053965029c0725c5305f">mesh_::d_R_xx_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_R_xx_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00622">mesh_constants_gpu.h:622</a></div></div>
<div class="ttc" id="structmesh___html_add67861d6106aea8784d1998c5f1bf9d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#add67861d6106aea8784d1998c5f1bf9d">mesh_::gravity</a></div><div class="ttdeci">int gravity</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00728">mesh_constants_gpu.h:728</a></div></div>
<div class="ttc" id="namespacespecfem__par__noise_html_ad3d307ee10a95627fdf10e1ad22eeaaf"><div class="ttname"><a href="../../df/daf/namespacespecfem__par__noise.html#ad3d307ee10a95627fdf10e1ad22eeaaf">specfem_par_noise::mask_noise</a></div><div class="ttdeci">real(kind=custom_real), dimension(:), allocatable mask_noise</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00917">specfem3D_par.F90:917</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_ac3e2ddf13e6efcb60714ca22a0d7700c"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#ac3e2ddf13e6efcb60714ca22a0d7700c">specfem_par_innercore::one_minus_sum_beta_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable one_minus_sum_beta_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00723">specfem3D_par.F90:723</a></div></div>
<div class="ttc" id="structmesh___html_aa81ead1f92ffef0fc9e45606814e606c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa81ead1f92ffef0fc9e45606814e606c">mesh_::d_epsilondev_xz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_xz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00466">mesh_constants_gpu.h:466</a></div></div>
<div class="ttc" id="structmesh___html_ad00c7054f9b86752da332b155d9fb6ac"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad00c7054f9b86752da332b155d9fb6ac">mesh_::h_send_accel_buffer_cm</a></div><div class="ttdeci">float * h_send_accel_buffer_cm</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00925">mesh_constants_gpu.h:925</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_acb2f0d4538838c2fcf191413299fa575"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#acb2f0d4538838c2fcf191413299fa575">specfem_par_innercore::epsilondev_yz_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_yz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00731">specfem3D_par.F90:731</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a38961824aaad27e3fa5ce407c223a2c2"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a38961824aaad27e3fa5ce407c223a2c2">create_regions_mesh_par2::c22store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c22store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_ab289e448fd708ebd6595ddbea46258ba"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#ab289e448fd708ebd6595ddbea46258ba">gpuMalloc_double</a></div><div class="ttdeci">void gpuMalloc_double(gpu_double_mem *buffer, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00311">helper_functions_gpu.c:311</a></div></div>
<div class="ttc" id="structmesh___html_aacc2e11571b37a3cc4ad76f7a29c29ed"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aacc2e11571b37a3cc4ad76f7a29c29ed">mesh_::max_nibool_interfaces_cm</a></div><div class="ttdeci">int max_nibool_interfaces_cm</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00807">mesh_constants_gpu.h:807</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_aa436134d42e4e7b7684eb61dd9199c4e"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#aa436134d42e4e7b7684eb61dd9199c4e">specfem_par::minus_rho_g_over_kappa_fluid</a></div><div class="ttdeci">double precision, dimension(nrad_gravity) minus_rho_g_over_kappa_fluid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00255">specfem3D_par.F90:255</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a65372d15af5c744589c43c0ececc38cb"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a65372d15af5c744589c43c0ececc38cb">NGLL3</a></div><div class="ttdeci">#define NGLL3</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00144">mesh_constants_gpu.h:144</a></div></div>
<div class="ttc" id="structmesh___html_a0f86cbc257331ac61ed26e5c223bcd46"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0f86cbc257331ac61ed26e5c223bcd46">mesh_::num_colors_inner_inner_core</a></div><div class="ttdeci">int num_colors_inner_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00665">mesh_constants_gpu.h:665</a></div></div>
<div class="ttc" id="structmesh___html_aaf14856a459a08f33ded6e6664a2d257"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aaf14856a459a08f33ded6e6664a2d257">mesh_::d_beta_kl_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_beta_kl_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00655">mesh_constants_gpu.h:655</a></div></div>
<div class="ttc" id="structmesh___html_a2474e65348de287385f1783d08757635"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2474e65348de287385f1783d08757635">mesh_::d_minus_gravity_table</a></div><div class="ttdeci">gpu_realw_mem d_minus_gravity_table</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00746">mesh_constants_gpu.h:746</a></div></div>
<div class="ttc" id="mesh__constants__ocl_8h_html_a886ad808ec7e1705e089662b0dae1b47"><div class="ttname"><a href="../../dc/d29/mesh__constants__ocl_8h.html#a886ad808ec7e1705e089662b0dae1b47">ALLOC_PINNED_BUFFER_OCL</a></div><div class="ttdeci">#define ALLOC_PINNED_BUFFER_OCL(_buffer_, _size_)                                                          </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d29/mesh__constants__ocl_8h_source.html#l00067">mesh_constants_ocl.h:67</a></div></div>
<div class="ttc" id="structmesh___html_a49b82d07189347243be39b7f3ac673ac"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a49b82d07189347243be39b7f3ac673ac">mesh_::d_rmassy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_rmassy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00401">mesh_constants_gpu.h:401</a></div></div>
<div class="ttc" id="structmesh___html_ac8e0ee203263170c071b14a1a2b90f68"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac8e0ee203263170c071b14a1a2b90f68">mesh_::d_normal_z_noise</a></div><div class="ttdeci">gpu_realw_mem d_normal_z_noise</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00906">mesh_constants_gpu.h:906</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_abb14b77aa330fd5260ab816f856447e4"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#abb14b77aa330fd5260ab816f856447e4">create_regions_mesh_par2::c56store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c56store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_ab629dcee54f251fa33c897da1fc0e4a3"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab629dcee54f251fa33c897da1fc0e4a3">mesh_::d_b_R_yy_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_R_yy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00629">mesh_constants_gpu.h:629</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_af51bb5088c83df67979f2df0be588ead"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#af51bb5088c83df67979f2df0be588ead">specfem_par::nadj_rec_local</a></div><div class="ttdeci">integer nadj_rec_local</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00302">specfem3D_par.F90:302</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a1f027733ff6e07c3fccf53c9bded89b4"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a1f027733ff6e07c3fccf53c9bded89b4">specfem_par_crustmantle::rho_vp_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable rho_vp_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00595">specfem3D_par.F90:595</a></div></div>
<div class="ttc" id="structmesh___html_a666ace38b302f6cf2b04f50d89cc4c13"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a666ace38b302f6cf2b04f50d89cc4c13">mesh_::NGLOB_CRUST_MANTLE</a></div><div class="ttdeci">int NGLOB_CRUST_MANTLE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00377">mesh_constants_gpu.h:377</a></div></div>
<div class="ttc" id="structmesh___html_ad17b618ef4424736feef1e0a7536f299"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad17b618ef4424736feef1e0a7536f299">mesh_::d_R_xy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_R_xy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00450">mesh_constants_gpu.h:450</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_ad1e88500ba5ca47f77908018f53d4a3b"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#ad1e88500ba5ca47f77908018f53d4a3b">specfem_par_outercore::vp_outer_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable vp_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00843">specfem3D_par.F90:843</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a66151b800b1fe6fb45038503e36732f4"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a66151b800b1fe6fb45038503e36732f4">specfem_par_innercore::b_epsilondev_yz_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_yz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00742">specfem3D_par.F90:742</a></div></div>
<div class="ttc" id="namespacespecfem__par__outercore_html_a4f45cf7e4bb3adbd6a6e7164d65955c5"><div class="ttname"><a href="../../d8/d0a/namespacespecfem__par__outercore.html#a4f45cf7e4bb3adbd6a6e7164d65955c5">specfem_par_outercore::ibelm_xmax_outer_core</a></div><div class="ttdeci">integer, dimension(:), allocatable ibelm_xmax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00862">specfem3D_par.F90:862</a></div></div>
<div class="ttc" id="structmesh___html_a642a63f522d93d71785abff97b045023"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a642a63f522d93d71785abff97b045023">mesh_::d_absorb_zmin_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_absorb_zmin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00892">mesh_constants_gpu.h:892</a></div></div>
<div class="ttc" id="structmesh___html_a828f870e9738bb778920e6cbb4e27c26"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a828f870e9738bb778920e6cbb4e27c26">mesh_::d_R_yy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_R_yy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00449">mesh_constants_gpu.h:449</a></div></div>
<div class="ttc" id="structmesh___html_a4ba3bc5cb5d83c7cf3a2529690972cf6"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a4ba3bc5cb5d83c7cf3a2529690972cf6">mesh_::d_stf_pre_compute</a></div><div class="ttdeci">gpu_double_mem d_stf_pre_compute</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00773">mesh_constants_gpu.h:773</a></div></div>
<div class="ttc" id="structmesh___html_af1e280d7cac724ded01c9fde7e8d0fb9"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af1e280d7cac724ded01c9fde7e8d0fb9">mesh_::h_recv_accel_buffer_oc</a></div><div class="ttdeci">float * h_recv_accel_buffer_oc</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00938">mesh_constants_gpu.h:938</a></div></div>
<div class="ttc" id="structmesh___html_a6640e89ba1dbf1f52a8476299245e61c"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a6640e89ba1dbf1f52a8476299245e61c">mesh_::d_rho_vp_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_rho_vp_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00864">mesh_constants_gpu.h:864</a></div></div>
<div class="ttc" id="structmesh___html_a2a199944453a6af45db111791ae31c60"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a2a199944453a6af45db111791ae31c60">mesh_::d_b_veloc_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_b_veloc_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00618">mesh_constants_gpu.h:618</a></div></div>
<div class="ttc" id="structmesh___html_a14fd55b5867c389cf8eaa4cddc762414"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a14fd55b5867c389cf8eaa4cddc762414">mesh_::d_xix_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_xix_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00506">mesh_constants_gpu.h:506</a></div></div>
<div class="ttc" id="structmesh___html_ab8b7290c20ec523f02714afef5d2ae9b"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ab8b7290c20ec523f02714afef5d2ae9b">mesh_::npoin_oceans</a></div><div class="ttdeci">int npoin_oceans</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00674">mesh_constants_gpu.h:674</a></div></div>
<div class="ttc" id="structmesh___html_ad010d00c166f1bdef85447a5e3cae3b2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad010d00c166f1bdef85447a5e3cae3b2">mesh_::d_normal_xmax_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_normal_xmax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00850">mesh_constants_gpu.h:850</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_a6461e21c463af6a48e63e38db555b33a"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#a6461e21c463af6a48e63e38db555b33a">create_regions_mesh_par2::c46store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c46store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_a0cde8155ceae21df90dfd8765f9088cd"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a0cde8155ceae21df90dfd8765f9088cd">mesh_::d_gammay_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_gammay_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00513">mesh_constants_gpu.h:513</a></div></div>
<div class="ttc" id="structmesh___html_ac2e444710777a5041eb42090670a8b66"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac2e444710777a5041eb42090670a8b66">mesh_::d_b_eps_trace_over_3_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_eps_trace_over_3_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00476">mesh_constants_gpu.h:476</a></div></div>
<div class="ttc" id="structmesh___html_aae418083893e4d5380e5d70dfa866216"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aae418083893e4d5380e5d70dfa866216">mesh_::d_gammaz_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_gammaz_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00514">mesh_constants_gpu.h:514</a></div></div>
<div class="ttc" id="structmesh___html_a11faf67dc86f02ce860e3f7add840c48"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a11faf67dc86f02ce860e3f7add840c48">mesh_::d_b_R_yz_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_R_yz_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00458">mesh_constants_gpu.h:458</a></div></div>
<div class="ttc" id="structmesh___html_a862349f3ee6655dcdefea1d0364dd9a4"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a862349f3ee6655dcdefea1d0364dd9a4">mesh_::d_R_xz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_R_xz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00625">mesh_constants_gpu.h:625</a></div></div>
<div class="ttc" id="structmesh___html_abd7c1e2df1ee271fc1a47a836bd793b2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#abd7c1e2df1ee271fc1a47a836bd793b2">mesh_::d_ibelm_top_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ibelm_top_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00911">mesh_constants_gpu.h:911</a></div></div>
<div class="ttc" id="structmesh___html_af1cbf8d247b6322765f8594d632a29b2"><div class="ttname"><a href="../../d2/d88/structmesh__.html#af1cbf8d247b6322765f8594d632a29b2">mesh_::NSPEC_CRUST_MANTLE</a></div><div class="ttdeci">int NSPEC_CRUST_MANTLE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00376">mesh_constants_gpu.h:376</a></div></div>
<div class="ttc" id="structmesh___html_ad9e462351ccee130beebd8093a452104"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad9e462351ccee130beebd8093a452104">mesh_::d_etaz_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_etaz_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00580">mesh_constants_gpu.h:580</a></div></div>
<div class="ttc" id="structmesh___html_a072bba99783be461d8b275af3bf203b0"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a072bba99783be461d8b275af3bf203b0">mesh_::d_phase_ispec_inner_outer_core</a></div><div class="ttdeci">gpu_int_mem d_phase_ispec_inner_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00544">mesh_constants_gpu.h:544</a></div></div>
<div class="ttc" id="structmesh___html_a516bcef456f2739884b6a6291096ef35"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a516bcef456f2739884b6a6291096ef35">mesh_::d_accel_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_accel_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00615">mesh_constants_gpu.h:615</a></div></div>
<div class="ttc" id="namespacespecfem__par_html_a78c92555ba8fd54f19470d4a9ea247ea"><div class="ttname"><a href="../../db/da6/namespacespecfem__par.html#a78c92555ba8fd54f19470d4a9ea247ea">specfem_par::minus_g_cmb</a></div><div class="ttdeci">real(kind=custom_real) minus_g_cmb</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00254">specfem3D_par.F90:254</a></div></div>
<div class="ttc" id="structmesh___html_ae1cec79cc3c64d136833423748e8fd8d"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae1cec79cc3c64d136833423748e8fd8d">mesh_::anisotropic_inner_core</a></div><div class="ttdeci">int anisotropic_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00732">mesh_constants_gpu.h:732</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a1e407271576ba63e071560e85e1e2dba"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a1e407271576ba63e071560e85e1e2dba">GPU_ASYNC_COPY</a></div><div class="ttdeci">#define GPU_ASYNC_COPY</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00170">mesh_constants_gpu.h:170</a></div></div>
<div class="ttc" id="structmesh___html_ac2da2b9c51ef05597ebf07887beb0514"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac2da2b9c51ef05597ebf07887beb0514">mesh_::d_absorb_xmax_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_absorb_xmax_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00889">mesh_constants_gpu.h:889</a></div></div>
<div class="ttc" id="namespacespecfem__par__crustmantle_html_a21afb5998b855dee48741d465dc0aef1"><div class="ttname"><a href="../../d6/dc0/namespacespecfem__par__crustmantle.html#a21afb5998b855dee48741d465dc0aef1">specfem_par_crustmantle::b_epsilondev_xy_crust_mantle</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), pointer, contiguous b_epsilondev_xy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00563">specfem3D_par.F90:563</a></div></div>
<div class="ttc" id="helper__functions__gpu_8c_html_aeab352950b89401622319ea49fd180cb"><div class="ttname"><a href="../../dd/de1/helper__functions__gpu_8c.html#aeab352950b89401622319ea49fd180cb">gpuCreateCopy_todevice_int</a></div><div class="ttdeci">void gpuCreateCopy_todevice_int(gpu_int_mem *d_array_addr_ptr, int *h_array, int size)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de1/helper__functions__gpu_8c_source.html#l00130">helper_functions_gpu.c:130</a></div></div>
<div class="ttc" id="structmesh___html_ac3a22086bf6cd32c5b6fbb69adff15c9"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ac3a22086bf6cd32c5b6fbb69adff15c9">mesh_::save_stacey</a></div><div class="ttdeci">int save_stacey</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00719">mesh_constants_gpu.h:719</a></div></div>
<div class="ttc" id="structmesh___html_aa494ced6a0aefce755316d7881d7f350"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aa494ced6a0aefce755316d7881d7f350">mesh_::d_hprimewgll_xx</a></div><div class="ttdeci">gpu_realw_mem d_hprimewgll_xx</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00701">mesh_constants_gpu.h:701</a></div></div>
<div class="ttc" id="structmesh___html_a1989f8adfab2b3e7b8e580b94898edb6"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a1989f8adfab2b3e7b8e580b94898edb6">mesh_::d_noise_surface_movie</a></div><div class="ttdeci">gpu_realw_mem d_noise_surface_movie</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00901">mesh_constants_gpu.h:901</a></div></div>
<div class="ttc" id="mesh__constants__gpu_8h_html_a516b74fe7d258a4d363f4d53f5ad2b10"><div class="ttname"><a href="../../dd/d2b/mesh__constants__gpu_8h.html#a516b74fe7d258a4d363f4d53f5ad2b10">NGLLX</a></div><div class="ttdeci">#define NGLLX</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00142">mesh_constants_gpu.h:142</a></div></div>
<div class="ttc" id="structmesh___html_ae64b00249134a94e0f1c542c2a67b8e1"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae64b00249134a94e0f1c542c2a67b8e1">mesh_::d_b_rmassy_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_b_rmassy_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00404">mesh_constants_gpu.h:404</a></div></div>
<div class="ttc" id="structmesh___html_a91945dcf3506fc89e08b15cbba533f88"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a91945dcf3506fc89e08b15cbba533f88">mesh_::NGLOB_OUTER_CORE</a></div><div class="ttdeci">int NGLOB_OUTER_CORE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00503">mesh_constants_gpu.h:503</a></div></div>
<div class="ttc" id="structmesh___html_a3031d8304f5c5ba2ff1af0708909ffdb"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a3031d8304f5c5ba2ff1af0708909ffdb">mesh_::d_epsilondev_xx_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_epsilondev_xx_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00463">mesh_constants_gpu.h:463</a></div></div>
<div class="ttc" id="structmesh___html_a5a8e4f4b71f788c730e63c7ef8a9290a"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a5a8e4f4b71f788c730e63c7ef8a9290a">mesh_::two_omega_earth</a></div><div class="ttdeci">realw two_omega_earth</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00759">mesh_constants_gpu.h:759</a></div></div>
<div class="ttc" id="namespacecreate__regions__mesh__par2_html_af74f67b2509b6daa198d1336f240bc1f"><div class="ttname"><a href="../../d6/d83/namespacecreate__regions__mesh__par2.html#af74f67b2509b6daa198d1336f240bc1f">create_regions_mesh_par2::c23store</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable c23store</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9f/meshfem3_d__par_8f90_source.html#l00300">meshfem3D_par.f90:300</a></div></div>
<div class="ttc" id="structmesh___html_a38ef87e9553ec5ed4f613fcc7d5c7cb0"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a38ef87e9553ec5ed4f613fcc7d5c7cb0">mesh_::h_send_accel_buffer_oc</a></div><div class="ttdeci">float * h_send_accel_buffer_oc</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00937">mesh_constants_gpu.h:937</a></div></div>
<div class="ttc" id="structmesh___html_ae29f844d277df67bab0930a4f9a2f578"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ae29f844d277df67bab0930a4f9a2f578">mesh_::d_send_accel_buffer_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_send_accel_buffer_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00827">mesh_constants_gpu.h:827</a></div></div>
<div class="ttc" id="structmesh___html_a46339796930aae060164e700f0a9c99f"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a46339796930aae060164e700f0a9c99f">mesh_::d_jacobian2D_ymax_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_jacobian2D_ymax_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00857">mesh_constants_gpu.h:857</a></div></div>
<div class="ttc" id="structmesh___html_a008e31fd1f2a027c441a62cb2e81be31"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a008e31fd1f2a027c441a62cb2e81be31">mesh_::d_b_send_accel_buffer_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_b_send_accel_buffer_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00828">mesh_constants_gpu.h:828</a></div></div>
<div class="ttc" id="structmesh___html_aab0dbb2ca6a9e39ad894b04050ad654e"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aab0dbb2ca6a9e39ad894b04050ad654e">mesh_::d_veloc_inner_core</a></div><div class="ttdeci">gpu_realw_mem d_veloc_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00614">mesh_constants_gpu.h:614</a></div></div>
<div class="ttc" id="structmesh___html_a756f40e55ceb0e610fd064a71c3e28f0"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a756f40e55ceb0e610fd064a71c3e28f0">mesh_::d_nibool_interfaces_outer_core</a></div><div class="ttdeci">gpu_int_mem d_nibool_interfaces_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00824">mesh_constants_gpu.h:824</a></div></div>
<div class="ttc" id="mesh__constants__ocl_8h_html_a335e852d31a37c05d1dd050ead4b9027"><div class="ttname"><a href="../../dc/d29/mesh__constants__ocl_8h.html#a335e852d31a37c05d1dd050ead4b9027">clck_</a></div><div class="ttdeci">#define clck_(var)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d29/mesh__constants__ocl_8h_source.html#l00102">mesh_constants_ocl.h:102</a></div></div>
<div class="ttc" id="structmesh___html_ad29bca98750a15b4851199271753c0ae"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ad29bca98750a15b4851199271753c0ae">mesh_::d_b_accel_outer_core</a></div><div class="ttdeci">gpu_realw_mem d_b_accel_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00537">mesh_constants_gpu.h:537</a></div></div>
<div class="ttc" id="structmesh___html_aff06dab5e4c140b9181104caf915cd09"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aff06dab5e4c140b9181104caf915cd09">mesh_::nspec2D_xmin_crust_mantle</a></div><div class="ttdeci">int nspec2D_xmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00834">mesh_constants_gpu.h:834</a></div></div>
<div class="ttc" id="structmesh___html_a8a68cf9e50c65403318966bc32f0feac"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a8a68cf9e50c65403318966bc32f0feac">mesh_::d_ibelm_xmin_crust_mantle</a></div><div class="ttdeci">gpu_int_mem d_ibelm_xmin_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00844">mesh_constants_gpu.h:844</a></div></div>
<div class="ttc" id="structmesh___html_aba2f680cd1825a0f4227385ad1f19a66"><div class="ttname"><a href="../../d2/d88/structmesh__.html#aba2f680cd1825a0f4227385ad1f19a66">mesh_::save_forward</a></div><div class="ttdeci">int save_forward</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00717">mesh_constants_gpu.h:717</a></div></div>
<div class="ttc" id="structmesh___html_a02f54fb788adbc4c2cdc0ef1aa6af675"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a02f54fb788adbc4c2cdc0ef1aa6af675">mesh_::compute_and_store_strain</a></div><div class="ttdeci">int compute_and_store_strain</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00726">mesh_constants_gpu.h:726</a></div></div>
<div class="ttc" id="namespacespecfem__par__innercore_html_a0c378d7240877f122f2eb57dc073aaca"><div class="ttname"><a href="../../db/dc2/namespacespecfem__par__innercore.html#a0c378d7240877f122f2eb57dc073aaca">specfem_par_innercore::epsilondev_yy_inner_core</a></div><div class="ttdeci">real(kind=custom_real), dimension(:,:,:,:), allocatable, target epsilondev_yy_inner_core</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dda/specfem3_d__par_8_f90_source.html#l00731">specfem3D_par.F90:731</a></div></div>
<div class="ttc" id="structmesh___html_a43d05db64c2b77160fbbe332477ddf29"><div class="ttname"><a href="../../d2/d88/structmesh__.html#a43d05db64c2b77160fbbe332477ddf29">mesh_::d_nimin_outer_core</a></div><div class="ttdeci">gpu_int_mem d_nimin_outer_core</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00871">mesh_constants_gpu.h:871</a></div></div>
<div class="ttc" id="structmesh___html"><div class="ttname"><a href="../../d2/d88/structmesh__.html">mesh_</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00370">mesh_constants_gpu.h:370</a></div></div>
<div class="ttc" id="structmesh___html_ade04d8d40a6a2050d24369d9b99c410b"><div class="ttname"><a href="../../d2/d88/structmesh__.html#ade04d8d40a6a2050d24369d9b99c410b">mesh_::d_veloc_crust_mantle</a></div><div class="ttdeci">gpu_realw_mem d_veloc_crust_mantle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d2b/mesh__constants__gpu_8h_source.html#l00440">mesh_constants_gpu.h:440</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- custom-made footer -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_76fc807e71a78804243adb7d05973764.html">SPECFEM3D_GLOBE</a></li><li class="navelem"><a class="el" href="../../dir_3e3821fc19411950b1ac0b3a66489b15.html">src</a></li><li class="navelem"><a class="el" href="../../dir_30af1ff1e2d5f8cd3fc3df73a22acee1.html">gpu</a></li><li class="navelem"><a class="el" href="../../dd/d8e/prepare__mesh__constants__gpu_8c.html">prepare_mesh_constants_gpu.c</a></li> 
    <li class="footer">
    <!--
    Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.10
    -->   
    doxygen for <a href="https://github.com/geodynamics/specfem3d_globe">SPECFEM3D_GLOBE</a>
    </li>
  </ul>
</div>
</body>
</html>
