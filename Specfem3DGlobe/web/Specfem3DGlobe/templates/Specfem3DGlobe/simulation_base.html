
{% extends "Specfem3DGlobe/base.html" %}

{% block content %}

<h1>{% block heading %}Simulation{% endblock %}</h1>

{% if form.has_errors %}
<p><b class=error>Please correct the following error{{ form.error_dict|pluralize }}:</b>
<ul>
    {% for e in form.error_dict.iteritems %}
    <li>Field "{{ e.0 }}": {{ e.1|join:", " }}</li>
    {% endfor %}
</ul>
{% endif %}

<form action="." method="POST">
    <input type="hidden" name="mesh__type" value="{% block mesh__type %}{% endblock %}">
    <input type="hidden" name="simulation_type" value="{{ form.data.simulation_type }}">

    <h2>Event</h2>

    <p>{{ form.events }} {% if form.events.errors %}<span class=error>{{ form.events.errors|join:", " }}</span>{% endif %}

    <h2>Stations</h2>

    <p>{{ form.stations }} {% if form.stations.errors %}<span class=error>{{ form.stations.errors|join:", " }}</span>{% endif %}

    <img align="right" src="http://www.gps.caltech.edu/research/jtromp/research/graphics/{% block mesh_image %}{% endblock %}">

    <h2>Mesh</h2>

    <input type="button" value="info" onclick="window.open('/specfem3dglobe/info/mesh/','infowin','width=500,height=400,resizable=1,top=50,left=50');">

    <p>

    <table border=0>
      {% block mesh %}
        <tr>
            <td valign="top"><label for="id_mesh__nproc_xi">Nproc &xi;:</label></td>
            <td valign="top">{{ form.mesh__nproc_xi }}</td>
            <td valign="top">{% if form.mesh__nproc_xi.errors %}<span class=error>{{ form.mesh__nproc_xi.errors|join:", " }}</span>{% endif %}</td>
        </tr>

        <tr>
            <td valign="top"><label for="id_mesh__nproc_eta">Nproc &eta;:</label></td>
            <td valign="top">{{ form.mesh__nproc_eta }}</td>
            <td valign="top">{% if form.mesh__nproc_eta.errors %}<span class=error>{{ form.mesh__nproc_eta.errors|join:", " }}</span>{% endif %}</td>
        </tr>

        <tr>
            <td valign="top"><label for="id_mesh__nex_xi">Nex &xi;:</label></td>
            <td valign="top">{{ form.mesh__nex_xi }}</td>
            <td valign="top">{% if form.mesh__nex_xi.errors %}<span class=error>{{ form.mesh__nex_xi.errors|join:", " }}</span>{% endif %}</td>
        </tr>

        <tr>
            <td valign="top"><label for="id_mesh__nex_eta">Nex &eta;:</label></td>
            <td valign="top">{{ form.mesh__nex_eta }}</td>
            <td valign="top">{% if form.mesh__nex_eta.errors %}<span class=error>{{ form.mesh__nex_eta.errors|join:", " }}</span>{% endif %}</td>
        </tr>

      {% endblock %}
    </table>

    <h2>Model</h2>

    <img align="right" src="http://www.gps.caltech.edu/research/jtromp/research/graphics/ellipticity_mesh.gif">

    <input type="button" value="info" onclick="window.open('/specfem3dglobe/info/model/','infowin','width=500,height=400,resizable=1,top=50,left=50');">

    <p>{{ form.model__type }} {% if form.model__type.errors %}<span class=error>{{ form.model__type.errors|join:", " }}</span>{% endif %}

    <ul>
        <li>{{ form.model__oceans }}       <label for="id_model__oceans">Oceans</label>
        <li>{{ form.model__ellipticity }}  <label for="id_model__ellipticity">Ellipticity</label>
        <li>{{ form.model__topography }}   <label for="id_model__topography">Topography</label>
        <li>{{ form.model__gravity }}      <label for="id_model__gravity">Gravity</label>
        <li>{{ form.model__rotation }}     <label for="id_model__rotation">Rotation</label>
        <li>{{ form.model__attenuation }}  <label for="id_model__attenuation">Attenuation</label>
    </ul>

    <h2>Output Format</h2>

    <input type="button" value="info" onclick="window.open('/specfem3dglobe/info/output_format/','infowin','width=500,height=400,resizable=1,top=50,left=50');">

    <table border=0>
        <tr>
            <td valign="top"><label for="id_record_length">Time steps between frames:</label></td>
            <td valign="top">{{ form.record_length }}</td>
            <td valign="top">{% if form.record_length.errors %}<span class=error>{{ form.record_length.errors|join:", " }}</span>{% endif %}</td>
        </tr>

        <tr>
            <td valign="top"><label for="id_ntstep_between_output_info">Time steps between info output:</label></td>
            <td valign="top">{{ form.ntstep_between_output_info }}</td>
            <td valign="top">{% if form.ntstep_between_output_info.errors %}<span class=error>{{ form.ntstep_between_output_info.errors|join:", " }}</span>{% endif %}</td>
        </tr>

        <tr>
            <td valign="top"><label for="id_ntstep_between_output_seismos">Time steps between seismo output:</label></td>
            <td valign="top">{{ form.ntstep_between_output_seismos }}</td>
            <td valign="top">{% if form.ntstep_between_output_seismos.errors %}<span class=error>{{ form.ntstep_between_output_seismos.errors|join:", " }}</span>{% endif %}</td>
        </tr>
    </table>

    <ul>
        <li>{{ form.receivers_can_be_buried }}     <label for="id_receivers_can_be_buried">Receiver at depth</label>
        <li>{{ form.print_source_time_function }}  <label for="id_print_source_time_function">Print Source Time Function</label>
        <li>{{ form.mesh__save_files }}            <label for="id_mesh__save_files">Save Mesh Files</label>
    </ul>

    <h2>Movie</h2>

    <input type="button" value="info" onclick="window.open('/specfem3dglobe/info/movie/','infowin','width=500,height=400,resizable=1,top=50,left=50');">

    <ul>
        <li>{{ form.movie_surface }}  <label for="id_movie_surface">Surface</label>
        <li>{{ form.movie_volume }}   <label for="id_movie_volume">Volume</label>
    </ul>

    <table border=0>
        <tr>
            <td valign="top"><label for="id_ntstep_between_frames">Time steps between frames:</label></td>
            <td valign="top">{{ form.ntstep_between_frames }}</td>
            <td valign="top">{% if form.ntstep_between_frames.errors %}<span class=error>{{ form.ntstep_between_frames.errors|join:", " }}</span>{% endif %}</td>
        </tr>

        <tr>
            <td valign="top"><label for="id_hdur_movie">Convolve source time function by Gaussian with half duration:</label></td>
            <td valign="top">{{ form.hdur_movie }}</td>
            <td valign="top">{% if form.hdur_movie.errors %}<span class=error>{{ form.hdur_movie.errors|join:", " }}</span>{% endif %}</td>
        </tr>
    </table>

    <p><input type="submit" value="Create">

</form>

{% endblock %}
