
!=======================================================================!
!                                                                       !
!   specfem3D is a 3-D spectral-element solver for the Earth.           !
!   It uses a mesh generated by program meshfem3D                       !
!                                                                       !
!=======================================================================!

Instructions on how to install and use SPECFEM3D_GLOBE are
available in the manual located in directory USER_MANUAL.

Main developers: Dimitri Komatitsch, Jeroen Tromp, Qinya Liu and David Michea.


Installation
------------

In order to compile the package on your system, please consult the
manual located in directory USER_MANUAL and the file './INSTALL' within this
package directory.


Default simulation
------------------

A short step-by-step procedure to run a default simulation is described
here. 

1. To set up a default simulation, you need to have the files:

   DATA/Par_file 
   DATA/CMTSOLUTION   
   DATA/STATIONS

   we will use the default simulation files '*.default' provided in the package:
   > cd SPECFEM3D_GLOBE/
   > cp DATA/Par_file.default DATA/Par_file
   > cp DATA/CMTSOLUTION.default DATA/CMTSOLUTION
   > cp DATA/STATIONS.default DATA/STATIONS
   
   The default simulation is an earthquake that occurred in 
   Bolivia 1994 with a moment magnitude of ~6.8.
   
   The simulation will run over the entire globe and require a total of 150 CPUs.
   The seismogram resolution will be accurate down to ~18 seconds.
   

2. compile the mesher:

   > make xmeshfem3D


3. run the mesher on your cluster:

   > qsub go_mesher_pbs.bash
   
   - Different cluster scripts are provided as examples in the directory
      UTILS/Cluster. Locate your script and copy it the package
      root directory: 
      e.g. > cp UTILS/Cluster/pbs/go_mesher_pbs.bash ./
      
      The example above uses a version of the Portable Batch System (PBS).
      Example scripts are also provided for Load Sharing Facility (LSF)
      and Sun Grid Engine (SGE). make sure, you modify this script to
      fit to your specific cluster setup.
  
   - please, before you submit your job, make sure to have created the directory specified as 
      'LOCAL_PATH' in your DATA/Par_file. by default the DATA/Par_file specifies:
          ..
          # path to store the local database files on each node
          LOCAL_PATH                      = ./DATABASES_MPI
          ..
          
      make sure this points to the right location for your cluster and that
      you created the directory before submitting your job:
      e.g. > mkdir ./DATABASES_MPI  
      
      (at this point, you should also know if your directory for LOCAL_PATH
       is accessible by all compute nodes or not. set the flag
       LOCAL_PATH_IS_ALSO_GLOBAL in constants.h accordingly )
       
   after a successful run, the mesher will have created a perfectly, load-balanced 
   hexahedral spectral-element mesh stored in this directory.

   note: for the default example, the mesher will take about 30 minutes
         to create the mesh.
         the file disk space needed for this global mesh is about ~51 GB.
         
     
4. compile the solver:

  > make xspecfem3D
  
  re-compilation is needed since the solver tries to use static memory allocation
  and compiler optimizations that will work out much better once the details of
  your simulation mesh are known. 


5. run the solver on your cluster:

  > qsub go_solver_pbs.bash
  
  - Again, different cluster scripts are provided in the directory 
    UTILS/Cluster. modify the example scripts to fit to your specific 
    cluster setup.
        
  after a successful simulation, all seismograms are stored into the directory:
  OUTPUT_FILES/
    
  note: the default simulation will take about 1 h 40 m.
        the file disk space for all seismograms in OUTPUT_FILES/ is about ~77 MB.



well done!


   
